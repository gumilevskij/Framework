<!DOCTYPE html>

<html lang="en" data-content_root="../../../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>snowdrop.src.graphs.util &#8212; Python Platform 1.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../../../_static/pygments.css?v=61cd365c" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/alabaster.css?v=12dfc556" />
    <script src="../../../../_static/documentation_options.js?v=f2a433a1"></script>
    <script src="../../../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
   
  <link rel="stylesheet" href="../../../../_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <h1>Source code for snowdrop.src.graphs.util</h1><div class="highlight"><pre>
<span></span><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Created on Mon Mar  4 14:28:27 2019</span>

<span class="sd">@author: A.Goumilevski</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">mpl_toolkits.mplot3d</span> <span class="kn">import</span> <span class="n">Axes3D</span>
<span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="n">pi</span><span class="p">,</span> <span class="n">ceil</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">cm</span>
<span class="kn">import</span> <span class="nn">matplotlib.dates</span> <span class="k">as</span> <span class="nn">dates</span>
<span class="kn">import</span> <span class="nn">matplotlib.style</span> <span class="k">as</span> <span class="nn">style</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">ticker</span>
<span class="kn">from</span> <span class="nn">pandas.plotting</span> <span class="kn">import</span> <span class="n">register_matplotlib_converters</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="kn">from</span> <span class="nn">snowdrop.src.misc.termcolor</span> <span class="kn">import</span> <span class="n">cprint</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="ne">DeprecationWarning</span><span class="p">)</span> 

<span class="n">register_matplotlib_converters</span><span class="p">()</span>

<span class="n">path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="vm">__file__</span><span class="p">))</span>
<span class="n">working_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">path</span><span class="o">+</span><span class="s2">&quot;/../../../&quot;</span><span class="p">)</span>   

<span class="c1">#STYLE = &quot;seaborn-darkgrid&quot;</span>
<span class="n">STYLE</span> <span class="o">=</span> <span class="s2">&quot;seaborn-v0_8-whitegrid&quot;</span>
<span class="n">K1</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">K2</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">K3</span> <span class="o">=</span> <span class="mi">0</span>

<div class="viewcode-block" id="plotEigenValues">
<a class="viewcode-back" href="../../../../source/snowdrop.src.graphs.html#snowdrop.src.graphs.util.plotEigenValues">[docs]</a>
<span class="k">def</span> <span class="nf">plotEigenValues</span><span class="p">(</span><span class="n">path_to_dir</span><span class="p">,</span><span class="n">ev</span><span class="p">,</span><span class="n">show</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">save</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">ext</span><span class="o">=</span><span class="s2">&quot;png&quot;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Plot eigen values.</span>
<span class="sd">    </span>
<span class="sd">    Parameters:</span>
<span class="sd">        :param path_to_dir: Path to the folder where figures are saved.</span>
<span class="sd">        :type path_to_dir: str.</span>
<span class="sd">        :param ev: Eigen values</span>
<span class="sd">        :type ev: np.array.</span>
<span class="sd">        :param show: Boolean variable.  If set to True shows graphs.</span>
<span class="sd">        :type show: bool.</span>
<span class="sd">        :param save: Boolean variable.  If set to True saves graphs.</span>
<span class="sd">        :type save: bool.colors</span>
<span class="sd">        :param ext: Format of the saved file.</span>
<span class="sd">        :type ext: str.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">save</span><span class="p">:</span>
        <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="n">STYLE</span><span class="p">)</span>
    
    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">ev</span><span class="o">.</span><span class="n">real</span><span class="p">,</span><span class="n">ev</span><span class="o">.</span><span class="n">imag</span><span class="p">,</span><span class="n">linewidths</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
    <span class="n">pts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="n">pi</span><span class="p">,</span> <span class="n">pi</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">pts</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">pts</span><span class="p">),</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">box</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Eigen Values&#39;</span><span class="p">,</span><span class="n">fontsize</span> <span class="o">=</span> <span class="s1">&#39;x-large&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Real&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Imaginary&#39;</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">save</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path_to_dir</span><span class="p">,</span><span class="s1">&#39;Eigen_values.&#39;</span><span class="o">+</span><span class="n">ext</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">show</span><span class="p">:</span> 
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">block</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span></div>

     
 
<div class="viewcode-block" id="plotDecomposition">
<a class="viewcode-back" href="../../../../source/snowdrop.src.graphs.html#snowdrop.src.graphs.util.plotDecomposition">[docs]</a>
<span class="k">def</span> <span class="nf">plotDecomposition</span><span class="p">(</span><span class="n">path_to_dir</span><span class="p">,</span><span class="n">model</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">variables_names</span><span class="p">,</span><span class="n">decomp_variables</span><span class="p">,</span><span class="n">periods</span><span class="p">,</span><span class="n">isKF</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">sizes</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="n">Tmax</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span><span class="n">rng</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">show</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">save</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">ext</span><span class="o">=</span><span class="s2">&quot;png&quot;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Plot contributions of different soures to endogenous variable.</span>
<span class="sd">    </span>
<span class="sd">    Parameters:</span>
<span class="sd">        :param path_to_dir: Path to the folder where figures are saved.</span>
<span class="sd">        :type path_to_dir: str.</span>
<span class="sd">        :param model: Model object.</span>
<span class="sd">        :type model: Model.</span>
<span class="sd">        :param y: Data array.</span>
<span class="sd">        :type y: array.</span>
<span class="sd">        :param variables_names: Variable names.</span>
<span class="sd">        :type variables_names: list.</span>
<span class="sd">        :param decomp_variables: decomposition variables names.</span>
<span class="sd">        :type decomp_variables: list.</span>
<span class="sd">        :param periods: List of periods of shocks.</span>
<span class="sd">        :type periods: list.</span>
<span class="sd">        :param header: Plot header.</span>
<span class="sd">        :type header: str.</span>
<span class="sd">        :param isKF: True if shocks are obtained by Kalman Filter.</span>
<span class="sd">        :type isKF: bool.</span>
<span class="sd">        :param sizes: Subplots dimensions.</span>
<span class="sd">        :type sizes: tuple.</span>
<span class="sd">        :param Tmax: Maximum number of periods to display in graphs.</span>
<span class="sd">        :type Tmax: int.</span>
<span class="sd">        :param rng: Time range.</span>
<span class="sd">        :type rng: list.</span>
<span class="sd">        :param sizes: Figure sizes.</span>
<span class="sd">        :type sizes: tuple.</span>
<span class="sd">        :param show: Boolean variable.  If set to True shows graphs.</span>
<span class="sd">        :type show: bool.</span>
<span class="sd">        :param save: Boolean variable.  If set to True saves graphs.</span>
<span class="sd">        :type save: bool.</span>
<span class="sd">        :param ext: Format of the saved file.</span>
<span class="sd">        :type ext: str.</span>
<span class="sd">        </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
    <span class="kn">from</span> <span class="nn">snowdrop.src.utils.util</span> <span class="kn">import</span> <span class="n">deleteFiles</span><span class="p">,</span><span class="n">correctLabel</span>
    <span class="kn">from</span> <span class="nn">snowdrop.src.numeric.solver.util</span> <span class="kn">import</span> <span class="n">decompose</span>
    <span class="kn">from</span> <span class="nn">snowdrop.src.utils.util</span> <span class="kn">import</span> <span class="n">getMap</span>
    <span class="kn">from</span> <span class="nn">textwrap</span> <span class="kn">import</span> <span class="n">wrap</span>
    
    <span class="k">global</span> <span class="n">K2</span>
    <span class="n">K2</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="n">var_labels</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">symbols</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;variables_labels&quot;</span><span class="p">,{})</span>
    <span class="n">shocks</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">symbols</span><span class="p">[</span><span class="s2">&quot;shocks&quot;</span><span class="p">]</span>
    <span class="n">exog</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">symbols</span><span class="p">[</span><span class="s2">&quot;exogenous&quot;</span><span class="p">]</span>
    
    <span class="n">figs</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="n">STYLE</span><span class="p">)</span>
    
    <span class="n">years</span> <span class="o">=</span> <span class="n">dates</span><span class="o">.</span><span class="n">YearLocator</span><span class="p">()</span>   <span class="c1"># every year</span>
    <span class="n">yearsFmt</span> <span class="o">=</span> <span class="n">dates</span><span class="o">.</span><span class="n">DateFormatter</span><span class="p">(</span><span class="s1">&#39;%Y&#39;</span><span class="p">)</span>
    <span class="n">barWidth</span> <span class="o">=</span> <span class="mf">0.5</span>
    
    <span class="k">if</span> <span class="n">decomp_variables</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">decomp_variables</span> <span class="o">=</span> <span class="n">variables_names</span>
        
    <span class="n">decomp_variables</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">decomp_variables</span> <span class="k">if</span> <span class="ow">not</span> <span class="s2">&quot;_plus_&quot;</span> <span class="ow">in</span> <span class="n">x</span> <span class="ow">and</span> <span class="ow">not</span> <span class="s2">&quot;_minus_&quot;</span> <span class="ow">in</span> <span class="n">x</span><span class="p">]</span>
     
    <span class="k">if</span> <span class="ow">not</span> <span class="n">sizes</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">rows</span><span class="p">,</span> <span class="n">columns</span> <span class="o">=</span> <span class="n">sizes</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">decomp_variables</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">rows</span> <span class="o">=</span> <span class="n">columns</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">decomp_variables</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">2</span><span class="p">:</span>   
            <span class="n">rows</span><span class="p">,</span><span class="n">columns</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span><span class="mi">1</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">decomp_variables</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">4</span><span class="p">:</span>   
            <span class="n">rows</span><span class="p">,</span><span class="n">columns</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span><span class="mi">2</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">decomp_variables</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">9</span><span class="p">:</span>   
            <span class="n">rows</span><span class="p">,</span><span class="n">columns</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span><span class="mi">3</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">decomp_variables</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">12</span><span class="p">:</span>   
            <span class="n">rows</span><span class="p">,</span><span class="n">columns</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span><span class="mi">3</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">rows</span><span class="p">,</span> <span class="n">columns</span> <span class="o">=</span> <span class="n">sizes</span>
            
    <span class="c1"># Delete files</span>
    <span class="k">if</span> <span class="n">K2</span><span class="o">==</span><span class="mi">1</span><span class="p">:</span>
        <span class="n">deleteFiles</span><span class="p">(</span><span class="n">path_to_dir</span><span class="p">,</span><span class="s2">&quot;Decomposition&quot;</span><span class="p">)</span>
    <span class="n">kmax</span> <span class="o">=</span> <span class="n">K2</span><span class="o">-</span><span class="mi">1</span>
    
    <span class="n">file_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path_to_dir</span><span class="p">,</span><span class="s2">&quot;../data/dictionary/symbols_labels.csv&quot;</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">file_path</span><span class="p">):</span>
        <span class="n">symbolsMap</span> <span class="o">=</span> <span class="n">getMap</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">symbolsMap</span> <span class="o">=</span> <span class="p">{}</span>
    
    <span class="n">alpha</span> <span class="o">=</span> <span class="mf">1.0</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">if</span> <span class="n">figsize</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
    <span class="n">k</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">m</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">decomp_variables</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">variables_names</span><span class="p">:</span>
            <span class="n">c</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">if</span> <span class="n">rng</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">T</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">),</span><span class="n">Tmax</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">T</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">),</span><span class="nb">len</span><span class="p">(</span><span class="n">rng</span><span class="p">),</span><span class="n">Tmax</span><span class="p">)</span>
            <span class="c1"># Get decomposition data</span>
            <span class="n">y</span> <span class="o">=</span> <span class="n">y</span><span class="p">[:</span><span class="n">T</span><span class="p">]</span>
            <span class="n">data</span><span class="p">,</span><span class="n">var</span> <span class="o">=</span> <span class="n">decompose</span><span class="p">(</span><span class="n">model</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">variables_names</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="n">T</span><span class="p">,</span><span class="n">periods</span><span class="p">,</span><span class="n">isKF</span><span class="p">)</span>
            <span class="n">var</span> <span class="o">=</span> <span class="p">[</span><span class="n">var_labels</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">var_labels</span> <span class="k">else</span> <span class="n">k</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">var</span><span class="o">+</span><span class="n">shocks</span><span class="o">+</span><span class="n">exog</span><span class="p">]</span>
            <span class="n">colors</span><span class="p">,</span><span class="n">m_colors</span> <span class="o">=</span> <span class="n">getColors</span><span class="p">(</span><span class="n">var</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">j</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">val</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">variables_names</span><span class="p">)</span> <span class="k">if</span> <span class="n">val</span><span class="o">==</span><span class="n">n</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">k</span><span class="o">%</span><span class="p">(</span><span class="n">rows</span><span class="o">*</span><span class="n">columns</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">m</span> <span class="o">=</span> <span class="mi">0</span>
                    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">)</span>
                <span class="n">k</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="n">m</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">rows</span><span class="p">,</span><span class="n">columns</span><span class="p">,</span><span class="n">m</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">rng</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">ind</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>   
                    <span class="n">series</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">y</span><span class="p">[:,</span><span class="n">j</span><span class="p">])</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">ind</span> <span class="o">=</span> <span class="n">rng</span><span class="p">[:</span><span class="n">T</span><span class="p">]</span>
                    <span class="n">series</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">y</span><span class="p">[:,</span><span class="n">j</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="n">ind</span><span class="p">)</span>
                <span class="n">h0</span> <span class="o">=</span> <span class="n">series</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;TOTAL&quot;</span><span class="p">)</span>
                
                <span class="c1"># PLot bar graphs</span>
                <span class="n">bottomPlus</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="n">bottomMinus</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;TOTAL&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="n">correctLabel</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">data</span><span class="p">]</span>
                <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
                    <span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
                    <span class="n">zPlus</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">z</span><span class="o">+</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">z</span><span class="p">))</span>
                    <span class="n">zMinus</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">z</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">z</span><span class="p">))</span> 
                    <span class="n">c</span> <span class="o">+=</span> <span class="mi">1</span>
                    <span class="n">c</span> <span class="o">=</span> <span class="n">c</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">colors</span><span class="p">)</span>
                    <span class="n">color</span> <span class="o">=</span> <span class="n">colors</span><span class="p">[</span><span class="n">c</span><span class="p">]</span>
                    <span class="c1"># if key in m_colors: </span>
                    <span class="c1">#     color = m_colors[key]</span>
                    <span class="c1"># Stacked bar plots</span>
                    <span class="k">if</span> <span class="n">bottomPlus</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">bottomMinus</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="n">ax</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">ind</span><span class="p">,</span> <span class="n">zPlus</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="n">barWidth</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span><span class="n">edgecolor</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span>
                        <span class="n">ax</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">ind</span><span class="p">,</span> <span class="n">zMinus</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="n">correctLabel</span><span class="p">(</span><span class="n">key</span><span class="p">),</span> <span class="n">width</span><span class="o">=</span><span class="n">barWidth</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span><span class="n">edgecolor</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span>
                        <span class="n">bottomPlus</span> <span class="o">=</span> <span class="n">zPlus</span>
                        <span class="n">bottomMinus</span> <span class="o">=</span> <span class="n">zMinus</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">ax</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">ind</span><span class="p">,</span> <span class="n">zPlus</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="n">bottomPlus</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="n">barWidth</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span><span class="n">edgecolor</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span>
                        <span class="n">ax</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">ind</span><span class="p">,</span> <span class="n">zMinus</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="n">correctLabel</span><span class="p">(</span><span class="n">key</span><span class="p">),</span> <span class="n">bottom</span><span class="o">=</span><span class="n">bottomMinus</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="n">barWidth</span><span class="p">,</span><span class="n">align</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="n">c</span><span class="p">],</span><span class="n">edgecolor</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span>
                        <span class="n">bottomPlus</span> <span class="o">+=</span> <span class="n">zPlus</span>
                        <span class="n">bottomMinus</span> <span class="o">+=</span> <span class="n">zMinus</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s2">&quot;best&quot;</span><span class="p">,</span><span class="n">fontsize</span> <span class="o">=</span> <span class="s1">&#39;medium&#39;</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">symbolsMap</span><span class="p">:</span>
                    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">wrap</span><span class="p">(</span><span class="n">symbolsMap</span><span class="p">[</span><span class="n">n</span><span class="p">])),</span><span class="n">fontsize</span> <span class="o">=</span> <span class="s1">&#39;x-large&#39;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">var_label</span> <span class="o">=</span> <span class="n">var_labels</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="k">if</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">var_labels</span> <span class="k">else</span> <span class="n">n</span>
                    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">var_label</span><span class="p">,</span><span class="n">fontsize</span> <span class="o">=</span> <span class="s1">&#39;x-large&#39;</span><span class="p">)</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
                <span class="c1"># format the ticks</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_minor_locator</span><span class="p">(</span><span class="n">years</span><span class="p">)</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_minor_formatter</span><span class="p">(</span><span class="n">yearsFmt</span><span class="p">)</span>
                <span class="c1">#plt.xticks(ind, [&#39;&#39;], rotation=90)</span>
    
        <span class="k">if</span> <span class="n">k</span><span class="o">%</span><span class="p">(</span><span class="n">rows</span><span class="o">*</span><span class="n">columns</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">fig</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">set_tight_layout</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">header</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">make_space_above</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
                <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="n">header</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">17</span><span class="p">,</span><span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;normal&#39;</span><span class="p">)</span>
            <span class="n">figs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">save</span><span class="p">:</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path_to_dir</span><span class="p">,</span><span class="s1">&#39;Decomposition_&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">kmax</span><span class="o">+</span><span class="n">ceil</span><span class="p">(</span><span class="n">k</span><span class="o">/</span><span class="mi">4</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39;.&#39;</span> <span class="o">+</span> <span class="n">ext</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">show</span><span class="p">:</span> 
                <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">block</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
                <span class="n">fig</span> <span class="o">=</span> <span class="kc">None</span>
            
    <span class="k">if</span> <span class="n">k</span><span class="o">%</span><span class="p">(</span><span class="n">rows</span><span class="o">*</span><span class="n">columns</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">0</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">fig</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>  
        <span class="n">fig</span><span class="o">.</span><span class="n">set_tight_layout</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">header</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">make_space_above</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="n">header</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">17</span><span class="p">,</span><span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;normal&#39;</span><span class="p">)</span>
        <span class="n">figs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span> 
        <span class="k">if</span> <span class="n">save</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path_to_dir</span><span class="p">,</span><span class="s1">&#39;Decomposition_&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">kmax</span><span class="o">+</span><span class="n">ceil</span><span class="p">((</span><span class="mi">1</span><span class="o">+</span><span class="n">k</span><span class="p">)</span><span class="o">/</span><span class="mi">4</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39;.&#39;</span> <span class="o">+</span> <span class="n">ext</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">show</span><span class="p">:</span> 
            <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">block</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
            <span class="n">fig</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="s1">&#39;all&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">figs</span></div>

    

<div class="viewcode-block" id="plotHistogram">
<a class="viewcode-back" href="../../../../source/snowdrop.src.graphs.html#snowdrop.src.graphs.util.plotHistogram">[docs]</a>
<span class="k">def</span> <span class="nf">plotHistogram</span><span class="p">(</span><span class="n">path_to_dir</span><span class="p">,</span><span class="n">priors</span><span class="p">,</span><span class="n">samples</span><span class="p">,</span><span class="n">names</span><span class="p">,</span><span class="n">parameters</span><span class="p">,</span><span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">show</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">save</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">sizes</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="n">ext</span><span class="o">=</span><span class="s2">&quot;png&quot;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Plot histogram and kernel density function.</span>
<span class="sd">      </span>
<span class="sd">    Parameters:</span>
<span class="sd">        :param path_to_dir: Path to the folder where figures are saved.</span>
<span class="sd">        :type path_to_dir: str.</span>
<span class="sd">        :param priors: Model parameters priors.</span>
<span class="sd">        :type priors: dict.</span>
<span class="sd">        :param samples: Data array.</span>
<span class="sd">        :type samples: np.array.</span>
<span class="sd">        :param names: List of parameters names.</span>
<span class="sd">        :type names: list.</span>
<span class="sd">        :param parameters: List of parameters values.</span>
<span class="sd">        :type parameters: list.</span>
<span class="sd">        :param header: Plot header.</span>
<span class="sd">        :type header: str.</span>
<span class="sd">        :param sizes: Figure sizes.</span>
<span class="sd">        :type sizes: tuple.</span>
<span class="sd">        :param show: Boolean variable.  If set to True shows graphs.</span>
<span class="sd">        :type show: bool.</span>
<span class="sd">        :param save: Boolean variable.  If set to True saves graphs.</span>
<span class="sd">        :type save: bool.</span>
<span class="sd">        :param ext: Format of the saved file.</span>
<span class="sd">        :type ext: str.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
    <span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
    <span class="c1">#from scipy import stats</span>
    <span class="kn">from</span> <span class="nn">snowdrop.src.utils.util</span> <span class="kn">import</span> <span class="n">deleteFiles</span>
    <span class="kn">from</span> <span class="nn">snowdrop.src.utils.distributions</span> <span class="kn">import</span> <span class="n">pdf</span>
    <span class="kn">from</span> <span class="nn">snowdrop.src.utils.distributions</span> <span class="kn">import</span> <span class="n">getHyperParameters</span>
        
    <span class="k">global</span> <span class="n">K3</span>
    <span class="n">K3</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="c1"># Delete files</span>
    <span class="k">if</span> <span class="n">K3</span><span class="o">==</span><span class="mi">1</span><span class="p">:</span>
        <span class="n">deleteFiles</span><span class="p">(</span><span class="n">path_to_dir</span><span class="p">,</span><span class="s2">&quot;Density&quot;</span><span class="p">)</span>
        <span class="n">deleteFiles</span><span class="p">(</span><span class="n">path_to_dir</span><span class="p">,</span><span class="s2">&quot;Corner&quot;</span><span class="p">)</span>
    <span class="n">kmax</span> <span class="o">=</span> <span class="n">K3</span><span class="o">-</span><span class="mi">1</span>
    
    <span class="n">size</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">save</span><span class="p">:</span>
        <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
   
    <span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="n">STYLE</span><span class="p">)</span>
    
    <span class="n">rows</span><span class="p">,</span><span class="n">columns</span> <span class="o">=</span> <span class="n">sizes</span>
    
    <span class="n">k</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">m</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">size</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">k</span><span class="o">%</span><span class="p">(</span><span class="n">rows</span><span class="o">*</span><span class="n">columns</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">m</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">)</span>
        <span class="n">k</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">m</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">rows</span><span class="p">,</span><span class="n">columns</span><span class="p">,</span><span class="n">m</span><span class="p">)</span>
        
        <span class="c1"># Get priors</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">names</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">prior</span> <span class="o">=</span> <span class="n">priors</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>
        <span class="n">pars</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">prior</span><span class="p">[</span><span class="s1">&#39;parameters&#39;</span><span class="p">])</span>
        <span class="n">distr</span> <span class="o">=</span> <span class="n">prior</span><span class="p">[</span><span class="s1">&#39;distribution&#39;</span><span class="p">]</span>
        <span class="n">lb</span><span class="p">,</span><span class="n">ub</span> <span class="o">=</span> <span class="n">pars</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">pars</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        
        <span class="c1"># Get posteriors    </span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">samples</span><span class="p">[:,</span><span class="n">i</span><span class="p">]</span>
        <span class="c1">#nb,bins,patches = ax.hist(data,facecolor=&quot;green&quot;,alpha=0.75)</span>
        <span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span><span class="n">hist</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">kde</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">bins</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;darkblue&quot;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;Posterior Distribution&quot;</span><span class="p">,</span><span class="n">hist_kws</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;edgecolor&quot;</span><span class="p">:</span><span class="s2">&quot;black&quot;</span><span class="p">},</span><span class="n">kde_kws</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;linewidth&quot;</span><span class="p">:</span><span class="mi">4</span><span class="p">})</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Density&quot;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Histogram of </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">name</span><span class="o">.</span><span class="n">upper</span><span class="p">()),</span><span class="n">fontsize</span> <span class="o">=</span> <span class="s1">&#39;x-large&#39;</span><span class="p">)</span>
        <span class="n">pmin</span><span class="p">,</span><span class="n">pmax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">()</span>
        <span class="n">ymin</span><span class="p">,</span><span class="n">ymax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">()</span>
        
        <span class="c1"># Get prior distribution</span>
        <span class="n">num</span> <span class="o">=</span> <span class="mi">1000</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="n">lb</span><span class="p">,</span><span class="n">stop</span><span class="o">=</span><span class="n">ub</span><span class="p">,</span><span class="n">num</span><span class="o">=</span><span class="n">num</span><span class="p">)</span>
        <span class="n">x</span> <span class="o">=</span> <span class="nb">list</span><span class="p">();</span> <span class="n">prior_pdf</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        
        <span class="c1"># Get distribution hyperparameters</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">distr</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;_hp&quot;</span><span class="p">):</span>
            <span class="n">pars</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span><span class="n">pars</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="n">getHyperParameters</span><span class="p">(</span><span class="n">distr</span><span class="o">=</span><span class="n">distr</span><span class="p">,</span><span class="n">mean</span><span class="o">=</span><span class="n">pars</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span><span class="n">std</span><span class="o">=</span><span class="n">pars</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span>
        
        <span class="n">xm</span> <span class="o">=</span> <span class="n">lb</span><span class="p">;</span> <span class="n">ym</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num</span><span class="p">):</span>
            <span class="n">y</span><span class="p">,</span><span class="n">b</span>   <span class="o">=</span> <span class="n">pdf</span><span class="p">(</span><span class="n">distr</span><span class="p">,</span><span class="n">p</span><span class="p">[</span><span class="n">j</span><span class="p">],</span><span class="n">pars</span><span class="p">)</span>
            <span class="n">x</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>  
            <span class="n">prior_pdf</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">y</span> <span class="o">&gt;</span> <span class="n">ym</span><span class="p">:</span>
                <span class="n">ym</span> <span class="o">=</span> <span class="n">y</span>
                <span class="n">xm</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">b</span><span class="p">:</span>
                <span class="n">cprint</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;plotHistogram: prior pdf calculation for &#39;</span><span class="si">{</span><span class="n">distr</span><span class="si">}</span><span class="s2">&#39; distribution failed&quot;</span><span class="p">,</span><span class="s2">&quot;red&quot;</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">ymax</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="o">*</span><span class="n">ym</span><span class="p">:</span>
            <span class="n">pmin</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">lb</span><span class="p">,</span><span class="nb">min</span><span class="p">(</span><span class="n">pmin</span><span class="p">,</span><span class="n">pars</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">pars</span><span class="p">[</span><span class="mi">4</span><span class="p">]))</span>
            <span class="n">pmax</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">ub</span><span class="p">,</span><span class="nb">max</span><span class="p">(</span><span class="n">pmax</span><span class="p">,</span><span class="n">pars</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">pars</span><span class="p">[</span><span class="mi">4</span><span class="p">]))</span>
       
        <span class="c1"># Plot prior</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">prior_pdf</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">prior_pdf</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;Prior Distribution&quot;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span> <span class="o">=</span> <span class="s1">&#39;medium&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="n">pmin</span><span class="p">,</span><span class="n">pmax</span><span class="p">])</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">k</span><span class="o">%</span><span class="p">(</span><span class="n">rows</span><span class="o">*</span><span class="n">columns</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">set_tight_layout</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">header</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">make_space_above</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
                <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="n">header</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">17</span><span class="p">,</span><span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;normal&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">save</span><span class="p">:</span>    
                <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path_to_dir</span><span class="p">,</span><span class="s2">&quot;Density_&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">kmax</span><span class="o">+</span><span class="n">ceil</span><span class="p">(</span><span class="n">k</span><span class="o">/</span><span class="mi">4</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39;.&#39;</span> <span class="o">+</span> <span class="n">ext</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">show</span><span class="p">:</span> 
                <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">block</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
                <span class="n">fig</span> <span class="o">=</span> <span class="kc">None</span>
                
    <span class="k">if</span> <span class="n">k</span><span class="o">%</span><span class="p">(</span><span class="n">rows</span><span class="o">*</span><span class="n">columns</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>  
        <span class="n">fig</span><span class="o">.</span><span class="n">set_tight_layout</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">header</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">make_space_above</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="n">header</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">17</span><span class="p">,</span><span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;normal&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">save</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path_to_dir</span><span class="p">,</span><span class="s1">&#39;Density_&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">kmax</span><span class="o">+</span><span class="n">ceil</span><span class="p">((</span><span class="mi">1</span><span class="o">+</span><span class="n">k</span><span class="p">)</span><span class="o">/</span><span class="mi">4</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39;.&#39;</span> <span class="o">+</span> <span class="n">ext</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">show</span><span class="p">:</span> 
            <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">block</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
            <span class="n">fig</span> <span class="o">=</span> <span class="kc">None</span>
                
            
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Two dimensional projections of multidimensional samples covariances&quot;</span><span class="p">)</span>
    <span class="kn">from</span> <span class="nn">corner</span> <span class="kn">import</span> <span class="n">corner</span>
    <span class="n">params</span> <span class="o">=</span> <span class="p">[]</span>           
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">k</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">names</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">priors</span> <span class="ow">and</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">size</span><span class="p">:</span>
            <span class="n">params</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">parameters</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
            
    <span class="n">data</span> <span class="o">=</span> <span class="n">samples</span><span class="p">[:,:</span><span class="n">size</span><span class="p">]</span>
    <span class="n">params_std</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">params_std</span><span class="p">))</span><span class="o">&gt;</span><span class="mf">1.e-6</span><span class="p">:</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="n">corner</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="n">labels</span><span class="o">=</span><span class="n">names</span><span class="p">[:</span><span class="n">size</span><span class="p">],</span><span class="n">truths</span><span class="o">=</span><span class="n">params</span><span class="p">,</span><span class="n">smooth</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">)</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Projections of a parameter set in a multi-dimensional space</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.05</span><span class="p">)</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">set_figheight</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">set_figwidth</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
        
        <span class="c1"># Extract the axes</span>
        <span class="n">axes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">fig</span><span class="o">.</span><span class="n">axes</span><span class="p">)</span>
        <span class="n">axes</span> <span class="o">=</span> <span class="n">axes</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">size</span><span class="p">,</span> <span class="n">size</span><span class="p">))</span>
                  
        <span class="c1"># Empirical mean of the sample:</span>
        <span class="n">params_mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">samples</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    
        <span class="c1"># Loop over the diagonal</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">size</span><span class="p">):</span>
            <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">params_mean</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;b&quot;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="p">[</span><span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">label</span><span class="p">,</span> <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">label</span><span class="p">]:</span>
                <span class="n">item</span><span class="o">.</span><span class="n">set_fontsize</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span>
            
        <span class="c1"># Loop over the histograms</span>
        <span class="k">for</span> <span class="n">yi</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">size</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">xi</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">yi</span><span class="p">):</span>
                <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="n">yi</span><span class="p">,</span> <span class="n">xi</span><span class="p">]</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="n">xi</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">)</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">params_mean</span><span class="p">[</span><span class="n">xi</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;b&quot;</span><span class="p">)</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="n">yi</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">)</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">params_mean</span><span class="p">[</span><span class="n">yi</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;b&quot;</span><span class="p">)</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="n">xi</span><span class="p">],</span> <span class="n">params</span><span class="p">[</span><span class="n">yi</span><span class="p">],</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">params_mean</span><span class="p">[</span><span class="n">xi</span><span class="p">],</span> <span class="n">params_mean</span><span class="p">[</span><span class="n">yi</span><span class="p">],</span> <span class="s2">&quot;b&quot;</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="p">[</span><span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">label</span><span class="p">,</span> <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">label</span><span class="p">]:</span>
                    <span class="n">item</span><span class="o">.</span><span class="n">set_fontsize</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">get_xticklabels</span><span class="p">()</span> <span class="o">+</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_yticklabels</span><span class="p">()):</span>
                    <span class="n">item</span><span class="o">.</span><span class="n">set_fontsize</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">save</span><span class="p">:</span>    
            <span class="n">fig</span><span class="o">.</span><span class="n">set_tight_layout</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path_to_dir</span><span class="p">,</span><span class="s2">&quot;Corner.&quot;</span> <span class="o">+</span> <span class="n">ext</span><span class="p">))</span>        
        <span class="k">if</span> <span class="n">show</span><span class="p">:</span> 
            <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">block</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
            <span class="n">fig</span> <span class="o">=</span> <span class="kc">None</span>
        
    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="s1">&#39;all&#39;</span><span class="p">)</span></div>

    
        
<div class="viewcode-block" id="plot">
<a class="viewcode-back" href="../../../../source/snowdrop.src.graphs.html#snowdrop.src.graphs.util.plot">[docs]</a>
<span class="k">def</span> <span class="nf">plot</span><span class="p">(</span><span class="n">path_to_dir</span><span class="p">,</span><span class="n">data</span><span class="p">,</span><span class="n">variable_names</span><span class="p">,</span><span class="n">sizes</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">meas_values</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">meas_variables</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">lrx_filter</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">hp_filter</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">Tmax</span><span class="o">=</span><span class="mf">1.e10</span><span class="p">,</span><span class="n">output_variables</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">var_labels</span><span class="o">=</span><span class="p">{},</span><span class="n">prefix</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">steady_state</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">rng</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">rng_meas</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">irf</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">Npaths</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">show</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">save</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">ext</span><span class="o">=</span><span class="s2">&quot;png&quot;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Plot 1-D graphs of macro variables.</span>
<span class="sd">    </span>
<span class="sd">    Parameters:</span>
<span class="sd">        :param path_to_dir: Path to the folder where figures are saved.</span>
<span class="sd">        :type path_to_dir: str.</span>
<span class="sd">        :param data: Data array.</span>
<span class="sd">        :type data: array.</span>
<span class="sd">        :param variable_names: Variables names.</span>
<span class="sd">        :type variable_names: list.</span>
<span class="sd">        :param sizes: Subplots dimensions.</span>
<span class="sd">        :type sizes: tuple.</span>
<span class="sd">        :param figsize: Figure size..</span>
<span class="sd">        :type figsize: tuple.</span>
<span class="sd">        :param meas_values: Measurement variables values.</span>
<span class="sd">        :type meas_values: list.</span>
<span class="sd">        :param meas_variables: Measurement variables names.</span>
<span class="sd">        :type meas_variables: list.</span>
<span class="sd">        :param lrx_filter: List of LRX filtered measurement values.</span>
<span class="sd">        :type lrx_filter: list.</span>
<span class="sd">        :param hp_filter: List of HP filtered measurement values.</span>
<span class="sd">        :type hp_filter: list.</span>
<span class="sd">        :param Tmax: Maximum number of periods to display in graphs.</span>
<span class="sd">        :type Tmax: int.</span>
<span class="sd">        :param output_variables: Output variable names.</span>
<span class="sd">        :type output_variables: list.</span>
<span class="sd">        :param var_labels: Labels of output variable names.</span>
<span class="sd">        :type var_labels: dict.</span>
<span class="sd">        :param prefix: Prefix of variables.  If set then display variable which name start with prefix.</span>
<span class="sd">        :type prefix: str.</span>
<span class="sd">        :param steady_state: Steady-state solution.</span>
<span class="sd">        :type steady_state: list.</span>
<span class="sd">        :param irf: Impulse-responce function variable.</span>
<span class="sd">        :type irf: int.</span>
<span class="sd">        :param Npaths: Number of paths.</span>
<span class="sd">        :type Npaths: int.</span>
<span class="sd">        :param header: Plot header.</span>
<span class="sd">        :type header: str.</span>
<span class="sd">        :param show: Boolean variable.  If set to True shows graphs.</span>
<span class="sd">        :type show: bool.</span>
<span class="sd">        :param save: Boolean variable.  If set to True saves graphs.</span>
<span class="sd">        :type save: bool.</span>
<span class="sd">        :param ext: Format of the saved file.</span>
<span class="sd">        :type ext: str.</span>
<span class="sd">        :returns: List of figures.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span> <span class="nn">textwrap</span> <span class="kn">import</span> <span class="n">wrap</span>
    <span class="kn">from</span> <span class="nn">snowdrop.src.utils.util</span> <span class="kn">import</span> <span class="n">deleteFiles</span>
    <span class="kn">from</span> <span class="nn">snowdrop.src.utils.util</span> <span class="kn">import</span> <span class="n">getMap</span>
    <span class="kn">from</span> <span class="nn">snowdrop.src.utils.util</span> <span class="kn">import</span> <span class="n">caseInsensitiveDict</span>
    
    <span class="k">global</span> <span class="n">K1</span>
    <span class="n">K1</span> <span class="o">+=</span> <span class="mi">1</span>
    
    <span class="k">if</span> <span class="n">figsize</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
    <span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="n">STYLE</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="ow">not</span> <span class="n">sizes</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">rows</span><span class="p">,</span> <span class="n">columns</span> <span class="o">=</span> <span class="n">sizes</span>
    <span class="k">elif</span> <span class="ow">not</span> <span class="n">output_variables</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">output_variables</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">rows</span> <span class="o">=</span> <span class="n">columns</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">output_variables</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">rows</span><span class="p">,</span> <span class="n">columns</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="mi">2</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">output_variables</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">4</span><span class="p">:</span>   
            <span class="n">rows</span> <span class="o">=</span> <span class="n">columns</span> <span class="o">=</span> <span class="mi">2</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">output_variables</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">6</span><span class="p">:</span>   
            <span class="n">rows</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span> <span class="n">columns</span> <span class="o">=</span> <span class="mi">2</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">output_variables</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">8</span><span class="p">:</span>   
            <span class="n">rows</span> <span class="o">=</span> <span class="mi">4</span><span class="p">;</span> <span class="n">columns</span> <span class="o">=</span> <span class="mi">2</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">output_variables</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">12</span><span class="p">:</span>   
            <span class="n">rows</span> <span class="o">=</span> <span class="mi">4</span><span class="p">;</span> <span class="n">columns</span> <span class="o">=</span> <span class="mi">3</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">rows</span><span class="p">,</span> <span class="n">columns</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span><span class="mi">3</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">rows</span><span class="p">,</span> <span class="n">columns</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span><span class="mi">3</span>
    
    <span class="c1"># years = dates.YearLocator()   # every year</span>
    <span class="c1"># yearsFmt = dates.DateFormatter(&#39;%Y&#39;)</span>
    
    <span class="n">plot_vars</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">variable_names</span> <span class="k">if</span>  <span class="s2">&quot;_minus_&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">x</span> <span class="ow">and</span> <span class="s2">&quot;_plus_&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">x</span><span class="p">]</span>
    
    <span class="k">if</span> <span class="ow">not</span> <span class="n">prefix</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">plot_vars</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">plot_vars</span> <span class="k">if</span>  <span class="n">x</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">prefix</span><span class="p">)]</span>
                
        
    <span class="k">if</span> <span class="n">K1</span><span class="o">==</span><span class="mi">1</span><span class="p">:</span>
        <span class="n">deleteFiles</span><span class="p">(</span><span class="n">path_to_dir</span><span class="p">,</span><span class="s2">&quot;Variables&quot;</span><span class="p">)</span>
    <span class="n">kmax</span> <span class="o">=</span> <span class="n">K1</span> <span class="o">-</span> <span class="mi">1</span>
    
    <span class="n">file_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">working_dir</span><span class="p">,</span><span class="s2">&quot;supplements/data/dictionary/symbols_labels.csv&quot;</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">file_path</span><span class="p">):</span>
        <span class="n">symbolsMap</span> <span class="o">=</span> <span class="n">getMap</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">symbolsMap</span> <span class="o">=</span> <span class="p">{}</span>
        
    <span class="n">k</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">m</span> <span class="o">=</span> <span class="mi">0</span>  
    <span class="n">figs</span> <span class="o">=</span> <span class="p">[]</span>
    
    <span class="k">if</span> <span class="n">meas_variables</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">meas_vars</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">meas_vars</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">meas_variables</span><span class="p">]</span>
    
    <span class="n">ciLabels</span> <span class="o">=</span> <span class="n">caseInsensitiveDict</span><span class="p">(</span><span class="n">var_labels</span><span class="p">)</span>
    <span class="n">indices</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">variable_names</span><span class="p">)),</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">k</span><span class="p">:</span> <span class="n">variable_names</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
    
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">indices</span><span class="p">:</span>
        <span class="n">n</span> <span class="o">=</span> <span class="n">variable_names</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">plot_vars</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">output_variables</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">output_variables</span><span class="p">:</span>
                <span class="k">continue</span>
        <span class="n">data_meas</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">data_lrx_filtered</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">data_hp_filtered</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="s2">&quot;_BAR&quot;</span> <span class="ow">in</span> <span class="n">n</span><span class="p">:</span>
            <span class="n">ind</span> <span class="o">=</span> <span class="n">n</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s2">&quot;_BAR&quot;</span><span class="p">)</span>
            <span class="n">n2</span> <span class="o">=</span> <span class="n">n</span><span class="p">[:</span><span class="n">ind</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">n2</span> <span class="o">=</span> <span class="n">n</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">meas_vars</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">ind</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">if</span> <span class="n">n2</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">+</span><span class="s2">&quot;_meas&quot;</span> <span class="ow">in</span> <span class="n">meas_vars</span><span class="p">:</span>
                <span class="n">meas_var</span> <span class="o">=</span> <span class="n">n2</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">+</span> <span class="s2">&quot;_meas&quot;</span>
                <span class="n">ind</span> <span class="o">=</span> <span class="n">meas_vars</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">meas_var</span><span class="p">)</span>
            <span class="k">elif</span> <span class="s2">&quot;obs_&quot;</span> <span class="o">+</span> <span class="n">n2</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="n">meas_vars</span><span class="p">:</span>
                <span class="n">meas_var</span> <span class="o">=</span> <span class="s2">&quot;obs_&quot;</span> <span class="o">+</span> <span class="n">n2</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
                <span class="n">ind</span> <span class="o">=</span> <span class="n">meas_vars</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">meas_var</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">ind</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">meas_values</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">meas_values</span><span class="p">,</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
                        <span class="n">data_meas</span> <span class="o">=</span> <span class="n">meas_values</span><span class="p">[</span><span class="n">meas_variables</span><span class="p">[</span><span class="n">ind</span><span class="p">]]</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">data_meas</span> <span class="o">=</span> <span class="n">meas_values</span><span class="p">[:,</span><span class="n">ind</span><span class="p">]</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">lrx_filter</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">lrx_filter</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">ind</span><span class="p">:</span>
                    <span class="n">data_lrx_filtered</span> <span class="o">=</span> <span class="n">lrx_filter</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">hp_filter</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">hp_filter</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">ind</span><span class="p">:</span>
                    <span class="n">data_hp_filtered</span> <span class="o">=</span> <span class="n">hp_filter</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span>
        
        <span class="k">if</span> <span class="n">k</span><span class="o">%</span><span class="p">(</span><span class="n">rows</span><span class="o">*</span><span class="n">columns</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">m</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">)</span>
        <span class="n">k</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">m</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">rows</span><span class="p">,</span><span class="n">columns</span><span class="p">,</span><span class="n">m</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">Npaths</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">Npaths</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">y</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">y</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">dim1</span><span class="p">,</span><span class="n">dim2</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">shape</span>
            <span class="k">if</span> <span class="n">rng</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">T</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">dim1</span><span class="p">,</span><span class="n">Tmax</span><span class="p">)</span>
                <span class="n">series</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">y</span><span class="p">[:</span><span class="n">T</span><span class="p">,</span><span class="n">j</span><span class="p">])</span>
                <span class="k">if</span> <span class="n">Npaths</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">series</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">series</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">T</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">dim1</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">rng</span><span class="p">),</span><span class="n">Tmax</span><span class="p">)</span>
                <span class="n">series</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">y</span><span class="p">[:</span><span class="n">T</span><span class="p">,</span><span class="n">j</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="n">rng</span><span class="p">[:</span><span class="n">T</span><span class="p">])</span>
                <span class="c1"># if not rng_meas is None:</span>
                <span class="c1">#     mask = (series.index.to_timestamp() &gt;= rng_meas[0]) &amp; (series.index.to_timestamp() &lt;= rng_meas[-1]) </span>
                <span class="c1">#     series = series[mask]</span>
                <span class="k">if</span> <span class="n">Npaths</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">series</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;DarkBlue&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">series</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">data_meas</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data_meas</span><span class="p">,</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">):</span>
                    <span class="n">data_meas</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span><span class="n">style</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">,</span><span class="n">markersize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;MEASUREMENT&quot;</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">rng_meas</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">series_meas</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data_meas</span><span class="p">)</span>
                    <span class="n">series_meas</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span><span class="n">style</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">,</span><span class="n">markersize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;MEASUREMENT&quot;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">series_meas</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data_meas</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">rng_meas</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="nb">len</span><span class="p">(</span><span class="n">data_meas</span><span class="p">)])</span>
                    <span class="n">series_meas</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span><span class="n">style</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">,</span><span class="n">markersize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;MEASUREMENT&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">data_lrx_filtered</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">rng_meas</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">series_meas</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data_lrx_filtered</span><span class="p">)</span>
                    <span class="n">series_meas</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;LRX FILTER&quot;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">nm</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data_lrx_filtered</span><span class="p">),</span><span class="nb">len</span><span class="p">(</span><span class="n">rng_meas</span><span class="p">))</span>
                    <span class="n">series_meas</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data_lrx_filtered</span><span class="p">[:</span><span class="n">nm</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="n">rng_meas</span><span class="p">[:</span><span class="n">nm</span><span class="p">])</span>
                    <span class="n">series_meas</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;LRX FILTER&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">data_hp_filtered</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">rng_meas</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">series_meas</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data_hp_filtered</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>
                    <span class="n">series_meas</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;HP FILTER&quot;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">nm</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data_hp_filtered</span><span class="p">),</span><span class="nb">len</span><span class="p">(</span><span class="n">rng_meas</span><span class="p">))</span>
                    <span class="n">series_meas</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data_hp_filtered</span><span class="p">[:</span><span class="n">nm</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="n">rng_meas</span><span class="p">[:</span><span class="n">nm</span><span class="p">])</span>
                    <span class="n">series_meas</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;HP FILTER&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">Npaths</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span> <span class="o">=</span> <span class="s1">&#39;medium&#39;</span><span class="p">)</span>
        <span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">()</span> 
        <span class="n">ymin</span><span class="p">,</span> <span class="n">ymax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">()</span> 
        <span class="k">if</span> <span class="ow">not</span> <span class="n">steady_state</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">ssj</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">irf</span><span class="p">)</span><span class="o">*</span><span class="n">steady_state</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">xmin</span><span class="p">,</span><span class="n">xmax</span><span class="p">],[</span><span class="n">ssj</span><span class="p">,</span><span class="n">ssj</span><span class="p">],</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
            
            
        <span class="k">if</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">symbolsMap</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">wrap</span><span class="p">(</span><span class="n">symbolsMap</span><span class="p">[</span><span class="n">n</span><span class="p">])),</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">n</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="ow">in</span> <span class="n">ciLabels</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">wrap</span><span class="p">(</span><span class="n">ciLabels</span><span class="p">[</span><span class="n">n</span><span class="o">.</span><span class="n">upper</span><span class="p">()])),</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="c1"># format the ticks</span>
        <span class="c1"># ax.xaxis.set_minor_locator(years)</span>
        <span class="c1"># ax.xaxis.set_major_formatter(yearsFmt)</span>
        <span class="c1"># ax.xaxis.set_minor_formatter(yearsFmt)</span>

        <span class="k">if</span> <span class="n">k</span><span class="o">%</span><span class="p">(</span><span class="n">rows</span><span class="o">*</span><span class="n">columns</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">header</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">make_space_above</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
                <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="n">header</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">17</span><span class="p">,</span><span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;normal&#39;</span><span class="p">)</span>
            <span class="n">figs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">save</span><span class="p">:</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path_to_dir</span><span class="p">,</span><span class="s1">&#39;Variables_&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">kmax</span><span class="o">+</span><span class="n">ceil</span><span class="p">(</span><span class="n">k</span><span class="o">/</span><span class="p">(</span><span class="n">rows</span><span class="o">*</span><span class="n">columns</span><span class="p">)))</span> <span class="o">+</span> <span class="s1">&#39;.&#39;</span> <span class="o">+</span> <span class="n">ext</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">show</span><span class="p">:</span> 
                <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">block</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> 
                <span class="c1">#plt.close(fig)</span>
            
    <span class="k">if</span> <span class="n">k</span><span class="o">%</span><span class="p">(</span><span class="n">rows</span><span class="o">*</span><span class="n">columns</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>    
        <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">(</span><span class="n">pad</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">header</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">make_space_above</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="n">header</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">17</span><span class="p">,</span><span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;normal&#39;</span><span class="p">)</span>
        <span class="n">figs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span> 
        <span class="k">if</span> <span class="n">save</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path_to_dir</span><span class="p">,</span><span class="s1">&#39;Variables_&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">kmax</span><span class="o">+</span><span class="n">ceil</span><span class="p">((</span><span class="mi">1</span><span class="o">+</span><span class="n">k</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">rows</span><span class="o">*</span><span class="n">columns</span><span class="p">)))</span> <span class="o">+</span> <span class="s1">&#39;.&#39;</span> <span class="o">+</span> <span class="n">ext</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">show</span><span class="p">:</span> 
            <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">block</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> 
            <span class="c1">#plt.close(fig)</span>
        
    <span class="k">return</span> <span class="n">figs</span>   </div>

 
   
<div class="viewcode-block" id="plotSteadyState">
<a class="viewcode-back" href="../../../../source/snowdrop.src.graphs.html#snowdrop.src.graphs.util.plotSteadyState">[docs]</a>
<span class="k">def</span> <span class="nf">plotSteadyState</span><span class="p">(</span><span class="n">path_to_dir</span><span class="p">,</span><span class="n">variables</span><span class="p">,</span><span class="n">arr_ss</span><span class="p">,</span><span class="n">par_ss</span><span class="p">,</span><span class="n">sizes</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">fig_sizes</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">10</span><span class="p">),</span><span class="n">save</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">show</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">ext</span><span class="o">=</span><span class="s2">&quot;png&quot;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Plot steady state solution graphs.</span>
<span class="sd">    </span>
<span class="sd">    Parameters:</span>
<span class="sd">        :param path_to_dir: Path to the folder where figures are saved.</span>
<span class="sd">        :type path_to_dir: str.</span>
<span class="sd">        :param variables: List of variables.</span>
<span class="sd">        :type variables: list.</span>
<span class="sd">        :param arr_ss: Array of steady states.</span>
<span class="sd">        :type arr_ss: array.</span>
<span class="sd">        :param par_ss: List of parameter names.</span>
<span class="sd">        :type par_ss: list.</span>
<span class="sd">        :param sizes: Subplots dimensions.</span>
<span class="sd">        :type sizes: tuple.</span>
<span class="sd">        :param ext: Format of the saved file.</span>
<span class="sd">        :type ext: str.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="n">STYLE</span><span class="p">)</span>
    <span class="n">nVariables</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">variables</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="ow">not</span> <span class="n">sizes</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">rows</span><span class="p">,</span> <span class="n">columns</span> <span class="o">=</span> <span class="n">sizes</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">ns</span> <span class="o">=</span> <span class="n">nVariables</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">par_ss</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">ns</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">rows</span><span class="p">,</span><span class="n">columns</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="mi">1</span>
        <span class="k">elif</span> <span class="n">ns</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">rows</span><span class="p">,</span><span class="n">columns</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span><span class="mi">1</span>
        <span class="k">elif</span> <span class="n">ns</span> <span class="o">&lt;=</span> <span class="mi">3</span><span class="p">:</span>
            <span class="n">rows</span><span class="p">,</span> <span class="n">columns</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span><span class="mi">1</span>
        <span class="k">elif</span> <span class="n">ns</span> <span class="o">&lt;=</span> <span class="mi">4</span><span class="p">:</span>
            <span class="n">rows</span><span class="p">,</span> <span class="n">columns</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span><span class="mi">2</span>
        <span class="k">elif</span> <span class="n">ns</span> <span class="o">&lt;=</span> <span class="mi">6</span><span class="p">:</span>   
            <span class="n">rows</span><span class="p">,</span><span class="n">columns</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span><span class="mi">2</span>
        <span class="k">elif</span> <span class="n">ns</span> <span class="o">&lt;=</span> <span class="mi">8</span><span class="p">:</span>   
            <span class="n">rows</span><span class="p">,</span><span class="n">columns</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span><span class="mi">2</span>
        <span class="k">elif</span> <span class="n">ns</span> <span class="o">&lt;=</span> <span class="mi">9</span><span class="p">:</span>   
            <span class="n">rows</span><span class="p">,</span><span class="n">columns</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span><span class="mi">3</span>
        <span class="k">elif</span> <span class="n">ns</span> <span class="o">&lt;=</span> <span class="mi">12</span><span class="p">:</span>   
            <span class="n">rows</span> <span class="o">=</span> <span class="mi">4</span><span class="p">;</span> <span class="n">columns</span> <span class="o">=</span> <span class="mi">3</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">columns</span> <span class="o">=</span> <span class="mi">3</span>
            <span class="n">rows</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">ns</span><span class="o">/</span><span class="n">columns</span><span class="p">))</span>
            
    <span class="n">figs</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">chunk</span> <span class="o">=</span> <span class="n">rows</span><span class="o">*</span><span class="n">columns</span>
    <span class="n">m</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">arr_ss</span><span class="p">)):</span>
        <span class="n">arr</span> <span class="o">=</span> <span class="n">arr_ss</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
        <span class="n">nss</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nss</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nss</span><span class="p">,</span><span class="n">nVariables</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nss</span><span class="p">):</span>
            <span class="n">ar</span> <span class="o">=</span> <span class="n">arr</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">ar</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">,:]</span> <span class="o">=</span> <span class="n">ar</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
        <span class="n">jj</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nVariables</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">m</span><span class="o">%</span><span class="n">chunk</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">j</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">jj</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="n">fig_sizes</span><span class="p">)</span>
                <span class="n">figs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
            <span class="n">m</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">jj</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">rows</span><span class="p">,</span><span class="n">columns</span><span class="p">,</span><span class="n">jj</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">[:,</span><span class="n">j</span><span class="p">],</span><span class="n">label</span><span class="o">=</span><span class="n">variables</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Steady-State Solution for &quot;&#39;</span> <span class="o">+</span> <span class="n">variables</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span><span class="p">,</span><span class="n">fontsize</span> <span class="o">=</span> <span class="s1">&#39;medium&#39;</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="n">par_ss</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">(</span><span class="n">pad</span> <span class="o">=</span> <span class="mi">5</span><span class="p">)</span> 
            
    <span class="k">if</span> <span class="n">save</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">working_dir</span><span class="p">,</span><span class="s1">&#39;graphs/Steady_State.&#39;</span><span class="o">+</span><span class="n">ext</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">show</span><span class="p">:</span> 
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">block</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> 
    
    <span class="k">return</span> <span class="n">figs</span></div>

        
 
<div class="viewcode-block" id="plotTimeSeries">
<a class="viewcode-back" href="../../../../source/snowdrop.src.graphs.html#snowdrop.src.graphs.util.plotTimeSeries">[docs]</a>
<span class="k">def</span> <span class="nf">plotTimeSeries</span><span class="p">(</span><span class="n">path_to_dir</span><span class="p">,</span><span class="n">header</span><span class="p">,</span><span class="n">titles</span><span class="p">,</span><span class="n">labels</span><span class="p">,</span><span class="n">series</span><span class="p">,</span><span class="n">sizes</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">fig_sizes</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">10</span><span class="p">),</span><span class="n">save</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">highlight</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">stacked</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">isLastLinePlot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">zero_line</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">show</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">ext</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;    </span>
<span class="sd">    Plot time series.</span>
<span class="sd">    </span>
<span class="sd">    Parameters:</span>
<span class="sd">        :param path_to_dir: Path to the folder where figures are saved.</span>
<span class="sd">        :type path_to_dir: str.</span>
<span class="sd">        :param header: List of variables.</span>
<span class="sd">        :type header: str.</span>
<span class="sd">        :param titles: List of graphs titles.</span>
<span class="sd">        :type titles: list.</span>
<span class="sd">        :param labels: List of graphs labels.</span>
<span class="sd">        :type labels: list.</span>
<span class="sd">        :param sizes: Subplots dimensions.</span>
<span class="sd">        :type sizes: tuple.</span>
<span class="sd">        :param save: If True saves plot in a pdf format.</span>
<span class="sd">        :type save: bool.</span>
<span class="sd">        :param highlight: The startong and ending dates of a highlighted region.</span>
<span class="sd">        :type highlight: list.</span>
<span class="sd">        :param stacked: If True plot stacked bar plots.</span>
<span class="sd">        :type stacked: bool.</span>
<span class="sd">        :param isLastLinePlot: If True the last series plot will be drawn as line plots.</span>
<span class="sd">        :type isLastLinePlot: bool.</span>
<span class="sd">        :param show: If True display plots.</span>
<span class="sd">        :type zero_line: bool.</span>
<span class="sd">        :param zero_line: If True adds zero line.</span>
<span class="sd">        :type show: bool.</span>
<span class="sd">        :param ext: Format of the saved file.</span>
<span class="sd">        :type ext: str.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1">#import matplotlib.gridspec as gridspec</span>
    <span class="c1">#from datetime import datetime </span>
    
    <span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="n">STYLE</span><span class="p">)</span>
    <span class="n">colors</span> <span class="o">=</span> <span class="n">getColors</span><span class="p">()</span>
    
    <span class="k">if</span> <span class="ow">not</span> <span class="n">sizes</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">rows</span><span class="p">,</span> <span class="n">columns</span> <span class="o">=</span> <span class="n">sizes</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">titles</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">rows</span><span class="p">,</span><span class="n">columns</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="mi">1</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">titles</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">rows</span><span class="p">,</span><span class="n">columns</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span><span class="mi">1</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">titles</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">3</span><span class="p">:</span>
            <span class="n">rows</span><span class="p">,</span> <span class="n">columns</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span><span class="mi">1</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">titles</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">4</span><span class="p">:</span>
            <span class="n">rows</span><span class="p">,</span> <span class="n">columns</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span><span class="mi">2</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">titles</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">6</span><span class="p">:</span>   
            <span class="n">rows</span><span class="p">,</span><span class="n">columns</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span><span class="mi">2</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">titles</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">8</span><span class="p">:</span>   
            <span class="n">rows</span><span class="p">,</span><span class="n">columns</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span><span class="mi">2</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">titles</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">9</span><span class="p">:</span>   
            <span class="n">rows</span><span class="p">,</span><span class="n">columns</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span><span class="mi">3</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">titles</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">12</span><span class="p">:</span>   
            <span class="n">rows</span> <span class="o">=</span> <span class="mi">4</span><span class="p">;</span> <span class="n">columns</span> <span class="o">=</span> <span class="mi">3</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">columns</span> <span class="o">=</span> <span class="mi">3</span>
            <span class="n">rows</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">titles</span><span class="p">)</span><span class="o">/</span><span class="n">columns</span><span class="p">))</span>
        
    <span class="n">n_titles</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">titles</span><span class="p">)</span>
    <span class="n">chunk</span> <span class="o">=</span> <span class="n">rows</span><span class="o">*</span><span class="n">columns</span>
    <span class="n">n_chunks</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">n_titles</span><span class="o">/</span><span class="n">chunk</span><span class="p">))</span>
    <span class="n">barWidth</span> <span class="o">=</span> <span class="mi">70</span>
    <span class="n">alpha</span> <span class="o">=</span> <span class="mf">1.0</span>
    <span class="n">e</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_chunks</span><span class="p">):</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="n">fig_sizes</span><span class="p">)</span>
        <span class="n">_titles</span> <span class="o">=</span> <span class="n">titles</span><span class="p">[</span><span class="n">k</span><span class="o">*</span><span class="n">chunk</span><span class="p">:(</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">chunk</span><span class="p">]</span>
        <span class="n">_series</span> <span class="o">=</span> <span class="n">series</span><span class="p">[</span><span class="n">k</span><span class="o">*</span><span class="n">chunk</span><span class="p">:(</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">chunk</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">t</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">_titles</span><span class="p">):</span>
            <span class="n">tmin</span><span class="p">,</span><span class="n">tmax</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span><span class="kc">None</span>
            <span class="n">b</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">_series</span><span class="p">):</span>
                <span class="n">entries</span> <span class="o">=</span> <span class="n">_series</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">entries</span><span class="p">,</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">):</span>
                    <span class="n">entries</span> <span class="o">=</span> <span class="n">entries</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
                    <span class="k">if</span> <span class="n">tmin</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> 
                        <span class="n">tmin</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">entries</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">tmin</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">tmin</span><span class="p">,</span><span class="nb">min</span><span class="p">(</span><span class="n">entries</span><span class="o">.</span><span class="n">index</span><span class="p">))</span>
                    <span class="k">if</span> <span class="n">tmax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> 
                        <span class="n">tmax</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">entries</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">tmax</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">tmax</span><span class="p">,</span><span class="nb">max</span><span class="p">(</span><span class="n">entries</span><span class="o">.</span><span class="n">index</span><span class="p">))</span>
                    <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span><span class="n">wrap</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                        <span class="n">line</span><span class="p">,</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">entries</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">line</span><span class="p">,</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">entries</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">marker</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="n">markersize</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">zorder</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
                        <span class="n">line</span><span class="o">.</span><span class="n">set_dashes</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
                    <span class="k">if</span> <span class="n">zero_line</span><span class="p">:</span>
                        <span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">)</span>
                        
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">labels</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="n">lbls</span> <span class="o">=</span> <span class="p">[]</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">lbls</span> <span class="o">=</span> <span class="n">labels</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span> <span class="k">else</span> <span class="p">[]</span>
                    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">entries</span><span class="p">)</span>
                    <span class="n">c</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
                    <span class="n">bottomPlus</span><span class="p">,</span><span class="n">bottomMinus</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span><span class="mi">0</span> 
                    <span class="c1"># width_ = 0.77/columns</span>
                    <span class="c1"># height_ = 0.6/rows</span>
                    <span class="c1"># left_ = (1-width_*columns)/2 + 0.9*(jj-1)/columns</span>
                    <span class="c1"># bottom_ = min(0.93-height_,0.93-0.9*ii/rows+0.05)</span>
                    <span class="c1"># if jj==columns:</span>
                    <span class="c1">#     jj = 0</span>
                    <span class="c1">#     ii += 1</span>
                    <span class="c1">#print(ii,jj,left_,bottom_)</span>
                    <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">rows</span><span class="p">,</span><span class="n">columns</span><span class="p">,</span><span class="mi">1</span><span class="o">+</span><span class="n">i</span><span class="p">)</span>
                    <span class="c1">#pos = ax.get_position()</span>
                    <span class="c1">#print(pos)</span>
                    <span class="c1">#ax.set_position(np.array([left_,bottom_,width_,height_]))</span>
                    <span class="c1">#print([left_,bottom_,width_,height_])</span>
                    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span><span class="n">wrap</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                    <span class="n">data</span> <span class="o">=</span> <span class="p">{}</span>
                    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
                        <span class="k">if</span> <span class="n">entries</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                            <span class="k">continue</span>
                        <span class="n">e</span> <span class="o">=</span> <span class="n">entries</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
                        <span class="c1">#e = entries[j].fillna(0)</span>
                        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">e</span><span class="p">,</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">):</span>
                            <span class="k">if</span> <span class="n">tmin</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> 
                                <span class="n">tmin</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
                            <span class="k">else</span><span class="p">:</span>
                                <span class="n">tmin</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">tmin</span><span class="p">,</span><span class="nb">min</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">index</span><span class="p">))</span>
                            <span class="k">if</span> <span class="n">tmax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> 
                                <span class="n">tmax</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
                            <span class="k">else</span><span class="p">:</span>
                                <span class="n">tmax</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">tmax</span><span class="p">,</span><span class="nb">max</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">index</span><span class="p">))</span>
                            <span class="k">if</span> <span class="n">j</span><span class="o">&lt;</span><span class="nb">len</span><span class="p">(</span><span class="n">lbls</span><span class="p">):</span>
                                <span class="n">lb</span> <span class="o">=</span> <span class="n">lbls</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
                                <span class="n">b</span> <span class="o">=</span> <span class="kc">True</span>
                            <span class="k">else</span><span class="p">:</span>
                                <span class="n">lb</span> <span class="o">=</span> <span class="kc">None</span>
                            <span class="k">if</span> <span class="n">n</span> <span class="o">&lt;=</span> <span class="mi">2</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">stacked</span><span class="p">:</span>
                                <span class="k">if</span> <span class="n">lb</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                                    <span class="n">line</span><span class="p">,</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">e</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">marker</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="n">markersize</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">zorder</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
                                <span class="k">else</span><span class="p">:</span>
                                    <span class="n">line</span><span class="p">,</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">e</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">marker</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="n">markersize</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">zorder</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="n">lb</span><span class="p">)</span>
                                <span class="k">if</span> <span class="n">j</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                                    <span class="n">line</span><span class="o">.</span><span class="n">set_dashes</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
                                <span class="k">if</span> <span class="n">zero_line</span><span class="p">:</span>
                                    <span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">)</span>
                
                            <span class="k">else</span><span class="p">:</span>
                                <span class="n">data</span><span class="p">[</span><span class="n">lb</span><span class="p">]</span> <span class="o">=</span> <span class="n">e</span>
                                <span class="n">ind</span> <span class="o">=</span> <span class="n">e</span><span class="o">.</span><span class="n">index</span>
                                <span class="n">zPlus</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">e</span><span class="o">+</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
                                <span class="n">zMinus</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">e</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">e</span><span class="p">))</span> 
                                <span class="n">c</span> <span class="o">+=</span> <span class="mi">1</span>
                                <span class="n">c</span> <span class="o">=</span> <span class="n">c</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">colors</span><span class="p">)</span>
                                <span class="c1"># Stacked bar plots</span>
                                <span class="k">try</span><span class="p">:</span>
                                    <span class="k">if</span> <span class="n">j</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                                        <span class="k">if</span> <span class="ow">not</span> <span class="n">lb</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                                            <span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">ind</span><span class="p">,</span><span class="n">height</span><span class="o">=</span><span class="n">zPlus</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="n">lb</span><span class="p">,</span><span class="n">width</span><span class="o">=</span><span class="n">barWidth</span><span class="p">,</span><span class="n">align</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="n">c</span><span class="p">],</span><span class="n">edgecolor</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span>
                                        <span class="k">else</span><span class="p">:</span>
                                            <span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">ind</span><span class="p">,</span><span class="n">height</span><span class="o">=</span><span class="n">zPlus</span><span class="p">,</span><span class="n">width</span><span class="o">=</span><span class="n">barWidth</span><span class="p">,</span><span class="n">align</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="n">c</span><span class="p">],</span><span class="n">edgecolor</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span>
                                        <span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">ind</span><span class="p">,</span><span class="n">height</span><span class="o">=</span><span class="n">zMinus</span><span class="p">,</span><span class="n">width</span><span class="o">=</span><span class="n">barWidth</span><span class="p">,</span><span class="n">align</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="n">c</span><span class="p">],</span><span class="n">edgecolor</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span>
                                        <span class="n">bottomPlus</span>  <span class="o">=</span> <span class="n">zPlus</span>
                                        <span class="n">bottomMinus</span> <span class="o">=</span> <span class="n">zMinus</span>
                                    <span class="k">elif</span> <span class="n">j</span><span class="o">==</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span> <span class="ow">and</span> <span class="n">isLastLinePlot</span><span class="p">:</span>
                                        <span class="k">if</span> <span class="ow">not</span> <span class="n">lb</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                                            <span class="n">line</span><span class="p">,</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">e</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="n">lb</span><span class="p">)</span>
                                        <span class="k">else</span><span class="p">:</span>
                                            <span class="n">line</span><span class="p">,</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">e</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
                                    <span class="k">else</span><span class="p">:</span>
                                        <span class="k">if</span> <span class="ow">not</span> <span class="n">lb</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                                            <span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">ind</span><span class="p">,</span><span class="n">zPlus</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="n">lb</span><span class="p">,</span><span class="n">bottom</span><span class="o">=</span><span class="n">bottomPlus</span><span class="p">[</span><span class="n">zPlus</span><span class="o">.</span><span class="n">index</span><span class="p">],</span><span class="n">width</span><span class="o">=</span><span class="n">barWidth</span><span class="p">,</span><span class="n">align</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="n">c</span><span class="p">],</span><span class="n">edgecolor</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span>
                                        <span class="k">else</span><span class="p">:</span>    
                                            <span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">ind</span><span class="p">,</span><span class="n">zPlus</span><span class="p">,</span><span class="n">bottom</span><span class="o">=</span><span class="n">bottomPlus</span><span class="p">[</span><span class="n">zPlus</span><span class="o">.</span><span class="n">index</span><span class="p">],</span><span class="n">width</span><span class="o">=</span><span class="n">barWidth</span><span class="p">,</span><span class="n">align</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="n">c</span><span class="p">],</span><span class="n">edgecolor</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span>                                                                   
                                        <span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">ind</span><span class="p">,</span><span class="n">zMinus</span><span class="p">,</span><span class="n">bottom</span><span class="o">=</span><span class="n">bottomMinus</span><span class="p">[</span><span class="n">zMinus</span><span class="o">.</span><span class="n">index</span><span class="p">],</span><span class="n">width</span><span class="o">=</span><span class="n">barWidth</span><span class="p">,</span><span class="n">align</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="n">c</span><span class="p">],</span><span class="n">edgecolor</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span>
                                        <span class="n">bottomPlus</span> <span class="o">+=</span> <span class="n">zPlus</span>
                                        <span class="n">bottomMinus</span> <span class="o">+=</span> <span class="n">zMinus</span>
                                    <span class="k">if</span> <span class="n">zero_line</span><span class="p">:</span>
                                        <span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">)</span>              
                                <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
                                    <span class="n">cprint</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;plotTimeSeries: Series - </span><span class="si">{</span><span class="n">lb</span><span class="si">}</span><span class="s2">, Error - </span><span class="si">{</span><span class="n">exc</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span><span class="s2">&quot;red&quot;</span><span class="p">)</span>
                                    
                                        
                    <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_tick_params</span><span class="p">(</span><span class="n">labelsize</span><span class="o">=</span><span class="s1">&#39;medium&#39;</span><span class="p">)</span>
                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">get_ticklabels</span><span class="p">())</span> <span class="o">&gt;=</span> <span class="mi">10</span><span class="p">:</span>
                        <span class="p">[</span><span class="n">l</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span> <span class="k">for</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">l</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">get_ticklabels</span><span class="p">())</span> <span class="k">if</span> <span class="n">i</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">]</span>
                    <span class="c1"># if not e is None and (isinstance(e.index,pd.DatetimeIndex) or isinstance(e.index[0],datetime)):</span>
                    <span class="c1">#     ax.xaxis.set_minor_locator(matplotlib.dates.MonthLocator([1,4,7,10]))</span>
                    <span class="c1">#     ax.xaxis.set_major_locator(matplotlib.dates.YearLocator())</span>
                    <span class="c1">#     ax.xaxis.set_major_formatter(matplotlib.dates.DateFormatter(&#39;%Y&#39;))</span>
            
            <span class="k">if</span> <span class="n">b</span><span class="p">:</span> 
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
                    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s2">&quot;best&quot;</span><span class="p">,</span><span class="n">mode</span><span class="o">=</span><span class="s2">&quot;expand&quot;</span><span class="p">,</span><span class="n">ncol</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">lbls</span><span class="p">),</span><span class="n">fontsize</span><span class="o">=</span><span class="s1">&#39;medium&#39;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s2">&quot;best&quot;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="s1">&#39;medium&#39;</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="mi">45</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
                
            <span class="k">if</span> <span class="ow">not</span> <span class="n">highlight</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">highlight</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="nb">str</span><span class="p">):</span>
                    <span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span> <span class="k">as</span> <span class="n">dt</span>
                    <span class="n">x1</span> <span class="o">=</span> <span class="n">dt</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">highlight</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">)</span>
                    <span class="n">x2</span> <span class="o">=</span> <span class="n">dt</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">highlight</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">x1</span> <span class="o">=</span> <span class="n">highlight</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="n">x2</span> <span class="o">=</span> <span class="n">highlight</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                
                <span class="n">ax</span><span class="o">.</span><span class="n">axvspan</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span><span class="n">x2</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span> 
    
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">titles</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">12</span><span class="p">:</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">autofmt_xdate</span><span class="p">(</span><span class="n">bottom</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">45</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;major&#39;</span><span class="p">)</span>
            
        <span class="n">make_space_above</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="n">header</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">17</span><span class="p">,</span><span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;normal&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">show</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">block</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        
        <span class="n">_header</span> <span class="o">=</span> <span class="n">header</span> <span class="k">if</span> <span class="n">k</span><span class="o">==</span><span class="mi">0</span> <span class="k">else</span> <span class="n">header</span><span class="o">+</span><span class="s2">&quot;_&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">save</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">ext</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path_to_dir</span><span class="p">,</span><span class="n">_header</span><span class="o">+</span><span class="s2">&quot;.pdf&quot;</span><span class="p">),</span><span class="n">dpi</span><span class="o">=</span><span class="mi">600</span><span class="p">)</span>
                <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path_to_dir</span><span class="p">,</span><span class="n">_header</span><span class="o">+</span><span class="s2">&quot;.png&quot;</span><span class="p">),</span><span class="n">dpi</span><span class="o">=</span><span class="mi">600</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path_to_dir</span><span class="p">,</span><span class="n">_header</span><span class="o">+</span><span class="s2">&quot;.&quot;</span><span class="o">+</span><span class="n">ext</span><span class="p">),</span><span class="n">dpi</span><span class="o">=</span><span class="mi">600</span><span class="p">)</span>
                
    <span class="k">return</span> <span class="n">fig</span></div>


 
<div class="viewcode-block" id="plotSeries">
<a class="viewcode-back" href="../../../../source/snowdrop.src.graphs.html#snowdrop.src.graphs.util.plotSeries">[docs]</a>
<span class="k">def</span> <span class="nf">plotSeries</span><span class="p">(</span><span class="n">path_to_dir</span><span class="p">,</span><span class="n">header</span><span class="p">,</span><span class="n">titles</span><span class="p">,</span><span class="n">labels</span><span class="p">,</span><span class="n">series</span><span class="p">,</span><span class="n">sizes</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">xlabel</span><span class="o">=</span><span class="p">[],</span><span class="n">ylabel</span><span class="o">=</span><span class="p">[],</span><span class="n">plotType</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">fig_sizes</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">10</span><span class="p">),</span><span class="n">save</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">show</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">ext</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;    </span>
<span class="sd">    Plot time series.</span>
<span class="sd">    </span>
<span class="sd">    Parameters:</span>
<span class="sd">        :param path_to_dir: Path to the folder where figures are saved.</span>
<span class="sd">        :type path_to_dir: str.</span>
<span class="sd">        :param header: List of variables.</span>
<span class="sd">        :type header: str.</span>
<span class="sd">        :param titles: List of graphs titles.</span>
<span class="sd">        :type titles: list.</span>
<span class="sd">        :param labels: List of graphs labels.</span>
<span class="sd">        :type labels: list.</span>
<span class="sd">        :param sizes: Subplots dimensions.</span>
<span class="sd">        :type sizes: tuple.</span>
<span class="sd">        :param plotType: Type of plot, i.e., line plot, bar plot, etc.</span>
<span class="sd">        :type plotType: str.</span>
<span class="sd">        :param xlabel: X labels of plot.</span>
<span class="sd">        :type xlabel: list.</span>
<span class="sd">        :param ylabel: Y labels of plot.</span>
<span class="sd">        :type ylabel: list.</span>
<span class="sd">        :param save: If True saves plot in a pdf format.</span>
<span class="sd">        :type save: bool.</span>
<span class="sd">        :param isLastLinePlot: If True the last series plot will be drawn as line plots.</span>
<span class="sd">        :type isLastLinePlot: bool.</span>
<span class="sd">        :param show: If True display plots.</span>
<span class="sd">        :type show: bool.</span>
<span class="sd">        :param ext: Format of the saved file.</span>
<span class="sd">        :type ext: str.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1">#import matplotlib.gridspec as gridspec</span>
    <span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="n">STYLE</span><span class="p">)</span>
    <span class="n">colors</span> <span class="o">=</span> <span class="n">getColors</span><span class="p">()</span>
    
    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="n">fig_sizes</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="ow">not</span> <span class="n">sizes</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">rows</span><span class="p">,</span> <span class="n">columns</span> <span class="o">=</span> <span class="n">sizes</span>
        <span class="k">if</span> <span class="n">plotType</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">plotType</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;line&quot;</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">titles</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">rows</span> <span class="o">=</span> <span class="n">columns</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">titles</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">rows</span><span class="p">,</span> <span class="n">columns</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span><span class="mi">1</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">titles</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">4</span><span class="p">:</span>   
            <span class="n">rows</span> <span class="o">=</span> <span class="n">columns</span> <span class="o">=</span> <span class="mi">2</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">titles</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">6</span><span class="p">:</span>   
            <span class="n">rows</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span> <span class="n">columns</span> <span class="o">=</span> <span class="mi">2</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">titles</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">8</span><span class="p">:</span>   
            <span class="n">rows</span> <span class="o">=</span> <span class="mi">4</span><span class="p">;</span> <span class="n">columns</span> <span class="o">=</span> <span class="mi">2</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">titles</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">9</span><span class="p">:</span>   
            <span class="n">rows</span> <span class="o">=</span> <span class="n">columns</span> <span class="o">=</span> <span class="mi">3</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">titles</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">12</span><span class="p">:</span>   
            <span class="n">rows</span> <span class="o">=</span> <span class="mi">4</span><span class="p">;</span> <span class="n">columns</span> <span class="o">=</span> <span class="mi">3</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">rows</span><span class="p">,</span> <span class="n">columns</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span><span class="mi">3</span>
        <span class="k">if</span> <span class="n">plotType</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">plotType</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;line&quot;</span><span class="p">]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">titles</span><span class="p">)</span>
 
    <span class="n">barWidth</span> <span class="o">=</span> <span class="mi">150</span>
    <span class="n">alpha</span> <span class="o">=</span> <span class="mf">1.0</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">t</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">titles</span><span class="p">):</span>
        <span class="n">entries</span> <span class="o">=</span> <span class="n">series</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">entries</span><span class="p">)</span>
        <span class="n">tmin</span><span class="p">,</span><span class="n">tmax</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span><span class="kc">None</span>
        <span class="k">if</span> <span class="n">labels</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">lbls</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">lbls</span> <span class="o">=</span> <span class="n">labels</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span> <span class="k">else</span> <span class="p">[]</span>
        <span class="n">xlb</span> <span class="o">=</span> <span class="n">xlabel</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">xlabel</span><span class="p">)</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="n">ylb</span> <span class="o">=</span> <span class="n">ylabel</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">ylabel</span><span class="p">)</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">rows</span><span class="p">,</span><span class="n">columns</span><span class="p">,</span><span class="mi">1</span><span class="o">+</span><span class="n">i</span><span class="p">)</span>
        <span class="n">b</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="n">plotType</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;line&quot;</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">entries</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="k">continue</span>
                <span class="n">e</span> <span class="o">=</span> <span class="n">entries</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">j</span><span class="o">&lt;</span><span class="nb">len</span><span class="p">(</span><span class="n">lbls</span><span class="p">):</span>
                    <span class="n">lb</span> <span class="o">=</span> <span class="n">lbls</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
                    <span class="n">b</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">lb</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="k">if</span> <span class="n">j</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
                    <span class="n">line</span><span class="p">,</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">e</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="n">lb</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">line</span><span class="p">,</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">e</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="n">lb</span><span class="p">,</span><span class="n">marker</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="n">markersize</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">zorder</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
                    <span class="n">line</span><span class="o">.</span><span class="n">set_dashes</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
                
        <span class="k">elif</span> <span class="n">plotType</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;bar&quot;</span><span class="p">:</span>
            <span class="n">c</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
            <span class="n">bottomPlus</span><span class="p">,</span><span class="n">bottomMinus</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span><span class="mi">0</span> 
            <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
            <span class="n">data</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
                <span class="n">e</span> <span class="o">=</span> <span class="n">entries</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">e</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="k">continue</span>
                <span class="n">e</span> <span class="o">=</span> <span class="n">e</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">e</span><span class="p">,</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">):</span>
                    <span class="k">if</span> <span class="n">tmin</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> 
                        <span class="n">tmin</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">tmin</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">tmin</span><span class="p">,</span><span class="nb">min</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">index</span><span class="p">))</span>
                    <span class="k">if</span> <span class="n">tmax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> 
                        <span class="n">tmax</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">tmax</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">tmax</span><span class="p">,</span><span class="nb">max</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">index</span><span class="p">))</span>
                    <span class="k">if</span> <span class="n">j</span><span class="o">&lt;</span><span class="nb">len</span><span class="p">(</span><span class="n">lbls</span><span class="p">):</span>
                        <span class="n">lb</span> <span class="o">=</span> <span class="n">lbls</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
                        <span class="n">b</span> <span class="o">=</span> <span class="kc">True</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">lb</span> <span class="o">=</span> <span class="kc">None</span>
                    <span class="n">data</span><span class="p">[</span><span class="n">lb</span><span class="p">]</span> <span class="o">=</span> <span class="n">e</span>
                    <span class="n">z</span> <span class="o">=</span> <span class="n">e</span><span class="o">.</span><span class="n">values</span>
                    <span class="n">ind</span> <span class="o">=</span> <span class="n">e</span><span class="o">.</span><span class="n">index</span>
                    <span class="n">zPlus</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">z</span><span class="o">+</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">z</span><span class="p">))</span>
                    <span class="n">zMinus</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">z</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">z</span><span class="p">))</span> 
                    <span class="n">c</span> <span class="o">+=</span> <span class="mi">1</span>
                    <span class="n">c</span> <span class="o">=</span> <span class="n">c</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">colors</span><span class="p">)</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="c1"># Stacked bar plots</span>
                        <span class="k">if</span> <span class="n">j</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                            <span class="k">if</span> <span class="ow">not</span> <span class="n">lb</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                                <span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">ind</span><span class="p">,</span><span class="n">height</span><span class="o">=</span><span class="n">zPlus</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="n">lb</span><span class="p">,</span><span class="n">width</span><span class="o">=</span><span class="n">barWidth</span><span class="p">,</span><span class="n">align</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="n">c</span><span class="p">],</span><span class="n">edgecolor</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span>
                            <span class="k">else</span><span class="p">:</span>
                                <span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">ind</span><span class="p">,</span><span class="n">height</span><span class="o">=</span><span class="n">zPlus</span><span class="p">,</span><span class="n">width</span><span class="o">=</span><span class="n">barWidth</span><span class="p">,</span><span class="n">align</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="n">c</span><span class="p">],</span><span class="n">edgecolor</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span>
                            <span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">ind</span><span class="p">,</span><span class="n">height</span><span class="o">=</span><span class="n">zMinus</span><span class="p">,</span><span class="n">width</span><span class="o">=</span><span class="n">barWidth</span><span class="p">,</span><span class="n">align</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="n">c</span><span class="p">],</span><span class="n">edgecolor</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="k">if</span> <span class="ow">not</span> <span class="n">lb</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                                <span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">ind</span><span class="p">,</span><span class="n">zPlus</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="n">lb</span><span class="p">,</span><span class="n">bottom</span><span class="o">=</span><span class="n">bottomPlus</span><span class="p">,</span><span class="n">width</span><span class="o">=</span><span class="n">barWidth</span><span class="p">,</span><span class="n">align</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="n">c</span><span class="p">],</span><span class="n">edgecolor</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span>
                            <span class="k">else</span><span class="p">:</span>    
                                <span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">ind</span><span class="p">,</span><span class="n">zPlus</span><span class="p">,</span><span class="n">bottom</span><span class="o">=</span><span class="n">bottomPlus</span><span class="p">,</span><span class="n">width</span><span class="o">=</span><span class="n">barWidth</span><span class="p">,</span><span class="n">align</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="n">c</span><span class="p">],</span><span class="n">edgecolor</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span>                                                                   
                            <span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">ind</span><span class="p">,</span><span class="n">zMinus</span><span class="p">,</span><span class="n">bottom</span><span class="o">=</span><span class="n">bottomMinus</span><span class="p">,</span><span class="n">width</span><span class="o">=</span><span class="n">barWidth</span><span class="p">,</span><span class="n">align</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="n">c</span><span class="p">],</span><span class="n">edgecolor</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span>
                        <span class="n">bottomPlus</span> <span class="o">+=</span> <span class="n">zPlus</span>
                        <span class="n">bottomMinus</span> <span class="o">+=</span> <span class="n">zMinus</span>
                    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
                        <span class="n">cprint</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;plotSeries: Series - </span><span class="si">{</span><span class="n">lb</span><span class="si">}</span><span class="s2">, Error - </span><span class="si">{</span><span class="n">exc</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span><span class="s2">&quot;red&quot;</span><span class="p">)</span>
            
        <span class="k">elif</span> <span class="n">plotType</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;fill&quot;</span><span class="p">:</span>
            <span class="n">c</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span> 
            <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
            <span class="n">zPrevious</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
                <span class="n">e</span> <span class="o">=</span> <span class="n">entries</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">e</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="k">continue</span>
                <span class="n">e</span> <span class="o">=</span> <span class="n">e</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">e</span><span class="p">,</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">):</span>
                    <span class="k">if</span> <span class="n">j</span><span class="o">&lt;</span><span class="nb">len</span><span class="p">(</span><span class="n">lbls</span><span class="p">):</span>
                        <span class="n">lb</span> <span class="o">=</span> <span class="n">lbls</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
                        <span class="n">b</span> <span class="o">=</span> <span class="kc">True</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">lb</span> <span class="o">=</span> <span class="kc">None</span>
                    <span class="n">z</span> <span class="o">=</span> <span class="n">zPrevious</span> <span class="o">+</span> <span class="n">e</span><span class="o">.</span><span class="n">values</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">z</span><span class="o">==</span><span class="mi">0</span><span class="p">):</span>
                        <span class="n">ind</span> <span class="o">=</span> <span class="n">e</span><span class="o">.</span><span class="n">index</span> 
                        <span class="n">c</span> <span class="o">+=</span> <span class="mi">1</span>
                        <span class="n">c</span> <span class="o">=</span> <span class="n">c</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">colors</span><span class="p">)</span>
                        <span class="c1"># Fill area</span>
                        <span class="n">plt</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">ind</span><span class="p">,</span><span class="n">y1</span><span class="o">=</span><span class="n">zPrevious</span><span class="p">,</span><span class="n">y2</span><span class="o">=</span><span class="n">z</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="n">lb</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="n">c</span><span class="p">],</span><span class="n">edgecolor</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span>
                        <span class="n">zPrevious</span> <span class="o">=</span> <span class="n">z</span>            
                                
            <span class="k">if</span> <span class="ow">not</span> <span class="n">xlb</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">xlb</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">ylb</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">ylb</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_tick_params</span><span class="p">(</span><span class="n">labelsize</span><span class="o">=</span><span class="s1">&#39;medium&#39;</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">b</span><span class="p">:</span> 
            <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s2">&quot;best&quot;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="s1">&#39;medium&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
            

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">titles</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">4</span><span class="p">:</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">autofmt_xdate</span><span class="p">()</span>
        
    <span class="n">make_space_above</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="n">header</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">17</span><span class="p">,</span><span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;normal&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">show</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">block</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">save</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">ext</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path_to_dir</span><span class="p">,</span><span class="n">header</span><span class="o">+</span><span class="s2">&quot;.pdf&quot;</span><span class="p">),</span><span class="n">dpi</span><span class="o">=</span><span class="mi">600</span><span class="p">)</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path_to_dir</span><span class="p">,</span><span class="n">header</span><span class="o">+</span><span class="s2">&quot;.png&quot;</span><span class="p">),</span><span class="n">dpi</span><span class="o">=</span><span class="mi">600</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path_to_dir</span><span class="p">,</span><span class="n">header</span><span class="o">+</span><span class="s2">&quot;.&quot;</span><span class="o">+</span><span class="n">ext</span><span class="p">),</span><span class="n">dpi</span><span class="o">=</span><span class="mi">600</span><span class="p">)</span>
            
    <span class="k">return</span> <span class="n">fig</span></div>



<div class="viewcode-block" id="barPlot">
<a class="viewcode-back" href="../../../../source/snowdrop.src.graphs.html#snowdrop.src.graphs.util.barPlot">[docs]</a>
<span class="k">def</span> <span class="nf">barPlot</span><span class="p">(</span><span class="n">path_to_dir</span><span class="p">,</span><span class="n">titles</span><span class="p">,</span><span class="n">data</span><span class="p">,</span><span class="n">labels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">xLabel</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">yLabel</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">sizes</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">plot_variables</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">fig_sizes</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">6</span><span class="p">),</span><span class="n">save</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">show</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">ext</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;    </span>
<span class="sd">    Plot bar graph.</span>
<span class="sd">    </span>
<span class="sd">    Parameters:</span>
<span class="sd">        :param path_to_dir: Path to the folder where figures are saved.</span>
<span class="sd">        :type path_to_dir: str.</span>
<span class="sd">        :param titles: Title.</span>
<span class="sd">        :type titles: str or list.</span>
<span class="sd">        :param data: Data.</span>
<span class="sd">        :type data: numpy array.</span>
<span class="sd">        :param labels: List of graphs labels.</span>
<span class="sd">        :type labels: list.</span>
<span class="sd">        :param xLabel: X axis label.</span>
<span class="sd">        :type xLabel: str.</span>
<span class="sd">        :param yLabel: Y axis label.</span>
<span class="sd">        :type yLabel: str.</span>
<span class="sd">        :param sizes: Subplots dimensions.</span>
<span class="sd">        :type sizes: tuple.</span>
<span class="sd">        :param plot_variables: If True plot selected variables.</span>
<span class="sd">        :type plot_variables: bool.</span>
<span class="sd">        :param fig_sizes: Figure sizes.</span>
<span class="sd">        :type fig_sizes: Tuple.</span>
<span class="sd">        :param save: If True saves plot in a pdf format.</span>
<span class="sd">        :type save: bool.</span>
<span class="sd">        :param show: If True display plots.</span>
<span class="sd">        :type show: bool.</span>
<span class="sd">        :param ext: Format of the saved file.</span>
<span class="sd">        :type ext: str.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1">#import matplotlib.gridspec as gridspec</span>
    <span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="n">STYLE</span><span class="p">)</span>
    
    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="n">fig_sizes</span><span class="p">)</span>
    <span class="n">barWidth</span> <span class="o">=</span> <span class="mf">0.3</span>
    <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.8</span>
    <span class="k">if</span> <span class="n">labels</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">labels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="o">+</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>
        
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">titles</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">rows</span> <span class="o">=</span> <span class="n">columns</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">titles</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
        <span class="n">rows</span><span class="p">,</span> <span class="n">columns</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span><span class="mi">1</span>
    <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">titles</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">4</span><span class="p">:</span>   
        <span class="n">rows</span> <span class="o">=</span> <span class="n">columns</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">titles</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">6</span><span class="p">:</span>   
        <span class="n">rows</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span> <span class="n">columns</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">titles</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">8</span><span class="p">:</span>   
        <span class="n">rows</span> <span class="o">=</span> <span class="mi">4</span><span class="p">;</span> <span class="n">columns</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">titles</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">9</span><span class="p">:</span>   
        <span class="n">rows</span> <span class="o">=</span> <span class="n">columns</span> <span class="o">=</span> <span class="mi">3</span>
    <span class="k">elif</span> <span class="ow">not</span> <span class="n">sizes</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">rows</span><span class="p">,</span> <span class="n">columns</span> <span class="o">=</span> <span class="n">sizes</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">rows</span> <span class="o">=</span> <span class="n">columns</span> <span class="o">=</span> <span class="mi">3</span>
    
    <span class="k">if</span> <span class="n">plot_variables</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">t</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">titles</span><span class="p">):</span>
            <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">rows</span><span class="p">,</span><span class="n">columns</span><span class="p">,</span><span class="mi">1</span><span class="o">+</span><span class="n">i</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
            <span class="n">zPlus</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
            <span class="n">zMinus</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span> 
            <span class="n">ax</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">labels</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">height</span><span class="o">=</span><span class="n">zPlus</span><span class="p">,</span><span class="n">width</span><span class="o">=</span><span class="n">barWidth</span><span class="p">,</span><span class="n">align</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span><span class="n">edgecolor</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">labels</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">height</span><span class="o">=</span><span class="n">zMinus</span><span class="p">,</span><span class="n">width</span><span class="o">=</span><span class="n">barWidth</span><span class="p">,</span><span class="n">align</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span><span class="n">edgecolor</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">],(</span><span class="nb">list</span><span class="p">,</span><span class="nb">tuple</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)):</span>
            <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Baseline&#39;</span><span class="p">],</span><span class="n">index</span><span class="o">=</span><span class="n">labels</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">])):</span>
                <span class="n">df</span><span class="p">[</span><span class="s2">&quot;Scenario &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[:,</span><span class="n">i</span><span class="p">]</span>
            <span class="n">fig</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">get_figure</span><span class="p">()</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">ticker</span><span class="o">.</span><span class="n">FormatStrFormatter</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%.0f</span><span class="s1">&#39;</span><span class="p">))</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_tick_params</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">zPlus</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">data</span><span class="o">+</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>
            <span class="n">zMinus</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">data</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">data</span><span class="p">))</span> 
            <span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">labels</span><span class="p">,</span><span class="n">height</span><span class="o">=</span><span class="n">zPlus</span><span class="p">,</span><span class="n">width</span><span class="o">=</span><span class="n">barWidth</span><span class="p">,</span><span class="n">align</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span><span class="n">edgecolor</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">labels</span><span class="p">,</span><span class="n">height</span><span class="o">=</span><span class="n">zMinus</span><span class="p">,</span><span class="n">width</span><span class="o">=</span><span class="n">barWidth</span><span class="p">,</span><span class="n">align</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span><span class="n">edgecolor</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span>
            
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">titles</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">xLabel</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="n">xLabel</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">yLabel</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="n">yLabel</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
            
    <span class="k">if</span> <span class="n">show</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">block</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">save</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">titles</span><span class="p">,</span><span class="nb">list</span><span class="p">):</span>
            <span class="n">header</span> <span class="o">=</span> <span class="s2">&quot;_&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">titles</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">header</span> <span class="o">=</span> <span class="n">titles</span>
        <span class="k">if</span> <span class="n">ext</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path_to_dir</span><span class="p">,</span><span class="n">header</span><span class="o">+</span><span class="s2">&quot;.pdf&quot;</span><span class="p">),</span><span class="n">dpi</span><span class="o">=</span><span class="mi">600</span><span class="p">)</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path_to_dir</span><span class="p">,</span><span class="n">header</span><span class="o">+</span><span class="s2">&quot;.png&quot;</span><span class="p">),</span><span class="n">dpi</span><span class="o">=</span><span class="mi">600</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path_to_dir</span><span class="p">,</span><span class="n">header</span><span class="o">+</span><span class="s2">&quot;.&quot;</span><span class="o">+</span><span class="n">ext</span><span class="p">),</span><span class="n">dpi</span><span class="o">=</span><span class="mi">600</span><span class="p">)</span>
            
    <span class="k">return</span>  </div>

  
               
<div class="viewcode-block" id="plot_chain">
<a class="viewcode-back" href="../../../../source/snowdrop.src.graphs.html#snowdrop.src.graphs.util.plot_chain">[docs]</a>
<span class="k">def</span> <span class="nf">plot_chain</span><span class="p">(</span><span class="n">path_to_dir</span><span class="p">,</span><span class="n">chains</span><span class="p">,</span><span class="n">names</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">sizes</span><span class="o">=</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span><span class="n">figsize</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">save</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">ext</span><span class="o">=</span><span class="s2">&quot;pdf&quot;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Plot sampling chain for each parameter.</span>

<span class="sd">    Args:</span>
<span class="sd">        * **param path_to_dir** Path to the folder where figures </span>
<span class="sd">          are saved</span>
<span class="sd">        * **chains** (:class:`~numpy.ndarray`): Sampling chain for each</span>
<span class="sd">          parameter</span>
<span class="sd">        * **names** (:py:class:`list`): List of strings - name of each</span>
<span class="sd">          parameter</span>
<span class="sd">        * **figsize** (:py:class:`list`): Specify figure size in inches</span>
<span class="sd">          [Width, Height]</span>
<span class="sd">        * **save* If True saves plot in a pdf format</span>
<span class="sd">        * **ext* Format of the saved file</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">rows</span><span class="p">,</span> <span class="n">columns</span> <span class="o">=</span> <span class="n">sizes</span>
    <span class="k">if</span> <span class="n">names</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">rows</span><span class="p">,</span> <span class="n">columns</span> <span class="o">=</span> <span class="n">sizes</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">names</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">rows</span> <span class="o">=</span> <span class="n">columns</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">names</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">rows</span><span class="p">,</span> <span class="n">columns</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="mi">2</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">names</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">4</span><span class="p">:</span>   
            <span class="n">rows</span> <span class="o">=</span> <span class="n">columns</span> <span class="o">=</span> <span class="mi">2</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">names</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">6</span><span class="p">:</span>   
            <span class="n">rows</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span> <span class="n">columns</span> <span class="o">=</span> <span class="mi">3</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">columns</span> <span class="o">=</span> <span class="mi">2</span>
            <span class="n">rows</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">names</span><span class="p">)</span><span class="o">/</span><span class="n">columns</span><span class="p">))</span>
    
    <span class="k">if</span> <span class="n">figsize</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">figsize</span> <span class="o">=</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
        
    <span class="n">nsimu</span><span class="p">,</span> <span class="n">nparam</span> <span class="o">=</span> <span class="n">chains</span><span class="o">.</span><span class="n">shape</span>  <span class="c1"># number of rows, number of columns</span>
    <span class="n">inds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">nsimu</span><span class="p">)</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">dpi</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="n">figsize</span><span class="p">))</span>  <span class="c1"># initialize figure</span>
    <span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nparam</span><span class="p">):</span>
        <span class="c1"># define chain</span>
        <span class="n">chain</span> <span class="o">=</span> <span class="n">chains</span><span class="p">[:,</span> <span class="n">ii</span><span class="p">]</span>  <span class="c1"># check indexing</span>
        <span class="c1"># plot chain on subplot</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">rows</span><span class="p">,</span> <span class="n">columns</span><span class="p">,</span> <span class="n">ii</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">inds</span><span class="p">,</span> <span class="n">chain</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">)</span>
        <span class="c1"># format figure</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Iteration&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">names</span><span class="p">[</span><span class="n">ii</span><span class="p">])))</span>
        <span class="k">if</span> <span class="n">ii</span><span class="o">+</span><span class="mi">1</span> <span class="o">&lt;=</span> <span class="n">rows</span><span class="o">*</span><span class="n">columns</span> <span class="o">-</span> <span class="n">columns</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
            
    <span class="k">if</span> <span class="ow">not</span> <span class="n">title</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">make_space_above</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="n">title</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">17</span><span class="p">,</span><span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;normal&#39;</span><span class="p">)</span>
      
    <span class="c1"># adjust spacing</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span> 
    
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">block</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">save</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">ext</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path_to_dir</span><span class="p">,</span><span class="s2">&quot;Convergence.pdf&quot;</span><span class="p">),</span><span class="n">dpi</span><span class="o">=</span><span class="mi">600</span><span class="p">)</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path_to_dir</span><span class="p">,</span><span class="s2">&quot;Convergence.png&quot;</span><span class="p">),</span><span class="n">dpi</span><span class="o">=</span><span class="mi">600</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path_to_dir</span><span class="p">,</span><span class="s2">&quot;Convergence.&quot;</span><span class="o">+</span><span class="n">ext</span><span class="p">),</span><span class="n">dpi</span><span class="o">=</span><span class="mi">600</span><span class="p">)</span></div>

    

<div class="viewcode-block" id="plot_pairwise_correlation">
<a class="viewcode-back" href="../../../../source/snowdrop.src.graphs.html#snowdrop.src.graphs.util.plot_pairwise_correlation">[docs]</a>
<span class="k">def</span> <span class="nf">plot_pairwise_correlation</span><span class="p">(</span><span class="n">path_to_dir</span><span class="p">,</span><span class="n">chains</span><span class="p">,</span><span class="n">names</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">save</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">ext</span><span class="o">=</span><span class="s2">&quot;pdf&quot;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Plot pairwise correlation for each parameter.</span>

<span class="sd">    Args:</span>
<span class="sd">        * **param path_to_dir** Path to the folder where figures </span>
<span class="sd">          are saved</span>
<span class="sd">        * **chains** (:class:`~numpy.ndarray`): Sampling chain for each</span>
<span class="sd">          parameter</span>
<span class="sd">        * **names** (:py:class:`list`): List of strings - name of each</span>
<span class="sd">          parameter</span>
<span class="sd">        * **figsize** (:py:class:`list`): Specify figure size in inches</span>
<span class="sd">          [Width, Height]</span>
<span class="sd">        * **save* If True saves plot in a pdf format</span>
<span class="sd">        * **ext* Format of the saved file</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">nsimu</span><span class="p">,</span> <span class="n">nparam</span> <span class="o">=</span> <span class="n">chains</span><span class="o">.</span><span class="n">shape</span>  <span class="c1"># number of rows, number of columns</span>
    <span class="n">inds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">nsimu</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">figsize</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">figsize</span> <span class="o">=</span> <span class="p">[</span><span class="mi">12</span><span class="p">,</span> <span class="mi">10</span><span class="p">]</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">dpi</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="n">figsize</span><span class="p">))</span>  <span class="c1"># initialize figure</span>
    <span class="k">for</span> <span class="n">jj</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">nparam</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">jj</span><span class="p">):</span>
            <span class="n">chain1</span> <span class="o">=</span> <span class="n">chains</span><span class="p">[</span><span class="n">inds</span><span class="p">,</span> <span class="n">ii</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
            <span class="n">chain2</span> <span class="o">=</span> <span class="n">chains</span><span class="p">[</span><span class="n">inds</span><span class="p">,</span> <span class="n">jj</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
            <span class="c1"># plot density on subplot</span>
            <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">nparam</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nparam</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="n">jj</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">nparam</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="n">ii</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">chain1</span><span class="p">,</span> <span class="n">chain2</span><span class="p">,</span> <span class="s1">&#39;.b&#39;</span><span class="p">)</span>
            <span class="c1"># format figure</span>
            <span class="k">if</span> <span class="n">jj</span> <span class="o">!=</span> <span class="n">nparam</span><span class="p">:</span>  <span class="c1"># rm xticks</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([])</span>
            <span class="k">if</span> <span class="n">ii</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>  <span class="c1"># rm yticks</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">([])</span>
            <span class="k">if</span> <span class="n">ii</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>  <span class="c1"># add ylabels</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">names</span><span class="p">[</span><span class="n">jj</span> <span class="o">-</span> <span class="mi">1</span><span class="p">])))</span>
            <span class="k">if</span> <span class="n">ii</span> <span class="o">==</span> <span class="n">jj</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">nparam</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>  <span class="c1"># add xlabels</span>
                    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">names</span><span class="p">[</span><span class="n">ii</span> <span class="o">-</span> <span class="mi">1</span><span class="p">])))</span>
                <span class="k">else</span><span class="p">:</span>  <span class="c1"># add title</span>
                    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">names</span><span class="p">[</span><span class="n">ii</span> <span class="o">-</span> <span class="mi">1</span><span class="p">])))</span>
                    
    <span class="k">if</span> <span class="ow">not</span> <span class="n">title</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">make_space_above</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="n">title</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">17</span><span class="p">,</span><span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;normal&#39;</span><span class="p">)</span>
        
    <span class="c1"># adjust figure margins</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">block</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">save</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">ext</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path_to_dir</span><span class="p">,</span><span class="s2">&quot;Correlation.pdf&quot;</span><span class="p">),</span><span class="n">dpi</span><span class="o">=</span><span class="mi">600</span><span class="p">)</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path_to_dir</span><span class="p">,</span><span class="s2">&quot;Correlation.png&quot;</span><span class="p">),</span><span class="n">dpi</span><span class="o">=</span><span class="mi">600</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path_to_dir</span><span class="p">,</span><span class="s2">&quot;Correlation.&quot;</span><span class="o">+</span><span class="n">ext</span><span class="p">),</span><span class="n">dpi</span><span class="o">=</span><span class="mi">600</span><span class="p">)</span></div>

    

<div class="viewcode-block" id="plotTestedSeries">
<a class="viewcode-back" href="../../../../source/snowdrop.src.graphs.html#snowdrop.src.graphs.util.plotTestedSeries">[docs]</a>
<span class="k">def</span> <span class="nf">plotTestedSeries</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span><span class="n">dx1</span><span class="p">,</span><span class="n">x2</span><span class="p">,</span><span class="n">dx2</span><span class="p">,</span><span class="n">n1</span><span class="p">,</span><span class="n">n2</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Check endogenous variables cross-correlation and Granger cointegration.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        x1 : numpy array</span>
<span class="sd">            Values of the first endogenous variables.</span>
<span class="sd">        dx1 : numpy array</span>
<span class="sd">            Values of the increments of the first endogenous variables.</span>
<span class="sd">        x2 : numpy array</span>
<span class="sd">            Values of the second endogenous variables.</span>
<span class="sd">        dx12 : numpy array</span>
<span class="sd">            Values of the increments of the second endogenous variables.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">dx1</span><span class="p">,</span><span class="n">dx2</span><span class="p">,</span><span class="n">linewidths</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">dx1</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">dx1</span><span class="p">)],[</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">dx2</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">dx2</span><span class="p">)],</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Difference&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Difference&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span><span class="n">x2</span><span class="p">,</span><span class="n">linewidths</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">x1</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">x1</span><span class="p">)],[</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">x2</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">x2</span><span class="p">)],</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Level&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Level&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x1</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">n1</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Level&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Period&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x2</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">n2</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Level&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Period&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="n">n1</span> <span class="o">+</span> <span class="s2">&quot;  -  &quot;</span> <span class="o">+</span> <span class="n">n2</span><span class="p">,</span><span class="n">fontsize</span> <span class="o">=</span> <span class="s1">&#39;x-large&#39;</span><span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">set_tight_layout</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span></div>



<div class="viewcode-block" id="plotSurface">
<a class="viewcode-back" href="../../../../source/snowdrop.src.graphs.html#snowdrop.src.graphs.util.plotSurface">[docs]</a>
<span class="k">def</span> <span class="nf">plotSurface</span><span class="p">(</span><span class="n">path_to_dir</span><span class="p">,</span><span class="n">data</span><span class="p">,</span><span class="n">Time</span><span class="p">,</span><span class="n">variable_names</span><span class="p">,</span><span class="n">output_variables</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">prefix</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">Npaths</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">show</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">save</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">ext</span><span class="o">=</span><span class="s2">&quot;png&quot;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Plot 2-D graphs of macro variables.</span>
<span class="sd">    </span>
<span class="sd">    Parameters:</span>
<span class="sd">        :param path_to_dir: Path to the folder where figures are saved.</span>
<span class="sd">        :type path_to_dir: str.</span>
<span class="sd">        :param data: Data array.</span>
<span class="sd">        :type data: array.</span>
<span class="sd">        :param Time: List of dates.</span>
<span class="sd">        :type Time: list.</span>
<span class="sd">        :param variable_names: Variables names.</span>
<span class="sd">        :type variable_names: list.</span>
<span class="sd">        :param output_variables: Output variable names.</span>
<span class="sd">        :type output_variables: list.</span>
<span class="sd">        :param prefix: Prefix of variables.  If set displays variable which name start with this prefix.</span>
<span class="sd">        :type prefix: str.</span>
<span class="sd">        :param Npaths: Number of paths.</span>
<span class="sd">        :type Npaths: int.</span>
<span class="sd">        :param show: Boolean variable.  If set to True shows graphs.</span>
<span class="sd">        :type show: bool.</span>
<span class="sd">        :param save: Boolean variable.  If set to True saves graphs.</span>
<span class="sd">        :type save: bool.</span>
<span class="sd">        :param ext: Format of the saved file.</span>
<span class="sd">        :type ext: str.</span>
<span class="sd">        :returns: List of figures.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span> <span class="nn">snowdrop.src.utils.util</span> <span class="kn">import</span> <span class="n">deleteFiles</span>
    <span class="kn">from</span> <span class="nn">snowdrop.src.utils.util</span> <span class="kn">import</span> <span class="n">getMap</span>
    <span class="kn">from</span> <span class="nn">textwrap</span> <span class="kn">import</span> <span class="n">wrap</span>
    
    <span class="n">dim1</span><span class="p">,</span><span class="n">dim2</span><span class="p">,</span><span class="n">dim3</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>
    <span class="k">if</span> <span class="n">dim1</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span>
    
    <span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="n">STYLE</span><span class="p">)</span>
    
    <span class="n">years</span> <span class="o">=</span> <span class="n">dates</span><span class="o">.</span><span class="n">YearLocator</span><span class="p">()</span>   <span class="c1"># every year</span>
    <span class="n">yearsFmt</span> <span class="o">=</span> <span class="n">dates</span><span class="o">.</span><span class="n">DateFormatter</span><span class="p">(</span><span class="s1">&#39;%Y&#39;</span><span class="p">)</span>
    <span class="n">T</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">Time</span><span class="p">)</span>
        
    <span class="n">plot_vars</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">variable_names</span> <span class="k">if</span>  <span class="s2">&quot;_minus_&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">x</span> <span class="ow">and</span> <span class="s2">&quot;_plus_&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">x</span><span class="p">]</span>
 
     <span class="c1"># Surface Plot</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">Npaths</span><span class="p">):</span>
        <span class="n">yIter</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>
        <span class="n">dim1t</span><span class="p">,</span><span class="n">dim2t</span><span class="p">,</span><span class="n">dim3t</span> <span class="o">=</span> <span class="n">yIter</span><span class="o">.</span><span class="n">shape</span>
        <span class="n">dim1</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">dim1</span><span class="p">,</span><span class="n">dim1t</span><span class="p">)</span>
        <span class="n">dim2</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">dim2</span><span class="p">,</span><span class="n">dim2t</span><span class="p">)</span>
        <span class="n">dim3</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">dim3</span><span class="p">,</span><span class="n">dim3t</span><span class="p">)</span>
    <span class="n">yIter</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">dim1</span><span class="p">,</span><span class="n">dim2</span><span class="p">,</span><span class="n">dim3</span><span class="p">))</span>    
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">Npaths</span><span class="p">):</span>
        <span class="n">temp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">j</span><span class="p">])</span><span class="o">/</span><span class="n">Npaths</span>
        <span class="n">yIter</span> <span class="o">=</span> <span class="n">yIter</span> <span class="o">+</span> <span class="n">temp</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">dim1</span><span class="p">,</span><span class="mi">0</span><span class="p">:</span><span class="n">dim2</span><span class="p">,</span><span class="mi">0</span><span class="p">:</span><span class="n">dim3</span><span class="p">]</span>
    
    <span class="n">Iterations</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="o">+</span><span class="n">dim1</span><span class="p">)</span>
    <span class="n">Xg</span><span class="p">,</span><span class="n">Yg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">Time</span><span class="p">,</span><span class="n">Iterations</span><span class="p">)</span>  
    
    <span class="n">k</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">m</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">figs</span> <span class="o">=</span> <span class="p">[]</span>
    
    <span class="c1"># Delete files</span>
    <span class="n">deleteFiles</span><span class="p">(</span><span class="n">path_to_dir</span><span class="p">,</span> <span class="s2">&quot;Convergence&quot;</span><span class="p">)</span>
    
    <span class="n">file_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">working_dir</span><span class="p">,</span><span class="s2">&quot;supplements/data/dictionary/symbols_labels.csv&quot;</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">file_path</span><span class="p">):</span>
        <span class="n">symbolsMap</span> <span class="o">=</span> <span class="n">getMap</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">symbolsMap</span> <span class="o">=</span> <span class="p">{}</span>
    
    <span class="c1"># Sort plotting variables names in alphabetic order</span>
    <span class="n">indices</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">variable_names</span><span class="p">)),</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">k</span><span class="p">:</span> <span class="n">variable_names</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
       
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">indices</span><span class="p">:</span>
        <span class="n">n</span> <span class="o">=</span> <span class="n">variable_names</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">plot_vars</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">output_variables</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">output_variables</span><span class="p">:</span>
                <span class="k">continue</span>
        <span class="k">if</span> <span class="n">k</span><span class="o">%</span><span class="mi">4</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">m</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
        <span class="n">k</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">m</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">Variables_iter</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">dim1</span><span class="p">,</span><span class="n">T</span><span class="p">))</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">yIter</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">dim1</span><span class="p">,:,</span><span class="n">j</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">dim1</span><span class="p">):</span>
            <span class="n">Variables_iter</span><span class="p">[</span><span class="n">i</span><span class="p">,:]</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">0</span><span class="p">:</span><span class="n">T</span><span class="p">]</span>
    
        <span class="n">min_variables</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">Variables_iter</span><span class="p">)</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">m</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">)</span>
        <span class="n">surf</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot_surface</span><span class="p">(</span><span class="n">Xg</span><span class="p">,</span><span class="n">Yg</span><span class="p">,</span><span class="n">Variables_iter</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="n">cm</span><span class="o">.</span><span class="n">coolwarm</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">antialiased</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">Xg</span><span class="p">,</span><span class="n">Yg</span><span class="p">,</span><span class="n">Variables_iter</span><span class="p">,</span> <span class="n">zdir</span><span class="o">=</span><span class="s1">&#39;z&#39;</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="n">min_variables</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="n">cm</span><span class="o">.</span><span class="n">coolwarm</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">Xg</span><span class="p">,</span><span class="n">Yg</span><span class="p">,</span><span class="n">Variables_iter</span><span class="p">,</span> <span class="n">zdir</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">offset</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="n">cm</span><span class="o">.</span><span class="n">coolwarm</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">Xg</span><span class="p">,</span><span class="n">Yg</span><span class="p">,</span><span class="n">Variables_iter</span><span class="p">,</span> <span class="n">zdir</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">offset</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="n">cm</span><span class="o">.</span><span class="n">coolwarm</span><span class="p">)</span>
        <span class="c1"># format the ticks</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_minor_locator</span><span class="p">(</span><span class="n">years</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_minor_formatter</span><span class="p">(</span><span class="n">yearsFmt</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">symbolsMap</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">wrap</span><span class="p">(</span><span class="n">symbolsMap</span><span class="p">[</span><span class="n">n</span><span class="p">])))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Iteration&#39;</span><span class="p">)</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">surf</span><span class="p">,</span> <span class="n">shrink</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">aspect</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
        
        
        <span class="k">if</span> <span class="n">k</span><span class="o">%</span><span class="mi">4</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
            <span class="n">figs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">save</span><span class="p">:</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path_to_dir</span><span class="p">,</span><span class="s1">&#39;Convergence_&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">ceil</span><span class="p">(</span><span class="n">k</span><span class="o">/</span><span class="mi">4</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39;.&#39;</span> <span class="o">+</span> <span class="n">ext</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">show</span><span class="p">:</span> 
                <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">block</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> 
                <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
            
    <span class="k">if</span> <span class="n">k</span><span class="o">%</span><span class="mi">4</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>    
        <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
        <span class="n">figs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span> 
        <span class="k">if</span> <span class="n">save</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path_to_dir</span><span class="p">,</span><span class="s1">&#39;Convergence_&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">ceil</span><span class="p">((</span><span class="mi">1</span><span class="o">+</span><span class="n">k</span><span class="p">)</span><span class="o">/</span><span class="mi">4</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39;.&#39;</span> <span class="o">+</span> <span class="n">ext</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">show</span><span class="p">:</span> 
            <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">block</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> 
            <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">figs</span></div>

     

<div class="viewcode-block" id="bar_plot">
<a class="viewcode-back" href="../../../../source/snowdrop.src.graphs.html#snowdrop.src.graphs.util.bar_plot">[docs]</a>
<span class="k">def</span> <span class="nf">bar_plot</span><span class="p">(</span><span class="n">path_to_dir</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">var</span><span class="o">=</span><span class="p">[],</span><span class="n">var_names</span><span class="o">=</span><span class="p">[],</span><span class="n">par</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">par_names</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="n">symbols</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">xLabel</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">yLabel</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">plot_variables</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">relative</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">sizes</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">fig_sizes</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">6</span><span class="p">)):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Plot bar graphs.&quot;&quot;&quot;</span>
    
    <span class="kn">from</span> <span class="nn">snowdrop.src.graphs.util</span> <span class="kn">import</span> <span class="n">barPlot</span>
    <span class="k">if</span> <span class="n">path_to_dir</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">path_to_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">working_dir</span><span class="p">,</span><span class="s1">&#39;graphs&#39;</span><span class="p">))</span>
    
    <span class="k">if</span> <span class="n">plot_variables</span><span class="p">:</span>
        <span class="n">title</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">labels</span> <span class="o">=</span> <span class="p">[];</span> <span class="n">data</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">var_names</span><span class="p">:</span>
            <span class="n">arr</span> <span class="o">=</span> <span class="p">[];</span> <span class="n">lbls</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">var</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">k</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">v</span><span class="o">+</span><span class="s2">&quot;_&quot;</span><span class="p">):</span>
                    <span class="n">s</span> <span class="o">=</span> <span class="n">k</span><span class="p">[</span><span class="mi">1</span><span class="o">+</span><span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="p">):]</span>
                    <span class="n">lbls</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">,</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">))</span>
                    <span class="n">arr</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">var</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">lbls</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
                <span class="n">labels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">lbls</span><span class="p">)</span>
                <span class="n">t</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="k">if</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">symbols</span> <span class="k">else</span> <span class="n">v</span>
                <span class="n">title</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
                <span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">barPlot</span><span class="p">(</span><span class="n">path_to_dir</span><span class="p">,</span><span class="n">title</span><span class="p">,</span><span class="n">data</span><span class="p">,</span><span class="n">labels</span><span class="p">,</span><span class="n">xLabel</span><span class="p">,</span><span class="n">yLabel</span><span class="p">,</span><span class="n">sizes</span><span class="o">=</span><span class="n">sizes</span><span class="p">,</span><span class="n">plot_variables</span><span class="o">=</span><span class="n">plot_variables</span><span class="p">,</span><span class="n">fig_sizes</span><span class="o">=</span><span class="n">fig_sizes</span><span class="p">,</span><span class="n">save</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">show</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">ext</span><span class="o">=</span><span class="s1">&#39;png&#39;</span><span class="p">)</span>
     
    <span class="k">else</span><span class="p">:</span>
        <span class="n">vom_parameters</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">par_names</span> <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;vom_&quot;</span><span class="p">)]</span>
        <span class="n">Y</span>   <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">var_names</span> <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;Y_&quot;</span><span class="p">)]</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">vom_parameters</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">Y</span><span class="p">):</span>
            <span class="n">welfare</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">vom_parameters</span><span class="p">:</span>
                <span class="n">s</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="mi">4</span><span class="p">:]</span>
                <span class="k">if</span> <span class="s2">&quot;Y_&quot;</span><span class="o">+</span><span class="n">s</span> <span class="ow">in</span> <span class="n">Y</span><span class="p">:</span>
                    <span class="n">welfare</span><span class="p">[</span><span class="n">s</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">,</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)]</span> <span class="o">=</span> <span class="n">par</span><span class="p">[</span><span class="n">p</span><span class="p">]</span> <span class="o">*</span> <span class="n">var</span><span class="p">[</span><span class="s2">&quot;Y_&quot;</span><span class="o">+</span><span class="n">s</span><span class="p">]</span>
                    
            <span class="k">if</span> <span class="nb">bool</span><span class="p">(</span><span class="n">welfare</span><span class="p">):</span>
                <span class="n">labels</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">welfare</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
                <span class="k">if</span> <span class="n">relative</span><span class="p">:</span>
                    <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">100</span><span class="o">*</span><span class="p">(</span><span class="n">welfare</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="n">welfare</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">labels</span><span class="p">])</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">welfare</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">labels</span><span class="p">])</span>
                <span class="n">barPlot</span><span class="p">(</span><span class="n">path_to_dir</span><span class="p">,</span><span class="n">title</span><span class="p">,</span><span class="n">data</span><span class="p">,</span><span class="n">labels</span><span class="p">,</span><span class="n">xLabel</span><span class="p">,</span><span class="n">yLabel</span><span class="p">,</span><span class="n">sizes</span><span class="o">=</span><span class="n">sizes</span><span class="p">,</span><span class="n">fig_sizes</span><span class="o">=</span><span class="n">fig_sizes</span><span class="p">,</span><span class="n">save</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">show</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">ext</span><span class="o">=</span><span class="s1">&#39;png&#39;</span><span class="p">)</span></div>

     
        
<div class="viewcode-block" id="plot3D">
<a class="viewcode-back" href="../../../../source/snowdrop.src.graphs.html#snowdrop.src.graphs.util.plot3D">[docs]</a>
<span class="k">def</span> <span class="nf">plot3D</span><span class="p">(</span><span class="n">path_to_dir</span><span class="p">,</span><span class="n">data</span><span class="p">,</span><span class="n">variable_names</span><span class="p">,</span><span class="n">show</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">save</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">ext</span><span class="o">=</span><span class="s2">&quot;png&quot;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Plot 3-D graphs of macro variables.</span>
<span class="sd">    </span>
<span class="sd">    This is a toy example of 3D plots.</span>
<span class="sd">    </span>
<span class="sd">    Parameters:</span>
<span class="sd">        :param path_to_dir: Path to the folder where figures are saved.</span>
<span class="sd">        :type path_to_dir: str.</span>
<span class="sd">        :param data: Data array.</span>
<span class="sd">        :type data: array.</span>
<span class="sd">        :param variable_names: Variables names.</span>
<span class="sd">        :type variable_names: list.</span>
<span class="sd">        :param show: Boolean variable.  If set to True shows graphs.</span>
<span class="sd">        :type show: bool.</span>
<span class="sd">        :param save: Boolean variable.  If set to True saves graphs.</span>
<span class="sd">        :type save: bool.</span>
<span class="sd">        :param ext: Format of the saved file.</span>
<span class="sd">        :type ext: str.</span>
<span class="sd">        :returns: List of figures.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">colors</span> <span class="o">=</span> <span class="n">getColors</span><span class="p">()</span>
    <span class="n">nd</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">ndim</span>
    <span class="k">if</span> <span class="n">nd</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
        <span class="n">ndim1</span><span class="p">,</span><span class="n">ndim2</span><span class="p">,</span><span class="n">ndim3</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span>
        <span class="k">if</span> <span class="n">ndim3</span> <span class="o">&gt;=</span> <span class="mi">4</span><span class="p">:</span>
            <span class="n">X</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">,:,</span><span class="mi">0</span><span class="p">]</span>
            <span class="c1">#Y = data[0,:,1]</span>
            <span class="n">Z</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">,:,</span><span class="mi">3</span><span class="p">]</span>
            <span class="n">Radius</span> <span class="o">=</span> <span class="n">Z</span>
            <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
            <span class="n">Time</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
            
            <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
            <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">axes</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">)</span>
            <span class="n">k</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">ceil</span><span class="p">(</span><span class="n">n</span><span class="o">/</span><span class="mi">5</span><span class="p">)):</span>
                <span class="n">k</span> <span class="o">+=</span> <span class="mi">1</span> 
                <span class="n">c</span> <span class="o">=</span> <span class="n">k</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">colors</span><span class="p">)</span>
                <span class="n">color</span> <span class="o">=</span> <span class="n">colors</span><span class="p">[</span><span class="n">c</span><span class="p">]</span>
                <span class="n">r</span> <span class="o">=</span> <span class="n">Radius</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="c1"># Draw a sphere</span>
                <span class="n">u</span><span class="p">,</span> <span class="n">v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mgrid</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">:</span><span class="mi">20</span><span class="n">j</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">:</span><span class="mi">10</span><span class="n">j</span><span class="p">]</span>
                <span class="n">x</span> <span class="o">=</span> <span class="n">Time</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">r</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">u</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
                <span class="n">y</span> <span class="o">=</span> <span class="n">r</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">u</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
                <span class="n">z</span> <span class="o">=</span> <span class="n">r</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">plot_wireframe</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
            
            
            <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">variable_names</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time&#39;</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">variable_names</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_zlabel</span><span class="p">(</span><span class="n">variable_names</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
            <span class="k">if</span> <span class="n">save</span><span class="p">:</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path_to_dir</span><span class="p">,</span><span class="s1">&#39;3D.&#39;</span><span class="o">+</span><span class="n">ext</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">show</span><span class="p">:</span> 
                <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">block</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span></div>

            
            
<div class="viewcode-block" id="plotImage">
<a class="viewcode-back" href="../../../../source/snowdrop.src.graphs.html#snowdrop.src.graphs.util.plotImage">[docs]</a>
<span class="k">def</span> <span class="nf">plotImage</span><span class="p">(</span><span class="n">path_to_dir</span><span class="p">,</span><span class="n">fname</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Plot image file.</span>
<span class="sd">    </span>
<span class="sd">    Parameters:</span>
<span class="sd">        :param path_to_dir: Path to the folder where figures are saved.</span>
<span class="sd">        :type path_to_dir: str.</span>
<span class="sd">        :param fname: Image file name.</span>
<span class="sd">        :type fname: str.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span> <span class="nn">PIL</span> <span class="kn">import</span> <span class="n">Image</span>  

    <span class="n">fpath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path_to_dir</span><span class="p">,</span><span class="n">fname</span><span class="p">))</span>
    <span class="n">img</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">fpath</span><span class="p">)</span>  
    <span class="n">img</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></div>

    
    
<div class="viewcode-block" id="make_space_above">
<a class="viewcode-back" href="../../../../source/snowdrop.src.graphs.html#snowdrop.src.graphs.util.make_space_above">[docs]</a>
<span class="k">def</span> <span class="nf">make_space_above</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span><span class="n">topmargin</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Increase figure size to make top margin (in inches) space for titles, without changing the axes sizes.&quot;&quot;&quot;</span>
    
    <span class="n">s</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">subplotpars</span>
    <span class="n">w</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">get_size_inches</span><span class="p">()</span>

    <span class="n">figh</span> <span class="o">=</span> <span class="n">h</span> <span class="o">-</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">s</span><span class="o">.</span><span class="n">top</span><span class="p">)</span><span class="o">*</span><span class="n">h</span>  <span class="o">+</span> <span class="n">topmargin</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">bottom</span><span class="o">=</span><span class="n">s</span><span class="o">.</span><span class="n">bottom</span><span class="o">*</span><span class="n">h</span><span class="o">/</span><span class="n">figh</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="mi">1</span><span class="o">-</span><span class="n">topmargin</span><span class="o">/</span><span class="n">figh</span><span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">set_figheight</span><span class="p">(</span><span class="n">figh</span><span class="p">)</span></div>

    
    
<div class="viewcode-block" id="rgb">
<a class="viewcode-back" href="../../../../source/snowdrop.src.graphs.html#snowdrop.src.graphs.util.rgb">[docs]</a>
<span class="k">def</span> <span class="nf">rgb</span><span class="p">(</span><span class="n">col</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Set up RGB Colours.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">col</span>   <span class="o">==</span> <span class="s1">&#39;Turque&#39;</span><span class="p">:</span>   <span class="n">R</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>   <span class="n">G</span> <span class="o">=</span> <span class="mi">165</span><span class="p">;</span> <span class="n">B</span> <span class="o">=</span> <span class="mi">185</span>
    <span class="k">elif</span> <span class="n">col</span> <span class="o">==</span> <span class="s1">&#39;Blue&#39;</span><span class="p">:</span>     <span class="n">R</span> <span class="o">=</span> <span class="mi">55</span><span class="p">;</span>  <span class="n">G</span> <span class="o">=</span> <span class="mi">70</span><span class="p">;</span>  <span class="n">B</span> <span class="o">=</span> <span class="mi">150</span>
    <span class="k">elif</span> <span class="n">col</span> <span class="o">==</span> <span class="s1">&#39;DarkBlue&#39;</span><span class="p">:</span> <span class="n">R</span> <span class="o">=</span> <span class="mi">64</span><span class="p">;</span>  <span class="n">G</span> <span class="o">=</span> <span class="mi">86</span><span class="p">;</span>  <span class="n">B</span> <span class="o">=</span> <span class="mi">106</span>
    <span class="k">elif</span> <span class="n">col</span> <span class="o">==</span> <span class="s1">&#39;Pink&#39;</span><span class="p">:</span>     <span class="n">R</span> <span class="o">=</span> <span class="mi">230</span><span class="p">;</span> <span class="n">G</span> <span class="o">=</span> <span class="mi">30</span><span class="p">;</span>  <span class="n">B</span> <span class="o">=</span> <span class="mi">105</span>
    <span class="k">elif</span> <span class="n">col</span> <span class="o">==</span> <span class="s1">&#39;Black&#39;</span><span class="p">:</span>    <span class="n">R</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>   <span class="n">G</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>   <span class="n">B</span> <span class="o">=</span> <span class="mi">0</span>   
    <span class="k">elif</span> <span class="n">col</span> <span class="o">==</span> <span class="s1">&#39;Red&#39;</span><span class="p">:</span>      <span class="n">R</span> <span class="o">=</span> <span class="mi">255</span><span class="p">;</span> <span class="n">G</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>   <span class="n">B</span> <span class="o">=</span> <span class="mi">0</span>  
    <span class="k">elif</span> <span class="n">col</span> <span class="o">==</span> <span class="s1">&#39;Orange&#39;</span><span class="p">:</span>   <span class="n">R</span> <span class="o">=</span> <span class="mi">245</span><span class="p">;</span> <span class="n">G</span> <span class="o">=</span> <span class="mi">150</span><span class="p">;</span> <span class="n">B</span> <span class="o">=</span> <span class="mi">20</span>
    <span class="k">elif</span> <span class="n">col</span> <span class="o">==</span> <span class="s1">&#39;Yellow&#39;</span><span class="p">:</span>   <span class="n">R</span> <span class="o">=</span> <span class="mi">255</span><span class="p">;</span> <span class="n">G</span> <span class="o">=</span> <span class="mi">220</span><span class="p">;</span> <span class="n">B</span> <span class="o">=</span> <span class="mi">50</span> 
    <span class="k">elif</span> <span class="n">col</span> <span class="o">==</span> <span class="s1">&#39;Purple&#39;</span><span class="p">:</span>   <span class="n">R</span> <span class="o">=</span> <span class="mi">130</span><span class="p">;</span> <span class="n">G</span> <span class="o">=</span> <span class="mi">55</span><span class="p">;</span>  <span class="n">B</span> <span class="o">=</span> <span class="mi">140</span>
    <span class="k">elif</span> <span class="n">col</span> <span class="o">==</span> <span class="s1">&#39;Green&#39;</span><span class="p">:</span>    <span class="n">R</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>   <span class="n">G</span> <span class="o">=</span> <span class="mi">255</span><span class="p">;</span> <span class="n">B</span> <span class="o">=</span> <span class="mi">219</span>
    <span class="k">elif</span> <span class="n">col</span> <span class="o">==</span> <span class="s1">&#39;Brown&#39;</span><span class="p">:</span>    <span class="n">R</span> <span class="o">=</span> <span class="mi">146</span><span class="p">;</span> <span class="n">G</span> <span class="o">=</span> <span class="mi">146</span><span class="p">;</span> <span class="n">B</span> <span class="o">=</span> <span class="mi">146</span>
    <span class="k">elif</span> <span class="n">col</span> <span class="o">==</span> <span class="s1">&#39;Grey&#39;</span><span class="p">:</span>     <span class="n">R</span> <span class="o">=</span> <span class="mi">128</span><span class="p">;</span> <span class="n">G</span> <span class="o">=</span> <span class="mi">128</span><span class="p">;</span> <span class="n">B</span> <span class="o">=</span> <span class="mi">128</span>
    <span class="k">elif</span> <span class="n">col</span> <span class="o">==</span> <span class="s1">&#39;White&#39;</span><span class="p">:</span>    <span class="n">R</span> <span class="o">=</span> <span class="mi">255</span><span class="p">;</span> <span class="n">G</span> <span class="o">=</span> <span class="mi">255</span><span class="p">;</span> <span class="n">B</span> <span class="o">=</span> <span class="mi">255</span>
    
    <span class="k">return</span> <span class="p">(</span><span class="n">R</span><span class="o">/</span><span class="mf">255.</span><span class="p">,</span><span class="n">G</span><span class="o">/</span><span class="mf">255.</span><span class="p">,</span><span class="n">B</span><span class="o">/</span><span class="mf">255.</span><span class="p">)</span></div>



<div class="viewcode-block" id="getColors">
<a class="viewcode-back" href="../../../../source/snowdrop.src.graphs.html#snowdrop.src.graphs.util.getColors">[docs]</a>
<span class="k">def</span> <span class="nf">getColors</span><span class="p">(</span><span class="n">variables</span><span class="o">=</span><span class="p">[]):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Define RGB colors.&quot;&quot;&quot;</span>
    <span class="n">DarkBlue</span>  <span class="o">=</span> <span class="n">rgb</span><span class="p">(</span><span class="s1">&#39;DarkBlue&#39;</span><span class="p">)</span>
    <span class="n">Blue</span>      <span class="o">=</span> <span class="n">rgb</span><span class="p">(</span><span class="s1">&#39;Blue&#39;</span><span class="p">)</span>
    <span class="n">Green</span>     <span class="o">=</span> <span class="n">rgb</span><span class="p">(</span><span class="s1">&#39;Green&#39;</span><span class="p">)</span>
    <span class="n">Brown</span>     <span class="o">=</span> <span class="n">rgb</span><span class="p">(</span><span class="s1">&#39;Brown&#39;</span><span class="p">)</span>
    <span class="n">Yellow</span>    <span class="o">=</span> <span class="n">rgb</span><span class="p">(</span><span class="s1">&#39;Yellow&#39;</span><span class="p">),</span>
    <span class="n">Turque</span>    <span class="o">=</span> <span class="n">rgb</span><span class="p">(</span><span class="s1">&#39;Orange&#39;</span><span class="p">)</span>
    <span class="n">Pink</span>      <span class="o">=</span> <span class="n">rgb</span><span class="p">(</span><span class="s1">&#39;Pink&#39;</span><span class="p">)</span>
    <span class="n">Orange</span>    <span class="o">=</span> <span class="n">rgb</span><span class="p">(</span><span class="s1">&#39;Orange&#39;</span><span class="p">)</span>
    <span class="n">Red</span>       <span class="o">=</span> <span class="n">rgb</span><span class="p">(</span><span class="s1">&#39;Red&#39;</span><span class="p">)</span>
    <span class="n">Grey</span>      <span class="o">=</span> <span class="n">rgb</span><span class="p">(</span><span class="s1">&#39;Grey&#39;</span><span class="p">)</span>
    <span class="n">Turque</span>    <span class="o">=</span> <span class="n">rgb</span><span class="p">(</span><span class="s1">&#39;Turque&#39;</span><span class="p">)</span>
    <span class="n">Purple</span>    <span class="o">=</span> <span class="n">rgb</span><span class="p">(</span><span class="s1">&#39;Purple&#39;</span><span class="p">)</span>
    <span class="n">White</span>     <span class="o">=</span> <span class="n">rgb</span><span class="p">(</span><span class="s1">&#39;White&#39;</span><span class="p">)</span>
    <span class="n">Black</span>     <span class="o">=</span> <span class="n">rgb</span><span class="p">(</span><span class="s1">&#39;Black&#39;</span><span class="p">)</span>
    
    <span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="n">Blue</span><span class="p">,</span><span class="n">Yellow</span><span class="p">,</span><span class="n">Orange</span><span class="p">,</span><span class="n">Green</span><span class="p">,</span><span class="n">Brown</span><span class="p">,</span><span class="n">Pink</span><span class="p">,</span><span class="n">Turque</span><span class="p">,</span><span class="n">Purple</span><span class="p">,</span><span class="n">Red</span><span class="p">,</span><span class="n">DarkBlue</span><span class="p">,</span><span class="n">Grey</span><span class="p">,</span><span class="n">White</span><span class="p">,</span><span class="n">Black</span><span class="p">]</span>
    <span class="n">n</span>  <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">colors</span><span class="p">)</span>
    <span class="n">mp</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
    
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">variables</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>    
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">variables</span><span class="p">):</span>
            <span class="n">ii</span> <span class="o">=</span> <span class="n">i</span><span class="o">%</span><span class="n">n</span>
            <span class="n">mp</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="n">colors</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">colors</span><span class="p">,</span><span class="n">mp</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">colors</span></div>

</pre></div>

          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../../../../index.html">Python Platform</a></h1>








<h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../source/modules.html">snowdrop</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../info.html">Python Platform</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../../../index.html">Documentation overview</a><ul>
  <li><a href="../../../index.html">Module code</a><ul>
  </ul></li>
  </ul></li>
</ul>
</div>
<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;2024, Alexei Goumilevski.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 7.3.7</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 0.7.16</a>
      
    </div>

    

    
  </body>
</html>