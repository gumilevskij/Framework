<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>snowdrop.src.numeric.filters package &#8212; Python Platform 1.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=61cd365c" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css?v=12dfc556" />
    <script src="../_static/documentation_options.js?v=f2a433a1"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="snowdrop.src.numeric.grids package" href="snowdrop.src.numeric.grids.html" />
    <link rel="prev" title="snowdrop.src.numeric.estimation package" href="snowdrop.src.numeric.estimation.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="snowdrop-src-numeric-filters-package">
<h1>snowdrop.src.numeric.filters package<a class="headerlink" href="#snowdrop-src-numeric-filters-package" title="Link to this heading">¶</a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Link to this heading">¶</a></h2>
</section>
<section id="module-snowdrop.src.numeric.filters.diffuse">
<span id="snowdrop-src-numeric-filters-diffuse-module"></span><h2>snowdrop.src.numeric.filters.diffuse module<a class="headerlink" href="#module-snowdrop.src.numeric.filters.diffuse" title="Link to this heading">¶</a></h2>
<p>Durbin-Koopman filter for non-stationary processes with missing and non-missing observations.</p>
<blockquote>
<div><p>It is a modification of Standard Kalman filter which accounts for growth of a covariance matrix P as time progresses.
The initial values of P matrix is assumed diffusive.
During the first d diffusive periods matrix P is decomposed into Pstar and Pinf
and separate equations for these matrices are used.
After number d of diffusive periods standard Kalman filter is applied.</p>
<p>Translated from Dynare Matlab code to Python by A.Goumilevski.</p>
</div></blockquote>
<dl class="py function">
<dt class="sig sig-object py" id="snowdrop.src.numeric.filters.diffuse.diffuse_filter">
<span class="sig-prename descclassname"><span class="pre">snowdrop.src.numeric.filters.diffuse.</span></span><span class="sig-name descname"><span class="pre">diffuse_filter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">T</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Z</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">R</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Q</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">H</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">C</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Ts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Nd</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_shocks</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_index</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Pinf1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Pstar1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">decomp_flag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state_uncertainty_flag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/snowdrop/src/numeric/filters/diffuse.html#diffuse_filter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#snowdrop.src.numeric.filters.diffuse.diffuse_filter" title="Link to this definition">¶</a></dt>
<dd><p>Diffuse Kalman filter and smoother.</p>
<dl class="simple">
<dt>References:</dt><dd><ul class="simple">
<li><p>S.J. Koopman and J. Durbin (2003, “Filtering and Smoothing of State Vector for Diffuse State Space Models”,  Journal of Time Series Analysis, vol. 24(1), pp. 85-98).</p></li>
<li><p>Durbin/Koopman (2012): “Time Series Analysis by State Space Methods”, Oxford University Press, Second Edition, Ch. 5</p></li>
</ul>
</dd>
<dt>Args:</dt><dd><dl class="simple">
<dt>T:        mm*mm matrix    </dt><dd><p>is the state transition matrix</p>
</dd>
<dt>Z:        pp*mm matrix    </dt><dd><p>is the selector matrix for observables in augmented state vector</p>
</dd>
<dt>R:        mm*rr matrix    </dt><dd><p>is the second matrix of the state equation relating the structural innovations to the state variables</p>
</dd>
<dt>Q:        rr*rr matrix    </dt><dd><p>is the covariance matrix of structural errors</p>
</dd>
<dt>H:        pp*pp           </dt><dd><p>is the matrix of variance of measurement errors</p>
</dd>
<dt>Y:        Ts*pp array           </dt><dd><p>is the vector of observations</p>
</dd>
<dt>C:        mm array         </dt><dd><p>is the vector of constants</p>
</dd>
<dt>a0:       mm array            </dt><dd><p>is the vector of initial values of endogenous variables</p>
</dd>
<dt>pp:       int                </dt><dd><p>is the number of observed variables</p>
</dd>
<dt>mm:       int                 </dt><dd><p>is the number of state variables</p>
</dd>
<dt>Ts:       int                </dt><dd><p>is the sample size</p>
</dd>
<dt>Nd:       int                </dt><dd><p>is the shocks maximum lead number minus minimum lag number</p>
</dd>
<dt>n_shocks: int               </dt><dd><p>is the number of shocks</p>
</dd>
<dt>data_index: 1*Tsarray        </dt><dd><p>cell of column vectors of indices</p>
</dd>
<dt>nk:       int            </dt><dd><p>is the number of forecasting periods</p>
</dd>
<dt>Pinf1:    mm*mm  2D array         </dt><dd><p>is the diagonal matrix with with q ones and m-q zeros</p>
</dd>
<dt>Pstar1:   mm*mm 2D array        </dt><dd><p>is the variance-covariance matrix with stationary variables</p>
</dd>
<dt>kalman_tol:  number, float             </dt><dd><p>is the tolerance for reciprocal condition number</p>
</dd>
<dt>diffuse_kalman_tol: number, float     </dt><dd><p>is the tolerance for reciprocal condition number (for Finf) and the rank of Pinf</p>
</dd>
<dt>decomp_flag:  bool</dt><dd><p>if True, compute filter decomposition</p>
</dd>
<dt>state_uncertainty_flag: bool  </dt><dd><p>if True, compute uncertainty about smoothed state estimate</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><dl class="simple">
<dt>alphahat: </dt><dd><p>smoothed variables (a_{t|T})</p>
</dd>
<dt>epsilonhat:</dt><dd><p>smoothed measurement errors</p>
</dd>
<dt>etahat:   </dt><dd><p>smoothed shocks</p>
</dd>
<dt>atilde:   </dt><dd><p>matrix of updated variables (a_{t|t})</p>
</dd>
<dt>aK:       </dt><dd><p>3D array of k step ahead filtered state variables (a_{t+k|t) (meaningless for periods 1:d)</p>
</dd>
<dt>P:        </dt><dd><p>3D array of one-step ahead forecast error variance matrices</p>
</dd>
<dt>PK:       </dt><dd><p>4D array of k-step ahead forecast error variance matrices (meaningless for periods 1:d)</p>
</dd>
<dt>decomp:   </dt><dd><p>decomposition of the effect of shocks on filtered values</p>
</dd>
<dt>V:        </dt><dd><p>3D array of state uncertainty matrices</p>
</dd>
<dt>N:        </dt><dd><p>3D array of state uncertainty matrices</p>
</dd>
<dt>dLIK:</dt><dd><p>1D array of likelihood</p>
</dd>
<dt>log_likelihood:</dt><dd><p>1D array of cumulative likelihood</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="snowdrop.src.numeric.filters.diffuse.missing_obs_diffuse_multivariate_filter">
<span class="sig-prename descclassname"><span class="pre">snowdrop.src.numeric.filters.diffuse.</span></span><span class="sig-name descname"><span class="pre">missing_obs_diffuse_multivariate_filter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">T</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Z</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">R</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Q</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">H</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">C</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Ts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Nd</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_shocks</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nk</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Pinf1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Pstar1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kalman_tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diffuse_kalman_tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-06</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">decomp_flag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state_uncertainty_flag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/snowdrop/src/numeric/filters/diffuse.html#missing_obs_diffuse_multivariate_filter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#snowdrop.src.numeric.filters.diffuse.missing_obs_diffuse_multivariate_filter" title="Link to this definition">¶</a></dt>
<dd><p>Compute diffuse Kalman smoother without measurement error, in case of a non-singular variance-covariance matrix of observation errors.</p>
<p>Multivariate treatment of time series.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Translated from Dynare Matlab code.</p>
</div>
<dl class="simple">
<dt>References:</dt><dd><p>See “Filtering and Smoothing of State Vector for Diffuse State Space
Models”, S.J. Koopman and J. Durbin (2003, in Journal of Time Series
Analysis, vol. 24(1), pp. 85-98).
Durbin/Koopman (2012): “Time Series Analysis by State Space Methods”, Oxford University Press,
Second Edition, Ch. 5</p>
</dd>
<dt>Args:</dt><dd><dl class="simple">
<dt>T:        mm*mm matrix    </dt><dd><p>is the state transition matrix</p>
</dd>
<dt>Z:        pp*mm matrix        </dt><dd><p>is the selector matrix for observables in augmented state vector</p>
</dd>
<dt>R:        mm*rr matrix        </dt><dd><p>is the second matrix of the state equation relating the structural innovations to the state variables</p>
</dd>
<dt>Q:        rr*rr matrix        </dt><dd><p>is the covariance matrix of structural errors</p>
</dd>
<dt>H:        pp*pp               </dt><dd><p>is the matrix of variance of measurement errors</p>
</dd>
<dt>Y:        Ts*pp               </dt><dd><p>is the vector of observations</p>
</dd>
<dt>C:        mm                  </dt><dd><p>is the vector of constants</p>
</dd>
<dt>a0:       mm                  </dt><dd><p>is the vector of initial values of endogenous variables</p>
</dd>
<dt>pp:       int                 </dt><dd><p>is the number of observed variables</p>
</dd>
<dt>mm:       int                     </dt><dd><p>is the number of state variables</p>
</dd>
<dt>Ts:       int                    </dt><dd><p>is the sample size</p>
</dd>
<dt>Nd:       int                    </dt><dd><p>is the shocks maximum lead number minus minimum lag number</p>
</dd>
<dt>n_shocks: int                    </dt><dd><p>is the number of shocks</p>
</dd>
<dt>data_index: 1*Ts              </dt><dd><p>is the cell of column vectors of indices</p>
</dd>
<dt>nk:       int                    </dt><dd><p>is the number of forecasting periods</p>
</dd>
<dt>Pinf1:    mm*mm               </dt><dd><p>is the diagonal matrix with with q ones and m-q zeros</p>
</dd>
<dt>Pstar1:   mm*mm               </dt><dd><p>is the variance-covariance matrix with stationary variables</p>
</dd>
<dt>kalman_tol:                   </dt><dd><p>is the tolerance for reciprocal condition number</p>
</dd>
<dt>diffuse_kalman_tol:           </dt><dd><p>is the tolerance for reciprocal condition number (for Finf) and the rank of Pinf</p>
</dd>
<dt>decomp_flag:      </dt><dd><p>if true,  compute filter decomposition</p>
</dd>
<dt>state_uncertainty_flag:   </dt><dd><p>if True, compute uncertainty about smoothed state estimate</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><dl class="simple">
<dt>alphahat:     </dt><dd><p>is the smoothed variables (a_{t|T})</p>
</dd>
<dt>epsilonhat:    </dt><dd><p>is the smoothed measurement errors</p>
</dd>
<dt>etahat:       </dt><dd><p>is the smoothed shocks</p>
</dd>
<dt>atilde:       </dt><dd><p>is the matrix of updated variables (a_{t|t})</p>
</dd>
<dt>aK:           </dt><dd><p>is the 3D array of k step ahead filtered state variables (a_{t+k|t)
(meaningless for periods 1:d)</p>
</dd>
<dt>P:            </dt><dd><p>is the 3D array of one-step ahead forecast error variance
matrices</p>
</dd>
<dt>PK:           </dt><dd><p>is the 4D array of k-step ahead forecast error variance
matrices (meaningless for periods 1:d)</p>
</dd>
<dt>decomp:       </dt><dd><p>is the decomposition of the effect of shocks on filtered values</p>
</dd>
<dt>V:            </dt><dd><p>is the 3D array of state uncertainty matrices</p>
</dd>
<dt>N:        </dt><dd><p>is the 3D array of state uncertainty matrices</p>
</dd>
<dt>dLIK:</dt><dd><p>is 1D array of likelihood</p>
</dd>
<dt>log_likelihood:</dt><dd><p>is 1D array of cumulative likelihood</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="snowdrop.src.numeric.filters.diffuse.missing_obs_diffuse_univariate_filter">
<span class="sig-prename descclassname"><span class="pre">snowdrop.src.numeric.filters.diffuse.</span></span><span class="sig-name descname"><span class="pre">missing_obs_diffuse_univariate_filter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">T</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Z</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">R</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Q</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">H</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">C</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Ts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Nd</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_shocks</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nk</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Pinf1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Pstar1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kalman_tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diffuse_kalman_tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-06</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">decomp_flag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state_uncertainty_flag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/snowdrop/src/numeric/filters/diffuse.html#missing_obs_diffuse_univariate_filter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#snowdrop.src.numeric.filters.diffuse.missing_obs_diffuse_univariate_filter" title="Link to this definition">¶</a></dt>
<dd><p>Compute diffuse Kalman smoother in case of a singular var-cov matrix.</p>
<p>Univariate treatment of multivariate time series. 
It is applied for singular and non-singular  matrix of observation errors.</p>
<dl class="simple">
<dt>References:</dt><dd><ul class="simple">
<li><p>Durbin, Koopman (2012): “Time Series Analysis by State Space Methods”, Oxford University Press, Second Edition, Ch. 6.4 + 7.2.5</p></li>
<li><p>Koopman, Durbin (2000): “Fast Filtering and Smoothing for Multivariatze State Space Models”, Journal of Time Series Analysis, vol. 21(3), pp. 281-296.</p></li>
<li><p>S.J. Koopman and J. Durbin (2003): “Filtering and Smoothing of State Vector for Diffuse State Space Models”, Journal of Time Series Analysis, vol. 24(1), pp. 85-98.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Translated from Dynare Matlab code.</p>
</div>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>T:        mm*mm matrix         </dt><dd><p>is the state transition matrix</p>
</dd>
<dt>Z:        pp*mm matrix         </dt><dd><p>is the selector matrix for observables in augmented state vector</p>
</dd>
<dt>R:        mm*rr matrix         </dt><dd><p>is the second matrix of the state equation relating the structural innovations to the state variables</p>
</dd>
<dt>Q:        rr*rr matrix         </dt><dd><p>is the covariance matrix of structural errors</p>
</dd>
<dt>H:        pp                   </dt><dd><p>is the matrix of variance of measurement errors</p>
</dd>
<dt>Y:        Ts*pp                </dt><dd><p>is the vector of observations</p>
</dd>
<dt>C:        mm                   </dt><dd><p>is the vector of constants</p>
</dd>
<dt>a0:       mm                   </dt><dd><p>is the vector of initial values of endogenous variables</p>
</dd>
<dt>pp:       int                     </dt><dd><p>is the number of observed variables</p>
</dd>
<dt>mm:       int                     </dt><dd><p>is the number of state variables</p>
</dd>
<dt>Ts:       int                     </dt><dd><p>is the sample size</p>
</dd>
<dt>Nd:       int                     </dt><dd><p>is the shocks maximum lead number minus minimum lag number</p>
</dd>
<dt>n_shocks: int                     </dt><dd><p>is the number of shocks</p>
</dd>
<dt>data_index: array, dtype=float                   </dt><dd><p>is the Ts cell of column vectors of indices</p>
</dd>
<dt>nk:       int                     </dt><dd><p>is the number of forecasting periods</p>
</dd>
<dt>Pinf1:    mm*mm                </dt><dd><p>is the diagonal matrix with with q ones and m-q zeros</p>
</dd>
<dt>Pstar1:   mm*mm                </dt><dd><p>is the variance-covariance matrix with stationary variables</p>
</dd>
<dt>kalman_tol:                    </dt><dd><p>is the tolerance for zero divider</p>
</dd>
<dt>diffuse_kalman_tol:            </dt><dd><p>is the tolerance for zero divider</p>
</dd>
<dt>decomp_flag:  if true,         </dt><dd><p>is the compute filter decomposition</p>
</dd>
<dt>state_uncertainty_flag:    i    </dt><dd><p>is the f True, compute uncertainty about smoothed state estimate</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><dl class="simple">
<dt>alphahat:     </dt><dd><p>is the smoothed state variables (a_{t|T})</p>
</dd>
<dt>epsilonhat:     </dt><dd><p>is the measurement errors</p>
</dd>
<dt>etahat:       </dt><dd><p>is the smoothed shocks</p>
</dd>
<dt>a:            </dt><dd><p>is the matrix of updated variables (a_{t|t})</p>
</dd>
<dt>aK:           </dt><dd><p>is the 3D array of k step ahead filtered state variables a_{t+k|t}
(meaningless for periods 1:d)</p>
</dd>
<dt>P:            </dt><dd><p>is the 3D array of one-step ahead forecast error variance
matrices</p>
</dd>
<dt>PK:           </dt><dd><p>is the 4D array of k-step ahead forecast error variance
matrices (meaningless for periods 1:d)</p>
</dd>
<dt>decomp:       </dt><dd><p>is the decomposition of the effect of shocks on filtered values</p>
</dd>
<dt>V:            </dt><dd><p>is the 3D array of state uncertainty matrices</p>
</dd>
<dt>N:        </dt><dd><p>is the 3D array of state uncertainty matrices</p>
</dd>
<dt>dLIK:</dt><dd><p>is 1D array of likelihood</p>
</dd>
<dt>log_likelihood:</dt><dd><p>id 1D array of cumulative likelihood</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-snowdrop.src.numeric.filters.filter">
<span id="snowdrop-src-numeric-filters-filter-module"></span><h2>snowdrop.src.numeric.filters.filter module<a class="headerlink" href="#module-snowdrop.src.numeric.filters.filter" title="Link to this heading">¶</a></h2>
<p>Created on Mon Feb 26 18:49:21 2018.</p>
<p>&#64;author: agoumilevski</p>
<dl class="py function">
<dt class="sig sig-object py" id="snowdrop.src.numeric.filters.filter.linear_filter">
<span class="sig-prename descclassname"><span class="pre">snowdrop.src.numeric.filters.filter.</span></span><span class="sig-name descname"><span class="pre">linear_filter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">T</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">periods</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Qm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Hm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">obs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">MULT</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">skip</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">missing_obs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ind_non_missing</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/snowdrop/src/numeric/filters/filter.html#linear_filter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#snowdrop.src.numeric.filters.filter.linear_filter" title="Link to this definition">¶</a></dt>
<dd><p>Apply Kalman filter to linear model.</p>
<dl class="simple">
<dt>Parameters:</dt><dd><dl class="field-list simple">
<dt class="field-odd">param model<span class="colon">:</span></dt>
<dd class="field-odd"><p>Model object.</p>
</dd>
<dt class="field-even">type model<span class="colon">:</span></dt>
<dd class="field-even"><p>Model.</p>
</dd>
<dt class="field-odd">param T<span class="colon">:</span></dt>
<dd class="field-odd"><p>Time span.</p>
</dd>
<dt class="field-even">type T<span class="colon">:</span></dt>
<dd class="field-even"><p>int.</p>
</dd>
<dt class="field-odd">param periods<span class="colon">:</span></dt>
<dd class="field-odd"><p>Array of endogenous variables.</p>
</dd>
<dt class="field-even">type periods<span class="colon">:</span></dt>
<dd class="field-even"><p>numpy.array.</p>
</dd>
<dt class="field-odd">param y0<span class="colon">:</span></dt>
<dd class="field-odd"><p>Starting values of endogenous variables.</p>
</dd>
<dt class="field-even">type y0<span class="colon">:</span></dt>
<dd class="field-even"><p>numpy.array</p>
</dd>
<dt class="field-odd">param Qm<span class="colon">:</span></dt>
<dd class="field-odd"><p>Covariance matrix of errors of endogenous variables.</p>
</dd>
<dt class="field-even">type Qm<span class="colon">:</span></dt>
<dd class="field-even"><p>numpy.array.</p>
</dd>
<dt class="field-odd">param Hm<span class="colon">:</span></dt>
<dd class="field-odd"><p>Covariance matrix of errors of measurement variables.</p>
</dd>
<dt class="field-even">type Hm<span class="colon">:</span></dt>
<dd class="field-even"><p>numpy.array.</p>
</dd>
<dt class="field-odd">param obs<span class="colon">:</span></dt>
<dd class="field-odd"><p>Measurements.</p>
</dd>
<dt class="field-even">type obs<span class="colon">:</span></dt>
<dd class="field-even"><p>List.</p>
</dd>
<dt class="field-odd">param MULT<span class="colon">:</span></dt>
<dd class="field-odd"><p>Multiplier of the terminal time range.  If set greater than one than 
the solution will be computed for this extended time range interval.</p>
</dd>
<dt class="field-even">type MULT<span class="colon">:</span></dt>
<dd class="field-even"><p>int.</p>
</dd>
<dt class="field-odd">param missing_obs<span class="colon">:</span></dt>
<dd class="field-odd"><p>Matrix of logical values with True or False value depending on observation missing or not.</p>
</dd>
<dt class="field-even">type missing_obs<span class="colon">:</span></dt>
<dd class="field-even"><p>Matrix of bools.</p>
</dd>
<dt class="field-odd">returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Filtered solution.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="snowdrop.src.numeric.filters.filter.nonlinear_filter">
<span class="sig-prename descclassname"><span class="pre">snowdrop.src.numeric.filters.filter.</span></span><span class="sig-name descname"><span class="pre">nonlinear_filter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">T</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">periods</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Qm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Hm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">obs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">MULT</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">skip</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">missing_obs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ind_non_missing</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/snowdrop/src/numeric/filters/filter.html#nonlinear_filter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#snowdrop.src.numeric.filters.filter.nonlinear_filter" title="Link to this definition">¶</a></dt>
<dd><p>Apply Kalman filter to non-linear model.</p>
<dl class="simple">
<dt>Parameters:</dt><dd><dl class="field-list simple">
<dt class="field-odd">param model<span class="colon">:</span></dt>
<dd class="field-odd"><p>Model object.</p>
</dd>
<dt class="field-even">type model<span class="colon">:</span></dt>
<dd class="field-even"><p>Model.</p>
</dd>
<dt class="field-odd">param T<span class="colon">:</span></dt>
<dd class="field-odd"><p>Time span.</p>
</dd>
<dt class="field-even">type T<span class="colon">:</span></dt>
<dd class="field-even"><p>int.</p>
</dd>
<dt class="field-odd">param periods<span class="colon">:</span></dt>
<dd class="field-odd"><p>Array of endogenous variables.</p>
</dd>
<dt class="field-even">type periods<span class="colon">:</span></dt>
<dd class="field-even"><p>numpy.array.</p>
</dd>
<dt class="field-odd">param y0<span class="colon">:</span></dt>
<dd class="field-odd"><p>Starting values of endogenous variables.</p>
</dd>
<dt class="field-even">type y0<span class="colon">:</span></dt>
<dd class="field-even"><p>numpy.array</p>
</dd>
<dt class="field-odd">param Qm<span class="colon">:</span></dt>
<dd class="field-odd"><p>Covariance matrix of errors of endogenous variables.</p>
</dd>
<dt class="field-even">type Qm<span class="colon">:</span></dt>
<dd class="field-even"><p>numpy.array.</p>
</dd>
<dt class="field-odd">param Hm<span class="colon">:</span></dt>
<dd class="field-odd"><p>Covariance matrix of errors of measurement variables.</p>
</dd>
<dt class="field-even">type Hm<span class="colon">:</span></dt>
<dd class="field-even"><p>numpy.array.</p>
</dd>
<dt class="field-odd">param obs<span class="colon">:</span></dt>
<dd class="field-odd"><p>Measurements.</p>
</dd>
<dt class="field-even">type obs<span class="colon">:</span></dt>
<dd class="field-even"><p>list.</p>
</dd>
<dt class="field-odd">param MULT<span class="colon">:</span></dt>
<dd class="field-odd"><p>Multiplier of the terminal time range.  If set greater than one than 
the solution will be computed for this extended time range interval.</p>
</dd>
<dt class="field-even">type MULT<span class="colon">:</span></dt>
<dd class="field-even"><p>int.</p>
</dd>
<dt class="field-odd">param missing_obs<span class="colon">:</span></dt>
<dd class="field-odd"><p>Matrix of logical values with True or False value depending on observation missing or not.</p>
</dd>
<dt class="field-even">type missing_obs<span class="colon">:</span></dt>
<dd class="field-even"><p>Matrix of bools.</p>
</dd>
<dt class="field-odd">returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Filtered solution.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-snowdrop.src.numeric.filters.filters">
<span id="snowdrop-src-numeric-filters-filters-module"></span><h2>snowdrop.src.numeric.filters.filters module<a class="headerlink" href="#module-snowdrop.src.numeric.filters.filters" title="Link to this heading">¶</a></h2>
<p>Created on Mon Feb 26 18:49:21 2018</p>
<p>&#64;author: agoumilevski</p>
<dl class="py function">
<dt class="sig sig-object py" id="snowdrop.src.numeric.filters.filters.BPASS">
<span class="sig-prename descclassname"><span class="pre">snowdrop.src.numeric.filters.filters.</span></span><span class="sig-name descname"><span class="pre">BPASS</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">drift</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bChristianoFitzgerald</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/snowdrop/src/numeric/filters/filters.html#BPASS"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#snowdrop.src.numeric.filters.filters.BPASS" title="Link to this definition">¶</a></dt>
<dd><p>Bandpass filter to time series.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="snowdrop.src.numeric.filters.filters.Bryson_Frazier_Smoother">
<span class="sig-prename descclassname"><span class="pre">snowdrop.src.numeric.filters.filters.</span></span><span class="sig-name descname"><span class="pre">Bryson_Frazier_Smoother</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">u</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">F</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">H</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">K</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Sinv</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">P</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">L</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/snowdrop/src/numeric/filters/filters.html#Bryson_Frazier_Smoother"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#snowdrop.src.numeric.filters.filters.Bryson_Frazier_Smoother" title="Link to this definition">¶</a></dt>
<dd><p>Implement modified Bryson-Frazier (BF) smoother for a state-space model.</p>
<p>BF algorithm is:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}L_{t} &amp;= H'_{t}*S_{t}^{-1}*H_{t} + (I-K_{t}*H_{t})'*L_{t}*(I-K_{t}*H_{t})\\L_{t-1} &amp;= F'_{t}*Lt_{t}*F_{t}\\L_{T} &amp;= 0\\l_{t} &amp;= -H'_{t}*S_{t}^{-1}*u_{t} + (I-K_{t}*H_{t})'*l_{t}\\l_{t-1} &amp;= F'_{t}*lt_{t}\\l_{T} &amp;= 0                                                                   \end{aligned}\end{align} \]</div>
<p>Smoothed variables and covariances</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}xs_{t|T} &amp;= x_{t} - P_{t}*l_{t}\\P_{t|T} &amp;= P_{t} - P_{t}*L_{t}*P_{t}\end{aligned}\end{align} \]</div>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>x: array, dtype=float</dt><dd><p>is the state variables,</p>
</dd>
<dt>u: array, dtype=float</dt><dd><p>is the vector of one-step-ahead prediction errors</p>
</dd>
<dt>F: 2D array, dtype=float</dt><dd><p>is the state-transition matrix,</p>
</dd>
<dt>H: 2D array, dtype=float</dt><dd><p>is the observation matrix,</p>
</dd>
<dt>K: 2D array, dtype=float</dt><dd><p>is the Kalman gain,</p>
</dd>
<dt>Sinv: 2D array, dtype=float</dt><dd><p>is the inverse of matrix S,</p>
</dd>
<dt>P: 2D array, dtype=float</dt><dd><p>is the predicted error covariance matrix,</p>
</dd>
<dt>L: 2D array, dtype=float</dt><dd><p>is the covariance matrix,</p>
</dd>
<dt>l: 2D array, dtype=float</dt><dd><p>is the temporary matrix</p>
</dd>
</dl>
</dd>
</dl>
<p>For details, see <a class="reference external" href="https://en.wikipedia.org/wiki/Kalman_filter">https://en.wikipedia.org/wiki/Kalman_filter</a></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="snowdrop.src.numeric.filters.filters.DK_Filter">
<span class="sig-prename descclassname"><span class="pre">snowdrop.src.numeric.filters.filters.</span></span><span class="sig-name descname"><span class="pre">DK_Filter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xtilde</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">T</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Z</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">P</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">H</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Q</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">K</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">C</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ind_non_missing</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/snowdrop/src/numeric/filters/filters.html#DK_Filter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#snowdrop.src.numeric.filters.filters.DK_Filter" title="Link to this definition">¶</a></dt>
<dd><p>Implement non-diffusive Durbin &amp; Koopman version of Kalman filter algorithm for state-space model.</p>
<p>Multivariate approach to Kalman filter.</p>
<p>State-space model</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}x_{t} = T_{t} * x_{t-1} + C_{t}  + w_{t},  w = Normal(0, Q)\\y_{t} = Z_{t} * x_{t} + v_{t},             v =  Normal(0, H)\end{aligned}\end{align} \]</div>
<p>Durbin-Koopman algorithm</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}v_{t} &amp;= y_{t} - Z_{t} * x_{t}\\        x_{t} &amp;= T_{t} * (x_{t-1} + K_{t} * v_{t}) + C_{t}\\        F_{t} &amp;= H_{t} + Z_{t} * P_{t-1} * Z'_{t}\\        K_{t} &amp;= P_{t} * Z'_{t} * F_{t}^{-1}\\L_{t} &amp;= K_{t} * Z_{t} \\        P_{t+1} &amp;= T_{t} * P_{t} *L'_{t-1} + Q_{t}                \end{aligned}\end{align} \]</div>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>x: array, dtype=float</dt><dd><p>is the variables at t+1|t+1 step,</p>
</dd>
<dt>xtilde: array, dtype=float</dt><dd><p>is the variables at t|t+1 forecast step,</p>
</dd>
<dt>y: array, dtype=float</dt><dd><p>is the observation variables,</p>
</dd>
<dt>v: array, dtype=float</dt><dd><p>is the residual,</p>
</dd>
<dt>T: 2D array, dtype=float</dt><dd><p>is the state-transition matrix,</p>
</dd>
<dt>Z: 2D array, dtype=float</dt><dd><p>is the observation matrix,</p>
</dd>
<dt>P: 2D array, dtype=float</dt><dd><p>is the predicted error covariance matrix,</p>
</dd>
<dt>H: 2D array, dtype=float</dt><dd><p>is the covariance matrix of measurement errors,</p>
</dd>
<dt>Q: 2D array, dtype=float</dt><dd><p>is the covariance matrix of structural errors,</p>
</dd>
<dt>K: 2Darray, dtype=float</dt><dd><p>is the Kalman gain,</p>
</dd>
<dt>C: array, dtype=float</dt><dd><p>is the constant term matrix,</p>
</dd>
<dt>ind_non_missing: array, dtype=int</dt><dd><p>are the indices of non-missing observations,</p>
</dd>
<dt>tol1: number, float</dt><dd><p>Kalman tolerance for reciprocal condition number,</p>
</dd>
<dt>tol2: number, float</dt><dd><p>diffuse Kalman tolerance for reciprocal condition number (for Finf) and the rank of Pinf</p>
</dd>
</dl>
</dd>
<dt>For details, see Durbin &amp; Koopman 2012, “Time series Analysis by State Space Methods” and</dt><dd><p>Koopman &amp; Durbin 2000, “Fast Filtering and Smoothing For Multivariate State Space Models”</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="snowdrop.src.numeric.filters.filters.DK_Smoother">
<span class="sig-prename descclassname"><span class="pre">snowdrop.src.numeric.filters.filters.</span></span><span class="sig-name descname"><span class="pre">DK_Smoother</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">T</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Z</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">F</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iF</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">P</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">QRt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">K</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">H</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ind_non_missing</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/snowdrop/src/numeric/filters/filters.html#DK_Smoother"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#snowdrop.src.numeric.filters.filters.DK_Smoother" title="Link to this definition">¶</a></dt>
<dd><p>Implement non-diffusive Durbin-Koopman smoother for state-space model.</p>
<p>Durbin-Koopman smoothing algorithm is</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}r_{t-1} &amp;= Z'_{t}*F_{t}^{-1}*v_{t} + L'_{t}**r_{t} \\r_{T} &amp;= 0 \\L_{t} &amp;= I - K_{t}*Z_{t}                                                          \end{aligned}\end{align} \]</div>
<p>Smoothed variables</p>
<div class="math notranslate nohighlight">
\[s_{t} = x_{t} + P_{t}*r_{t-1}\]</div>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>x: array, dtype=float</dt><dd><p>is the updated state variables vector,</p>
</dd>
<dt>y: array, dtype=float</dt><dd><p>is the observation variables,</p>
</dd>
<dt>T: 2D array, dtype=float</dt><dd><p>is the state-transition matrix,</p>
</dd>
<dt>Z: 2D array, dtype=float</dt><dd><p>is the observation matrix,</p>
</dd>
<dt>F: 2D array, dtype=float</dt><dd><p>is the residual covariance matrix,</p>
</dd>
<dt>iF: 2D array, dtype=float</dt><dd><p>is the inverse of matrix F,</p>
</dd>
<dt>P: 2D array, dtype=float</dt><dd><p>is the updated error covariance matrix,</p>
</dd>
<dt>QRt: 2D array, dtype=float</dt><dd><p>is the product of the covariance matrix of structural errors and shock matrix</p>
</dd>
<dt>K: 2D array, dtype=float</dt><dd><p>is the Kalman gain matrix,</p>
</dd>
<dt>H: 2D array, dtype=float</dt><dd><p>is the covariance matrix of measurement errors,</p>
</dd>
<dt>r: array, dtype=float</dt><dd><p>is the vector of one-step-back errors,</p>
</dd>
<dt>v: array, dtype=float</dt><dd><p>is the vector of one-step-ahead prediction errors,</p>
</dd>
<dt>ind_non_missing: array, dtype=int</dt><dd><p>are the indices of non-missing observations.</p>
</dd>
</dl>
</dd>
</dl>
<p>For details, see Durbin &amp; Koopman (2012), “Time series Analysis by State Space Methods” and
Koopman &amp; Durbin (2000), “Fast Filtering and Smoothing For Multivariate State Space Models” and
Koopman &amp; Durbin (2003), in Journal of Time Series Analysis, vol. 24(1), pp. 85-98</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="snowdrop.src.numeric.filters.filters.Durbin_Koopman_Diffuse_Filter">
<span class="sig-prename descclassname"><span class="pre">snowdrop.src.numeric.filters.filters.</span></span><span class="sig-name descname"><span class="pre">Durbin_Koopman_Diffuse_Filter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xtilde</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">T</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Z</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">P</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">H</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Q</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">C</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bUnivariate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ind_non_missing</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Pstar</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Pinf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-06</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-06</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/snowdrop/src/numeric/filters/filters.html#Durbin_Koopman_Diffuse_Filter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#snowdrop.src.numeric.filters.filters.Durbin_Koopman_Diffuse_Filter" title="Link to this definition">¶</a></dt>
<dd><p>Implement diffuse Durbin &amp; Koopman version of Kalman filter algorithm for state-space model.</p>
<p>State-space model:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}x_{t} = T_{t} * x_{t-1} + C_{t}  + w_{t},  w = Normal(0, Q)\\y_{t} = Z_{t} * x_{t} + v_{t}, v = Normal(0, H)\end{aligned}\end{align} \]</div>
<p>Durbin-Koopman algorithm</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}v_{t} &amp;= y_{t} - Z_{t} * x_{t}\\        x_{t} &amp;= T_{t} * (x_{t-1} + K_{t} * v_{t}) + C_{t}\\        F_{t} &amp;= H_{t} + Z_{t} * P_{t-1} * Z'_{t}\\        K_{t} &amp;= P_{t} * Z'_{t} * F_{t}^{-1}\\L_{t} &amp;= K_{t} * Z_{t}\\        P_{t+1} &amp;= T_{t} * P_{t} *L'_{t-1} + Q_{t}                \end{aligned}\end{align} \]</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Translated from Dynare Matlab code.</p>
</div>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>x: array, dtype=float</dt><dd><p>is the state variables,</p>
</dd>
<dt>xtilde: array, dtype=float</dt><dd><p>is the variables at t|t+1 forecast step,</p>
</dd>
<dt>y: array, dtype=float</dt><dd><p>is the observation variables,</p>
</dd>
<dt>T: 2D array, dtype=float</dt><dd><p>is the state-transition matrix,</p>
</dd>
<dt>Z: 2D array, dtype=float</dt><dd><p>is the observation matrix,</p>
</dd>
<dt>P: 2D array, dtype=float</dt><dd><p>is the predicted error covariance matrix,</p>
</dd>
<dt>H: 2D array, dtype=float</dt><dd><p>is the covariance matrix of measurement errors,</p>
</dd>
<dt>Q: 2D array, dtype=float</dt><dd><p>is the covariance matrix of structural errors,</p>
</dd>
<dt>C: array, dtype=float</dt><dd><p>is the constant term matrix,</p>
</dd>
<dt>ind_non_missing: array, dtype=int</dt><dd><p>are the indices of non-missing observations,</p>
</dd>
<dt>Pstar: 2D array, dtype=float</dt><dd><p>is the finite part of the predicted error covariance matrix,</p>
</dd>
<dt>Pinf: 2D array, dtype=float</dt><dd><p>is the infinite part of the predicted error covariance matrix,</p>
</dd>
<dt>tol1: number, float</dt><dd><p>Kalman tolerance for reciprocal condition number,</p>
</dd>
<dt>tol2: number, float</dt><dd><p>diffuse Kalman tolerance for reciprocal condition number (for Finf) and the rank of Pinf</p>
</dd>
</dl>
</dd>
<dt>For details, see Durbin &amp; Koopman 2012, “Time series Analysis by State Space Methods” and</dt><dd><p>Koopman &amp; Durbin 2000, “Fast Filtering and Smoothing For Multivariate State Space Models”</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="snowdrop.src.numeric.filters.filters.Durbin_Koopman_Diffuse_Smoother">
<span class="sig-prename descclassname"><span class="pre">snowdrop.src.numeric.filters.filters.</span></span><span class="sig-name descname"><span class="pre">Durbin_Koopman_Diffuse_Smoother</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">T</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Z</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">F</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iF</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">QRt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">K</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Kstar</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Kinf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">H</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">P</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">P1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Pstar</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Pinf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Pstar1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Pinf1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Linf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Lstar</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ind_non_missing</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diffuse</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Finf_singular</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bUnivariate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-06</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-06</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/snowdrop/src/numeric/filters/filters.html#Durbin_Koopman_Diffuse_Smoother"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#snowdrop.src.numeric.filters.filters.Durbin_Koopman_Diffuse_Smoother" title="Link to this definition">¶</a></dt>
<dd><p>Implement diffuse Durbin-Koopman smoother for state-space model.</p>
<p>Durbin-Koopman algorithm is</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}r_{t-1} &amp;= Z'_{t}*F_{t}^{-1}*v_{t} + L'_{t}**r_{t}\\r_{T} &amp;= 0\\L_{t} &amp;= I - K_{t}*Z_{t}                                                          \end{aligned}\end{align} \]</div>
<p>Smoothed variables</p>
<div class="math notranslate nohighlight">
\[s_{t} = x_{t} + P_{t}*r_{t-1}\]</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Translated from Dynare Matlab code.</p>
</div>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>x: array, dtype=float</dt><dd><p>is the predicted state variables vector,</p>
</dd>
<dt>y: array, dtype=float</dt><dd><p>is the observation variables,</p>
</dd>
<dt>T: 2D array, dtype=float</dt><dd><p>is the state-transition matrix,</p>
</dd>
<dt>Z: 2D array, dtype=float</dt><dd><p>is the observation matrix,</p>
</dd>
<dt>F: 2D array, dtype=float</dt><dd><p>is the residual covariance matrix,</p>
</dd>
<dt>iF: 2D array, dtype=float</dt><dd><p>is the inverse of matrix F,</p>
</dd>
<dt>QRt: 2D array, dtype=float</dt><dd><p>is the product of the covariance matrix of structural errors and shock matrix</p>
</dd>
<dt>K: 2D array, dtype=float</dt><dd><p>is the Kalman gain matrix,</p>
</dd>
<dt>Kinf: 2D array, dtype=float</dt><dd><p>is the infinite part of the Kalman gain matrix,</p>
</dd>
<dt>Kstar: 2D array, dtype=float</dt><dd><p>is the finite part of the Kalman gain matrix,</p>
</dd>
<dt>H: 2D array, dtype=float</dt><dd><p>is the observation errors covariance matrix,</p>
</dd>
<dt>P: 2D array, dtype=float</dt><dd><p>is the updated error covariance matrix P,</p>
</dd>
<dt>P1:2D array, dtype=float</dt><dd><p>is the updated error covariance matrix P1,</p>
</dd>
<dt>Pstar: 2D array, dtype=float</dt><dd><p>is the finite part of P matrix,</p>
</dd>
<dt>Pinf: 2D array, dtype=float</dt><dd><p>is the infinite part of P matrix,</p>
</dd>
<dt>Pstar1: 2D array, dtype=float</dt><dd><p>is the finite part of P1 matrix,</p>
</dd>
<dt>Pinf1: 2D array, dtype=float</dt><dd><p>is the infinite part of P1 matrix,</p>
</dd>
<dt>ind_non_missing: array, dtype=int</dt><dd><p>are the indices of non-missing observations.</p>
</dd>
<dt>v: array, dtype=float</dt><dd><p>is the vector of one-step-ahead prediction errors,</p>
</dd>
<dt>r: array, dtype=float</dt><dd><p>is  a smoothed state vector,</p>
</dd>
<dt>r0: array, dtype=float</dt><dd><p>is zero approximation in a Taylor expansion of a smoothed state vector,</p>
</dd>
<dt>r1: array, dtype=float</dt><dd><p>is the first approximation in a Taylor expansion of a smoothed state vector,</p>
</dd>
<dt>Pstar: 2D array, dtype=float</dt><dd><p>is the finite part of the predicted error covariance matrix,</p>
</dd>
<dt>Pinf: 2D array, dtype=float</dt><dd><p>is the infinite part of the predicted error covariance matrix,</p>
</dd>
<dt>Finf_singular: bool</dt><dd><p>True if Finf is a singular matrix and False otherwise,</p>
</dd>
<dt>bUnivariate: bool</dt><dd><p>True if univariate Kalman filter is used and False otherwise,</p>
</dd>
<dt>tol1: number, float</dt><dd><p>is Kalman tolerance for reciprocal condition number,</p>
</dd>
<dt>tol2: number, float</dt><dd><p>is diffuse Kalman tolerance for reciprocal condition number (for Finf) and the rank of Pinf</p>
</dd>
</dl>
</dd>
</dl>
<p>For details, see Durbin &amp; Koopman (2012), “Time series Analysis by State Space Methods” and
Koopman &amp; Durbin (2000), “Fast Filtering and Smoothing For Multivariate State Space Models” and
Koopman &amp; Durbin (2003), in Journal of Time Series Analysis, vol. 24(1), pp. 85-98)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="snowdrop.src.numeric.filters.filters.Durbin_Koopman_Non_Diffuse_Filter">
<span class="sig-prename descclassname"><span class="pre">snowdrop.src.numeric.filters.filters.</span></span><span class="sig-name descname"><span class="pre">Durbin_Koopman_Non_Diffuse_Filter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xtilde</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">T</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Z</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">P</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">H</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Q</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">C</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bUnivariate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ind_non_missing</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-06</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-06</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/snowdrop/src/numeric/filters/filters.html#Durbin_Koopman_Non_Diffuse_Filter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#snowdrop.src.numeric.filters.filters.Durbin_Koopman_Non_Diffuse_Filter" title="Link to this definition">¶</a></dt>
<dd><p>Implement non-diffusive Durbin &amp; Koopman version of Kalman filter algorithm for state-space model.</p>
<p>State-space model:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}x_{t} = T_{t} * x_{t-1} + C_{t}  + w_{t},  w = Normal(0, Q)\\y_{t} = Z_{t} * x_{t} + v_{t},             v = Normal(0, H)\end{aligned}\end{align} \]</div>
<p>Durbin-Koopman algorithm</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}v_{t} &amp;= y_{t} - Z_{t} * x_{t}\\        x_{t} &amp;= T_{t} * (x_{t-1} + K_{t} * v_{t}) + C_{t}\\        F_{t} &amp;= H_{t} + Z_{t} * P_{t-1} * Z'_{t}\\        K_{t} &amp;= P_{t} * Z'_{t} * F_{t}^{-1}\\L_{t} &amp;= K_{t} * Z_{t}\\        P_{t+1} &amp;= T_{t} * P_{t} *L'_{t-1} + Q_{t}                \end{aligned}\end{align} \]</div>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>x: array, dtype=float</dt><dd><p>is the variables at t+1|t+1 step,</p>
</dd>
<dt>xtilde: array, dtype=float</dt><dd><p>is the variables at t|t+1 forecast step,</p>
</dd>
<dt>y: array, dtype=float</dt><dd><p>is the observation variables,</p>
</dd>
<dt>T: 2D array, dtype=float</dt><dd><p>is the state-transition matrix,</p>
</dd>
<dt>Z: 2D array, dtype=float</dt><dd><p>is the observation matrix,</p>
</dd>
<dt>P: 2D array, dtype=float</dt><dd><p>is the predicted error covariance matrix,</p>
</dd>
<dt>H: 2D array, dtype=float</dt><dd><p>is the covariance matrix of measurement errors,</p>
</dd>
<dt>Q: 2D array, dtype=float</dt><dd><p>is the covariance matrix of structural errors,</p>
</dd>
<dt>C: array, dtype=float</dt><dd><p>is the constant term matrix,</p>
</dd>
<dt>ind_non_missing: array, dtype=int</dt><dd><p>are the indices of non-missing observations,</p>
</dd>
<dt>tol1: number, float</dt><dd><p>Kalman tolerance for reciprocal condition number,</p>
</dd>
<dt>tol2: number, float</dt><dd><p>diffuse Kalman tolerance for reciprocal condition number (for Finf) and the rank of Pinf</p>
</dd>
</dl>
</dd>
<dt>For details, see Durbin &amp; Koopman 2012, “Time series Analysis by State Space Methods” and</dt><dd><p>Koopman &amp; Durbin 2000, “Fast Filtering and Smoothing For Multivariate State Space Models”</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="snowdrop.src.numeric.filters.filters.Durbin_Koopman_Non_Diffuse_Smoother">
<span class="sig-prename descclassname"><span class="pre">snowdrop.src.numeric.filters.filters.</span></span><span class="sig-name descname"><span class="pre">Durbin_Koopman_Non_Diffuse_Smoother</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">T</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Z</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">F</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iF</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">P</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">P1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">QRt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">K</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ind_non_missing</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bUnivariate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-06</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/snowdrop/src/numeric/filters/filters.html#Durbin_Koopman_Non_Diffuse_Smoother"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#snowdrop.src.numeric.filters.filters.Durbin_Koopman_Non_Diffuse_Smoother" title="Link to this definition">¶</a></dt>
<dd><p>Implement non-diffusive Durbin-Koopman smoother for state-space model.</p>
<p>Durbin-Koopman algorithm is</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}r_{t-1} &amp;= Z'_{t}*F_{t}^{-1}*v_{t} + L'_{t}**r_{t}\\r_{T} &amp;= 0\\N_{t-1} &amp;= Z'_{t}*F_{t}^{-1}*Z_{t} + L'_{t}*N_{t}*L{t}\\N_{T} &amp;= 0\\L_{t} &amp;= I - K_{t}*Z_{t}                                                          \end{aligned}\end{align} \]</div>
<p>Smoothed variables</p>
<div class="math notranslate nohighlight">
\[s_{t} = x_{t} + P_{t}*r_{t-1}\]</div>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>x: array, dtype=float</dt><dd><p>is the predicted variables vector,</p>
</dd>
<dt>y: array, dtype=float</dt><dd><p>is the observation variables,</p>
</dd>
<dt>T: 2D array, dtype=float</dt><dd><p>is the state-transition matrix,</p>
</dd>
<dt>Z: 2D array, dtype=float</dt><dd><p>is the observation matrix,</p>
</dd>
<dt>F: 2D array, dtype=float</dt><dd><p>is the residual covariance matrix,</p>
</dd>
<dt>iF: 2D array, dtype=float</dt><dd><p>is the inverse of matrix F,</p>
</dd>
<dt>P: 2D array, dtype=float</dt><dd><p>is the updated error covariance matrix,</p>
</dd>
<dt>QRt: 2D array, dtype=float</dt><dd><p>is the product of the covariance matrix of structural errors and shock matrix,</p>
</dd>
<dt>K:2D array, dtype=float</dt><dd><p>is the Kalman gain matrix,</p>
</dd>
<dt>r: array, dtype=float</dt><dd><p>is the vector of one-step-back errors,</p>
</dd>
<dt>v: array, dtype=float</dt><dd><p>is the vector of one-step-ahead prediction errors,</p>
</dd>
<dt>ind_non_missing: array, dtype=int</dt><dd><p>are the indices of non-missing observations.</p>
</dd>
<dt>bUnivariate: bool</dt><dd><p>True if univariate Kalman filter is used and False otherwise,</p>
</dd>
<dt>tol: number, float</dt><dd><p>is Kalman tolerance for reciprocal condition number.</p>
</dd>
</dl>
</dd>
</dl>
<p>For details, see Durbin &amp; Koopman (2012), “Time series Analysis by State Space Methods” and
Koopman &amp; Durbin (2000), “Fast Filtering and Smoothing For Multivariate State Space Models” and
Koopman &amp; Durbin (2003), in Journal of Time Series Analysis, vol. 24(1), pp. 85-98</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="snowdrop.src.numeric.filters.filters.HPF">
<span class="sig-prename descclassname"><span class="pre">snowdrop.src.numeric.filters.filters.</span></span><span class="sig-name descname"><span class="pre">HPF</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lmbd</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1600</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/snowdrop/src/numeric/filters/filters.html#HPF"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#snowdrop.src.numeric.filters.filters.HPF" title="Link to this definition">¶</a></dt>
<dd><p>Hodrick-Prescott filter to a time series.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="snowdrop.src.numeric.filters.filters.HPfilter">
<span class="sig-prename descclassname"><span class="pre">snowdrop.src.numeric.filters.filters.</span></span><span class="sig-name descname"><span class="pre">HPfilter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lmbd</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1600</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/snowdrop/src/numeric/filters/filters.html#HPfilter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#snowdrop.src.numeric.filters.filters.HPfilter" title="Link to this definition">¶</a></dt>
<dd><p>Apply a Hodrick-Prescott filter to a dataset.</p>
<p>The return value is the filtered data-set found according to:</p>
<div class="math notranslate nohighlight">
\[\min_{T_{t}}[ \sum_{t=0}((X_{t} - T_{t})^2 + \lambda*((T_{t+1} - T_{t}) - (T_{t} - T_{t-1}))^2) ]\]</div>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>data: array, dtype=float</dt><dd><p>The data set for which you want to apply the HP filter.
This mustbe a numpy array.</p>
</dd>
<dt>lmbd: array, dtype=float</dt><dd><p>This is the value for lambda as used in the equation.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><dl class="simple">
<dt>T: array, dtype=float</dt><dd><p>The solution to the minimization equation above (the trend).</p>
</dd>
<dt>Cycle: array, dtype=float</dt><dd><p>This is the ‘stationary data’ found by X - T.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This function implements sparse methods to be efficient enough to handle
very large data sets.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="snowdrop.src.numeric.filters.filters.Kalman_Filter">
<span class="sig-prename descclassname"><span class="pre">snowdrop.src.numeric.filters.filters.</span></span><span class="sig-name descname"><span class="pre">Kalman_Filter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">T</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Z</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">P</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Q</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">H</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">C</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ind_non_missing</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bUnivariate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-06</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/snowdrop/src/numeric/filters/filters.html#Kalman_Filter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#snowdrop.src.numeric.filters.filters.Kalman_Filter" title="Link to this definition">¶</a></dt>
<dd><p>Implement Kalman filter algorithm for state-space model.</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>x: array, dtype=float</dt><dd><p>is the state variables,</p>
</dd>
<dt>y: array, dtype=float</dt><dd><p>is the observation variables,</p>
</dd>
<dt>T: 2D array, dtype=float</dt><dd><p>is the state-transition matrix,</p>
</dd>
<dt>Z: 2D array, dtype=float</dt><dd><p>is the observation matrix,</p>
</dd>
<dt>P: 2D array, dtype=float</dt><dd><p>is the predicted error covariance matrix,</p>
</dd>
<dt>Q: 2D array, dtype=float</dt><dd><p>is the covariance matrix of state variables (endogenous variables),</p>
</dd>
<dt>H: 2D array, dtype=float</dt><dd><p>is the covariance matrix of space variables (measurement variables),</p>
</dd>
<dt>C: array, dtype=float</dt><dd><p>is the constant term matrix,</p>
</dd>
<dt>bUnivariate: bool</dt><dd><p>if True univariate Kalman filter is used and if False - multivariate,</p>
</dd>
<dt>ind_non_missing: array, dtype=int</dt><dd><p>are the indices of non-missing observations,</p>
</dd>
<dt>tol: number, dtype=float</dt><dd><p>is the tolerance parameter (iteration over the Riccati equation)</p>
</dd>
</dl>
</dd>
</dl>
<p>For details, see <a class="reference external" href="https://en.wikipedia.org/wiki/Kalman_filter">https://en.wikipedia.org/wiki/Kalman_filter</a></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="snowdrop.src.numeric.filters.filters.Kalman_Filter_SS">
<span class="sig-prename descclassname"><span class="pre">snowdrop.src.numeric.filters.filters.</span></span><span class="sig-name descname"><span class="pre">Kalman_Filter_SS</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">T</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Z</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">K</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">F</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iF</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">C</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ind_non_missing</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/snowdrop/src/numeric/filters/filters.html#Kalman_Filter_SS"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#snowdrop.src.numeric.filters.filters.Kalman_Filter_SS" title="Link to this definition">¶</a></dt>
<dd><p>Implement Kalman filter algorithm for stationary state-space model.</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>x: array, dtype=float</dt><dd><p>is the state variables,</p>
</dd>
<dt>y: array, dtype=float</dt><dd><p>is the observation variables,</p>
</dd>
<dt>T: 2D array, dtype=float</dt><dd><p>is the state-transition matrix,</p>
</dd>
<dt>Z: 2D array, dtype=float</dt><dd><p>is the observation matrix,</p>
</dd>
<dt>K: 2D array, dtype=float</dt><dd><p>is the Kalman gain matrix,</p>
</dd>
<dt>F: 2D array, dtype=float</dt><dd><p>is the pre-fit residual covariance,</p>
</dd>
<dt>iF: 2D array, dtype=float</dt><dd><p>is the inverse of the pre-fit residual covariance,</p>
</dd>
<dt>C: array, dtype=float</dt><dd><p>is the constant term matrix,</p>
</dd>
<dt>bUnivariate: bool</dt><dd><p>if True univariate Kalman filter is used and if False - multivariate,</p>
</dd>
<dt>ind_non_missing: array, dtype=int</dt><dd><p>are the indices of non-missing observations,</p>
</dd>
<dt>tol: number, dtype=float</dt><dd><p>is the tolerance parameter</p>
</dd>
</dl>
</dd>
</dl>
<p>For details, see <a class="reference external" href="https://en.wikipedia.org/wiki/Kalman_filter">https://en.wikipedia.org/wiki/Kalman_filter</a></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="snowdrop.src.numeric.filters.filters.LRXfilter">
<span class="sig-prename descclassname"><span class="pre">snowdrop.src.numeric.filters.filters.</span></span><span class="sig-name descname"><span class="pre">LRXfilter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lmbd</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1600</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">w1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">w2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">w3</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dprior</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prior</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/snowdrop/src/numeric/filters/filters.html#LRXfilter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#snowdrop.src.numeric.filters.filters.LRXfilter" title="Link to this definition">¶</a></dt>
<dd><p>Apply enchanced HP filter.</p>
<p>This is LRX filter named after Laxton-Rose-Xie.</p>
<p>A brief explanation of terms used in LRX filter</p>
<dl>
<dt>Syntax: </dt><dd><p>y_eq = LRXfilter(y,lmbd[,w1[,w2[,w3[,DPRIOR[,PRIOR]]]]])</p>
</dd>
<dt>Args:</dt><dd><dl class="simple">
<dt>lmbd: float</dt><dd><p>tightness constraint for HP filter,</p>
</dd>
<dt>y:  array, dtype=float</dt><dd><p>series to be detrended,</p>
</dd>
<dt>w1: float</dt><dd><p>weight on (y - y_eq)^2,</p>
</dd>
<dt>w2: float</dt><dd><p>weight on [(y_eq - y_eq(-1)) - dprior]^2,</p>
</dd>
<dt>w3: float</dt><dd><p>weight on (y_eq - prior)^2,</p>
</dd>
<dt>dprior: array, dtype=float</dt><dd><p>growth rate of y in steady-state,</p>
</dd>
<dt>prior: array, dtype=float</dt><dd><p>previously computed y_eq.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>y_eq: The trend component,</p>
<p>gap: The cycle component</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>the default value of lmbd is 1600,</p>
<p>the default value of w1 is a vector of ones,</p>
<p>the default value of w2 is a vector of zeros,</p>
<p>the default value of w3 is a vector of zeros,</p>
<p>the default value of dpr is a vector of zeros,</p>
<p>the default value of pr is a vector of zeros,</p>
<p>if any of w1, w2, w3, dpr, pr is of length 1, then it is extended to
a vector of the appropriate length, in which all the entries are
equal.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="snowdrop.src.numeric.filters.filters.Rauch_Tung_Striebel_Smoother">
<span class="sig-prename descclassname"><span class="pre">snowdrop.src.numeric.filters.filters.</span></span><span class="sig-name descname"><span class="pre">Rauch_Tung_Striebel_Smoother</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Ytp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Xt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Xtp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Ft</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Pt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Ptp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Ttp</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/snowdrop/src/numeric/filters/filters.html#Rauch_Tung_Striebel_Smoother"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#snowdrop.src.numeric.filters.filters.Rauch_Tung_Striebel_Smoother" title="Link to this definition">¶</a></dt>
<dd><p>Implement Rauch-Tung-Striebel (RTS) smoother for state-space model.</p>
<p>RTS algorithm is</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}L_{t} &amp;= P_{t|t} * F'_{t} * P_{t+1|t}^{-1}\\X_{t|T} &amp;= X_{t|t} + L_{t} * (X_{t+1|T} - X_{t+1|t})\\P_{t|T} &amp;= P_{t+1|t} + L_{t} * (P_{t+1|T} - P_{t+1|t}) * L'_{t}\end{aligned}\end{align} \]</div>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>Ytp: array, dtype=float</dt><dd><p>is the smoothed state variables at time t+1,</p>
</dd>
<dt>Xt: array, dtype=float</dt><dd><p>is the state variables at time t,</p>
</dd>
<dt>Xtp: array, dtype=float</dt><dd><p>is the state variables at time t+1,</p>
</dd>
<dt>Ft: 2D array, dtype=float</dt><dd><p>is the state-transition matrix at time t,</p>
</dd>
<dt>Pt: 2D array, dtype=float</dt><dd><p>is the predicted error covariance matrix at time t,</p>
</dd>
<dt>Ptp: 2D array, dtype=float</dt><dd><p>is the predicted error covariance matrix at time t+1,</p>
</dd>
<dt>Ttp: 2D array, dtype=float</dt><dd><p>is the smoothed covariance matrix of state variables.</p>
</dd>
</dl>
</dd>
</dl>
<p>For details, see <a class="reference external" href="https://en.wikipedia.org/wiki/Kalman_filter">https://en.wikipedia.org/wiki/Kalman_filter</a></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="snowdrop.src.numeric.filters.filters.Standard_Kalman_Filter">
<span class="sig-prename descclassname"><span class="pre">snowdrop.src.numeric.filters.filters.</span></span><span class="sig-name descname"><span class="pre">Standard_Kalman_Filter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">T</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Z</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">P</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Q</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">H</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">C</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ind_non_missing</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/snowdrop/src/numeric/filters/filters.html#Standard_Kalman_Filter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#snowdrop.src.numeric.filters.filters.Standard_Kalman_Filter" title="Link to this definition">¶</a></dt>
<dd><p>Implement Kalman filter algorithm for state-space model.</p>
<p>This implementation assumes that measurement equation is specified at time t.</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}x_{t+1} = T_{t} * x_{t} + C_{t}  + w_{t},  w_{t} = Normal(0, Q),\\y_{t+1} = Z_{t} * x_{t+1} + v_{t},  v_{t} = Normal(0, H)\end{aligned}\end{align} \]</div>
<p>KF uses two phase algorithm</p>
<p>Predict</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}x_{t|t} &amp;= x_{t|t-1} + P_{t|t-1} * L_{t} * (y_{t} - Z_{t} * x_{t|t-1})\\P_{t|t} &amp;= P_{t|t-1} - L * Z_{t} * P_{t|t-1}\\L{t} &amp;= Z_{t} * [Z_{t}*P_{t|t-1}*Z'_{t} + H]^{-1}\end{aligned}\end{align} \]</div>
<p>Update</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}v_{t} &amp;= y_{t} - Z_{t} * x_{t|t-1}\\x_{t+1|t} &amp;= T_{t} * x_{t|t} + C_{t}\\P_{t+1|t} &amp;= T_{t} * P_{t|t} * T'_{t} + Q_{t}\end{aligned}\end{align} \]</div>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>x<span class="classifier">array, dtype=float</span></dt><dd><p>is the state variables,</p>
</dd>
<dt>y<span class="classifier">array, dtype=float</span></dt><dd><p>is the observation variables,</p>
</dd>
<dt>T<span class="classifier">2D array, dtype=float</span></dt><dd><p>is the state-transition matrix,</p>
</dd>
<dt>Z<span class="classifier">2D array, dtype=float</span></dt><dd><p>is the observation matrix,</p>
</dd>
<dt>P<span class="classifier">2D array, dtype=float</span></dt><dd><p>is the predicted error covariance matrix,</p>
</dd>
<dt>Q<span class="classifier">2D array, dtype=float</span></dt><dd><p>is the covariance matrix of state variables (endogenous variables),</p>
</dd>
<dt>H<span class="classifier">2D array, dtype=float</span></dt><dd><p>is the covariance matrix of space variables (measurement variables),</p>
</dd>
<dt>C<span class="classifier">array, dtype=float</span></dt><dd><p>is the constant term matrix,</p>
</dd>
<dt>ind_non_missing<span class="classifier">array, dtype=int</span></dt><dd><p>are the indices of non-missing observations.</p>
</dd>
</dl>
</dd>
</dl>
<p>For details, please see <a class="reference external" href="https://stanford.edu/class/ee363/lectures/kf.pdf">https://stanford.edu/class/ee363/lectures/kf.pdf</a></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="snowdrop.src.numeric.filters.filters.bandpass_filter">
<span class="sig-prename descclassname"><span class="pre">snowdrop.src.numeric.filters.filters.</span></span><span class="sig-name descname"><span class="pre">bandpass_filter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">w1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">w2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/snowdrop/src/numeric/filters/filters.html#bandpass_filter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#snowdrop.src.numeric.filters.filters.bandpass_filter" title="Link to this definition">¶</a></dt>
<dd><p>Apply a bandpass filter to data.</p>
<p>This band-pass filter is of kth order.  It selects the band between w1 and w2.</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>data: array, dtype=float</dt><dd><p>The data you wish to filter</p>
</dd>
<dt>k: number, int</dt><dd><p>The order of approximation for the filter. A max value for
this is data.size/2</p>
</dd>
<dt>w1: number, float</dt><dd><p>This is the lower bound for which frequencies will pass
through.</p>
</dd>
<dt>w2: number, float</dt><dd><p>This is the upper bound for which frequencies will pass
through.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><dl class="simple">
<dt>y: array, dtype=float</dt><dd><p>The filtered data.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="snowdrop.src.numeric.filters.filters.fast_kalman_filter">
<span class="sig-prename descclassname"><span class="pre">snowdrop.src.numeric.filters.filters.</span></span><span class="sig-name descname"><span class="pre">fast_kalman_filter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">P</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">T</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">H</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Z</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kalman_tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-10</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/snowdrop/src/numeric/filters/filters.html#fast_kalman_filter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#snowdrop.src.numeric.filters.filters.fast_kalman_filter" title="Link to this definition">¶</a></dt>
<dd><p>Computes the likelihood of a stationary state space model, given initial condition for the states (mean and variance).</p>
<dl class="simple">
<dt>References: </dt><dd><p>Edward P. Herbst, (2012). ‘Using the ”Chandrasekhar Recursions” 
for Likelihood Evaluation of DSGE Models’’</p>
</dd>
<dt>Args:</dt><dd><dl class="simple">
<dt>Y:  array, dtype=float</dt><dd><p>Measurement data,</p>
</dd>
<dt>N:  scalar, int</dt><dd><p>Last period,</p>
</dd>
<dt>a:  array, dtype=float</dt><dd><p>Initial mean of the state vector,</p>
</dd>
<dt>P:  2D array, dtype=float </dt><dd><p>Initial covariance matrix of the state vector,</p>
</dd>
<dt>T: 2D array, dtype=float</dt><dd><p>Transition matrix of the state equation,</p>
</dd>
<dt>H: 2D array, dtype=float</dt><dd><p>Covariance matrix of the measurement errors (if no measurement errors set H as a zero scalar),</p>
</dd>
<dt>Z: 2D array, dtype=float </dt><dd><p>Matrix relating the states to the observed variables or vector of indices,</p>
</dd>
<dt>kalman_tol: scalar, float</dt><dd><p>Tolerance parameter (rcond, inversibility of the covariance matrix of the prediction errors),</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-snowdrop.src.numeric.filters.kalman">
<span id="snowdrop-src-numeric-filters-kalman-module"></span><h2>snowdrop.src.numeric.filters.kalman module<a class="headerlink" href="#module-snowdrop.src.numeric.filters.kalman" title="Link to this heading">¶</a></h2>
<p>Basic implementation of the Kalman filter (and smoother).</p>
<section id="overview">
<h3>Overview<a class="headerlink" href="#overview" title="Link to this heading">¶</a></h3>
<p>The Kalman filter/smoother is a well-known algorithm for computing recursively
the filtering/smoothing distributions of a linear Gaussian model, i.e. a model
of the form:</p>
<div class="math notranslate nohighlight">
\[\begin{split}X_0 &amp; \sim N(\mu_0,C_0) \\
X_t &amp; = F X_{t-1} + U_t, \quad   U_t \sim N(0, C_X) \\
Y_t &amp; = G X_t + V_t,     \quad   V_t \sim N(0, C_Y)\end{split}\]</div>
<p>Linear Gaussian models and the Kalman filter are covered in Chapter 7 of the
book.</p>
</section>
<section id="mvlineargauss-class-and-subclasses">
<h3>MVLinearGauss class and subclasses<a class="headerlink" href="#mvlineargauss-class-and-subclasses" title="Link to this heading">¶</a></h3>
<p>To define a specific linear Gaussian model, we instantiate class
<cite>MVLinearGauss</cite> (or one its subclass) as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">particles</span> <span class="kn">import</span> <span class="n">kalman</span>

<span class="n">ssm</span> <span class="o">=</span> <span class="n">kalman</span><span class="o">.</span><span class="n">MVLinearGauss</span><span class="p">(</span><span class="n">F</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)),</span> <span class="n">G</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">covX</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span>
                           <span class="n">covY</span><span class="o">=</span><span class="mf">.3</span><span class="p">)</span>
</pre></div>
</div>
<p>where the parameters have the same meaning as above. It is also possible to
specify <cite>mu0`and  `cov0</cite> (the mean and covariance of the initial state X_0).
(See the documentation of the class for more details.)</p>
<p>Class <cite>MVLinearGauss</cite> is a sub-class of <cite>StateSpaceModel</cite> in module
<cite>state_space_models</cite>, so it inherits methods from its parent such as:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">true_states</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">ssm</span><span class="o">.</span><span class="n">simulate</span><span class="p">(</span><span class="mi">30</span><span class="p">)</span>
</pre></div>
</div>
<p>Class <cite>MVLinearGauss</cite> implements methods <cite>proposal</cite>, <cite>proposal0</cite> and <cite>logeta</cite>,
which correspond respectively to the optimal proposal distributions and
auxiliary function for a guided or auxiliary particle filter; see Chapter 11
and module <cite>state_space_models</cite> for more details. (That the optimal quantities
are tractable is, of course, due to the fact that the model is linear and
Gaussian.)</p>
<p>To define a univariate linear Gaussian model, you may want to use instead the
more conveniently parametrised class <cite>LinearGauss</cite> (which is a sub-class of
<code class="docutils literal notranslate"><span class="pre">MVLinearGauss</span></code>):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ssm</span> <span class="o">=</span> <span class="n">LinearGauss</span><span class="p">(</span><span class="n">rho</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">sigX</span><span class="o">=</span><span class="mf">1.</span><span class="p">,</span> <span class="n">sigY</span><span class="o">=</span><span class="mf">.2</span><span class="p">,</span> <span class="n">sig0</span><span class="o">=</span><span class="mf">1.</span><span class="p">)</span>
</pre></div>
</div>
<p>which corresponds to model:</p>
<div class="math notranslate nohighlight">
\[\begin{split}X_0                 &amp; \sim N(0, \sigma_0^2) \\
X_t|X_{t-1}=x_{t-1} &amp; \sim N(\rho * X_{t-1},\sigma_X^2) \\
Y_t |X_t=x_t        &amp; \sim N(x_t, \sigma_Y^2)\end{split}\]</div>
<p>Another sub-class of <cite>MVLinearGauss</cite> defined in this module is
<cite>MVLinearGauss_Guarniero_etal</cite>, which implements a particular class of linear
Gaussian models often used as a benchmark (after Guarniero et al, 2016).</p>
</section>
<section id="kalman-class">
<h3><cite>Kalman</cite> class<a class="headerlink" href="#kalman-class" title="Link to this heading">¶</a></h3>
<p>The Kalman filter is implemented as a class, <cite>Kalman</cite>, with methods
<cite>filter</cite> and <cite>smoother</cite>. When instantiating the class, one passes
as arguments the data, and an object that represents the considered model (i.e.
an instance of MvLinearGauss, see above):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">kf</span> <span class="o">=</span> <span class="n">kalman</span><span class="o">.</span><span class="n">Kalman</span><span class="p">(</span><span class="n">ssm</span><span class="o">=</span><span class="n">ssm</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>
<span class="n">kf</span><span class="o">.</span><span class="n">filter</span><span class="p">()</span>
</pre></div>
</div>
<p>The second line implements the forward pass of a Kalman filter. The results are
stored as lists of <cite>MeanAndCov</cite> objects, that is, named tuples with attributes
‘mean’ and ‘cov’ that represent a Gaussian distribution. For instance:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">kf</span><span class="o">.</span><span class="n">filt</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span>  <span class="c1"># mean of the filtering distribution at time 3</span>
<span class="n">kf</span><span class="o">.</span><span class="n">pred</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span><span class="o">.</span><span class="n">cov</span>  <span class="c1"># cov matrix of the predictive distribution at time 7</span>
</pre></div>
</div>
<p>The forward pass also computes the log-likelihood of the data:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">kf</span><span class="o">.</span><span class="n">logpyt</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span>  <span class="c1"># log-density of Y_t | Y_{0:t-1} at time t=5</span>
</pre></div>
</div>
<p>Smoothing works along the same lines:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">kf</span><span class="o">.</span><span class="n">smoother</span><span class="p">()</span>
</pre></div>
</div>
<p>then object kf contains a list called smooth, which represents the successive
(marginal) smoothing distributions:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">kf</span><span class="o">.</span><span class="n">smth</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span>  <span class="c1"># mean of the smoothing dist at time 8</span>
</pre></div>
</div>
<p>It is possible to call method <cite>smoother</cite> directly (without calling <cite>filter</cite>
first). In that case, the filtering step is automatically performed as a
preliminary step.</p>
</section>
<section id="kalman-objects-as-iterators">
<h3>Kalman objects as iterators<a class="headerlink" href="#kalman-objects-as-iterators" title="Link to this heading">¶</a></h3>
<p>It is possible to perform the forward pass step by step; in fact a <cite>Kalman</cite>
object is an iterator:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">kf</span> <span class="o">=</span> <span class="n">kalman</span><span class="o">.</span><span class="n">Kalman</span><span class="p">(</span><span class="n">ssm</span><span class="o">=</span><span class="n">ssm</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>
<span class="nb">next</span><span class="p">(</span><span class="n">kf</span><span class="p">)</span>  <span class="c1"># one step</span>
<span class="nb">next</span><span class="p">(</span><span class="n">kf</span><span class="p">)</span>  <span class="c1"># one step</span>
</pre></div>
</div>
<p>If you run the smoother after k such steps, you will obtain the smoothing
distribution based on the k first data-points. It is therefore possible to
compute recursively the successive smoothing distributions, but (a) at a high
CPU cost; and (b) at each time, you must save the results somewhere, as
attribute <cite>kf.smth</cite> gets written over and over.</p>
</section>
<section id="functions-to-perform-a-single-step">
<h3>Functions to perform a single step<a class="headerlink" href="#functions-to-perform-a-single-step" title="Link to this heading">¶</a></h3>
<p>The module also defines low-level functions that perform a single step of the
forward or backward step. Some of these function makes it possible to perform
such steps <em>in parallel</em> (e.g. for N predictive means).  The table below lists
these functions. Some of the required inputs are <cite>MeanAndCov</cite> objects, which
may be defined as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">my_predictive_dist</span> <span class="o">=</span> <span class="n">kalman</span><span class="o">.</span><span class="n">MeanAndCov</span><span class="p">(</span><span class="n">mean</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">cov</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Function (with signature)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>predict_step(F, covX, filt)</p></td>
</tr>
<tr class="row-odd"><td><p>filter_step(G, covY, pred, yt)</p></td>
</tr>
<tr class="row-even"><td><p>filter_step_asarray(G, covY, pred, yt)</p></td>
</tr>
<tr class="row-odd"><td><p>smoother_step(F, filt, next_pred, next_smth)</p></td>
</tr>
</tbody>
</table>
</section>
<dl class="py class">
<dt class="sig sig-object py" id="snowdrop.src.numeric.filters.kalman.Kalman">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">snowdrop.src.numeric.filters.kalman.</span></span><span class="sig-name descname"><span class="pre">Kalman</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ssm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/snowdrop/src/numeric/filters/kalman.html#Kalman"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#snowdrop.src.numeric.filters.kalman.Kalman" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Kalman filter/smoother.</p>
<p>See the documentation of the module for more details.</p>
<dl class="py method">
<dt class="sig sig-object py" id="snowdrop.src.numeric.filters.kalman.Kalman.filter">
<span class="sig-name descname"><span class="pre">filter</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/snowdrop/src/numeric/filters/kalman.html#Kalman.filter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#snowdrop.src.numeric.filters.kalman.Kalman.filter" title="Link to this definition">¶</a></dt>
<dd><p>Forward recursion: compute mean/variance of filter and prediction.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="snowdrop.src.numeric.filters.kalman.Kalman.next">
<span class="sig-name descname"><span class="pre">next</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/snowdrop/src/numeric/filters/kalman.html#Kalman.next"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#snowdrop.src.numeric.filters.kalman.Kalman.next" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="snowdrop.src.numeric.filters.kalman.Kalman.smoother">
<span class="sig-name descname"><span class="pre">smoother</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/snowdrop/src/numeric/filters/kalman.html#Kalman.smoother"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#snowdrop.src.numeric.filters.kalman.Kalman.smoother" title="Link to this definition">¶</a></dt>
<dd><p>Backward recursion: compute mean/variance of marginal smoother.</p>
<p>Performs the filter step in a preliminary step if needed.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="snowdrop.src.numeric.filters.kalman.Kalman.t">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">t</span></span><a class="headerlink" href="#snowdrop.src.numeric.filters.kalman.Kalman.t" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="snowdrop.src.numeric.filters.kalman.LinearGauss">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">snowdrop.src.numeric.filters.kalman.</span></span><span class="sig-name descname"><span class="pre">LinearGauss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/snowdrop/src/numeric/filters/kalman.html#LinearGauss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#snowdrop.src.numeric.filters.kalman.LinearGauss" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#snowdrop.src.numeric.filters.kalman.MVLinearGauss" title="snowdrop.src.numeric.filters.kalman.MVLinearGauss"><code class="xref py py-class docutils literal notranslate"><span class="pre">MVLinearGauss</span></code></a></p>
<p>A basic (univariate) linear Gaussian model.</p>
<div class="math notranslate nohighlight">
\[\begin{split}X_0                 &amp; \sim N(0, \sigma_0^2) \\
X_t|X_{t-1}=x_{t-1} &amp; \sim N(\rho * X_{t-1},\sigma_X^2) \\
Y_t |X_t=x_t        &amp; \sim N(x_t, \sigma_Y^2)\end{split}\]</div>
<section id="note">
<h3>Note<a class="headerlink" href="#note" title="Link to this heading">¶</a></h3>
<p>If parameter sigma0 is set to None, it is replaced by the quantity that
makes the state process invariant:
<span class="math notranslate nohighlight">\(\sigma_X^2 / (1 - \rho^2)\)</span></p>
<dl class="py method">
<dt class="sig sig-object py" id="snowdrop.src.numeric.filters.kalman.LinearGauss.PX">
<span class="sig-name descname"><span class="pre">PX</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xp</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/snowdrop/src/numeric/filters/kalman.html#LinearGauss.PX"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#snowdrop.src.numeric.filters.kalman.LinearGauss.PX" title="Link to this definition">¶</a></dt>
<dd><p>Law of X_t at time t, given X_{t-1} = xp</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="snowdrop.src.numeric.filters.kalman.LinearGauss.PX0">
<span class="sig-name descname"><span class="pre">PX0</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/snowdrop/src/numeric/filters/kalman.html#LinearGauss.PX0"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#snowdrop.src.numeric.filters.kalman.LinearGauss.PX0" title="Link to this definition">¶</a></dt>
<dd><p>Law of X_0 at time 0</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="snowdrop.src.numeric.filters.kalman.LinearGauss.PY">
<span class="sig-name descname"><span class="pre">PY</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/snowdrop/src/numeric/filters/kalman.html#LinearGauss.PY"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#snowdrop.src.numeric.filters.kalman.LinearGauss.PY" title="Link to this definition">¶</a></dt>
<dd><p>Conditional distribution of Y_t, given the states.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="snowdrop.src.numeric.filters.kalman.LinearGauss.default_params">
<span class="sig-name descname"><span class="pre">default_params</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'rho':</span> <span class="pre">0.9,</span> <span class="pre">'sigma0':</span> <span class="pre">None,</span> <span class="pre">'sigmaX':</span> <span class="pre">1.0,</span> <span class="pre">'sigmaY':</span> <span class="pre">0.2}</span></em><a class="headerlink" href="#snowdrop.src.numeric.filters.kalman.LinearGauss.default_params" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="snowdrop.src.numeric.filters.kalman.LinearGauss.logeta">
<span class="sig-name descname"><span class="pre">logeta</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/snowdrop/src/numeric/filters/kalman.html#LinearGauss.logeta"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#snowdrop.src.numeric.filters.kalman.LinearGauss.logeta" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="snowdrop.src.numeric.filters.kalman.LinearGauss.proposal">
<span class="sig-name descname"><span class="pre">proposal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/snowdrop/src/numeric/filters/kalman.html#LinearGauss.proposal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#snowdrop.src.numeric.filters.kalman.LinearGauss.proposal" title="Link to this definition">¶</a></dt>
<dd><p>Proposal kernel (to be used in a guided or auxiliary filter).</p>
<section id="parameter">
<h4>Parameter<a class="headerlink" href="#parameter" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>t: int</dt><dd><p>time</p>
</dd>
<dt>x:</dt><dd><p>particles</p>
</dd>
<dt>data: list-like</dt><dd><p>data</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="snowdrop.src.numeric.filters.kalman.LinearGauss.proposal0">
<span class="sig-name descname"><span class="pre">proposal0</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/snowdrop/src/numeric/filters/kalman.html#LinearGauss.proposal0"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#snowdrop.src.numeric.filters.kalman.LinearGauss.proposal0" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</section>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="snowdrop.src.numeric.filters.kalman.MVLinearGauss">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">snowdrop.src.numeric.filters.kalman.</span></span><span class="sig-name descname"><span class="pre">MVLinearGauss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">F</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">G</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">covX</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">covY</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cov0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/snowdrop/src/numeric/filters/kalman.html#MVLinearGauss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#snowdrop.src.numeric.filters.kalman.MVLinearGauss" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">StateSpaceModel</span></code></p>
<p>Multivariate linear Gaussian model.</p>
<div class="math notranslate nohighlight">
\[X_0 &amp; \sim N(\mu_0, cov_0) \
X_t &amp; = F * X_{t-1} + U_t, \quad   U_t\sim N(0, cov_X) \
Y_t &amp; = G * X_t + V_t,     \quad   V_t \sim N(0, cov_Y)\]</div>
<p>The only mandatory parameters are <cite>covX</cite> and <cite>covY</cite> (from which the
dimensions dx and dy of, respectively, X_t, and Y_t, are deduced). The
default values for the other parameters are:</p>
<blockquote>
<div><ul class="simple">
<li><p><cite>mu0</cite>:: an array of zeros (of size dx)</p></li>
<li><p><cite>cov0</cite>: cov_X</p></li>
<li><p><cite>F</cite>: Identity matrix of shape (dx, dx)</p></li>
<li><p><cite>G</cite>: (dy, dx) matrix such that G[i, j] = 1[i=j]</p></li>
</ul>
</div></blockquote>
<section id="id1">
<h3>Note<a class="headerlink" href="#id1" title="Link to this heading">¶</a></h3>
<p>The Kalman filter takes as an input an instance of this class (or one of
its subclasses).</p>
<dl class="py method">
<dt class="sig sig-object py" id="snowdrop.src.numeric.filters.kalman.MVLinearGauss.PX">
<span class="sig-name descname"><span class="pre">PX</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xp</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/snowdrop/src/numeric/filters/kalman.html#MVLinearGauss.PX"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#snowdrop.src.numeric.filters.kalman.MVLinearGauss.PX" title="Link to this definition">¶</a></dt>
<dd><p>Law of X_t at time t, given X_{t-1} = xp</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="snowdrop.src.numeric.filters.kalman.MVLinearGauss.PX0">
<span class="sig-name descname"><span class="pre">PX0</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/snowdrop/src/numeric/filters/kalman.html#MVLinearGauss.PX0"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#snowdrop.src.numeric.filters.kalman.MVLinearGauss.PX0" title="Link to this definition">¶</a></dt>
<dd><p>Law of X_0 at time 0</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="snowdrop.src.numeric.filters.kalman.MVLinearGauss.PY">
<span class="sig-name descname"><span class="pre">PY</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/snowdrop/src/numeric/filters/kalman.html#MVLinearGauss.PY"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#snowdrop.src.numeric.filters.kalman.MVLinearGauss.PY" title="Link to this definition">¶</a></dt>
<dd><p>Conditional distribution of Y_t, given the states.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="snowdrop.src.numeric.filters.kalman.MVLinearGauss.check_shapes">
<span class="sig-name descname"><span class="pre">check_shapes</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/snowdrop/src/numeric/filters/kalman.html#MVLinearGauss.check_shapes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#snowdrop.src.numeric.filters.kalman.MVLinearGauss.check_shapes" title="Link to this definition">¶</a></dt>
<dd><p>Check all dimensions are correct.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="snowdrop.src.numeric.filters.kalman.MVLinearGauss.logeta">
<span class="sig-name descname"><span class="pre">logeta</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/snowdrop/src/numeric/filters/kalman.html#MVLinearGauss.logeta"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#snowdrop.src.numeric.filters.kalman.MVLinearGauss.logeta" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="snowdrop.src.numeric.filters.kalman.MVLinearGauss.proposal">
<span class="sig-name descname"><span class="pre">proposal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/snowdrop/src/numeric/filters/kalman.html#MVLinearGauss.proposal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#snowdrop.src.numeric.filters.kalman.MVLinearGauss.proposal" title="Link to this definition">¶</a></dt>
<dd><p>Proposal kernel (to be used in a guided or auxiliary filter).</p>
<section id="id2">
<h4>Parameter<a class="headerlink" href="#id2" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>t: int</dt><dd><p>time</p>
</dd>
<dt>x:</dt><dd><p>particles</p>
</dd>
<dt>data: list-like</dt><dd><p>data</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="snowdrop.src.numeric.filters.kalman.MVLinearGauss.proposal0">
<span class="sig-name descname"><span class="pre">proposal0</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/snowdrop/src/numeric/filters/kalman.html#MVLinearGauss.proposal0"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#snowdrop.src.numeric.filters.kalman.MVLinearGauss.proposal0" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</section>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="snowdrop.src.numeric.filters.kalman.MVLinearGauss_Guarniero_etal">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">snowdrop.src.numeric.filters.kalman.</span></span><span class="sig-name descname"><span class="pre">MVLinearGauss_Guarniero_etal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/snowdrop/src/numeric/filters/kalman.html#MVLinearGauss_Guarniero_etal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#snowdrop.src.numeric.filters.kalman.MVLinearGauss_Guarniero_etal" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#snowdrop.src.numeric.filters.kalman.MVLinearGauss" title="snowdrop.src.numeric.filters.kalman.MVLinearGauss"><code class="xref py py-class docutils literal notranslate"><span class="pre">MVLinearGauss</span></code></a></p>
<p>Special case of a MV Linear Gaussian ssm from Guarnierio et al. (2016).</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}G = cov_X = cov_Y = cov_0 = I_{d_x}\\F_{i, j} = lpha^ { 1 + |i-j|}\end{aligned}\end{align} \]</div>
<p>See <cite>MVLinearGauss</cite> for the definition of these quantities.</p>
<section id="parameters">
<h3>Parameters<a class="headerlink" href="#parameters" title="Link to this heading">¶</a></h3>
<dl class="simple">
<dt>alpha:  float (default: 0.4)</dt><dd><p>value of alpha</p>
</dd>
<dt>dx: int (must be &gt;1; default: 2)</dt><dd><p>dimension of state-space</p>
</dd>
</dl>
</section>
<section id="reference">
<h3>Reference<a class="headerlink" href="#reference" title="Link to this heading">¶</a></h3>
<dl class="simple">
<dt>Guarnierio et al (2016). The Iterated Auxiliary Particle Filter,</dt><dd><p>arxiv:1511.06286, JASA.</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="snowdrop.src.numeric.filters.kalman.MeanAndCov">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">snowdrop.src.numeric.filters.kalman.</span></span><span class="sig-name descname"><span class="pre">MeanAndCov</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mean</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cov</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#snowdrop.src.numeric.filters.kalman.MeanAndCov" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="snowdrop.src.numeric.filters.kalman.MeanAndCov.cov">
<span class="sig-name descname"><span class="pre">cov</span></span><a class="headerlink" href="#snowdrop.src.numeric.filters.kalman.MeanAndCov.cov" title="Link to this definition">¶</a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="snowdrop.src.numeric.filters.kalman.MeanAndCov.mean">
<span class="sig-name descname"><span class="pre">mean</span></span><a class="headerlink" href="#snowdrop.src.numeric.filters.kalman.MeanAndCov.mean" title="Link to this definition">¶</a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="snowdrop.src.numeric.filters.kalman.dotdot">
<span class="sig-prename descclassname"><span class="pre">snowdrop.src.numeric.filters.kalman.</span></span><span class="sig-name descname"><span class="pre">dotdot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/snowdrop/src/numeric/filters/kalman.html#dotdot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#snowdrop.src.numeric.filters.kalman.dotdot" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="snowdrop.src.numeric.filters.kalman.dotdotinv">
<span class="sig-prename descclassname"><span class="pre">snowdrop.src.numeric.filters.kalman.</span></span><span class="sig-name descname"><span class="pre">dotdotinv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/snowdrop/src/numeric/filters/kalman.html#dotdotinv"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#snowdrop.src.numeric.filters.kalman.dotdotinv" title="Link to this definition">¶</a></dt>
<dd><p>a * b * c^{-1}, where c is symmetric positive</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="snowdrop.src.numeric.filters.kalman.filter_step">
<span class="sig-prename descclassname"><span class="pre">snowdrop.src.numeric.filters.kalman.</span></span><span class="sig-name descname"><span class="pre">filter_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">G</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">covY</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pred</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yt</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/snowdrop/src/numeric/filters/kalman.html#filter_step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#snowdrop.src.numeric.filters.kalman.filter_step" title="Link to this definition">¶</a></dt>
<dd><p>Filtering step of Kalman filter.</p>
<section id="id3">
<h3>Parameters<a class="headerlink" href="#id3" title="Link to this heading">¶</a></h3>
<dl class="simple">
<dt>G:  (dy, dx) numpy array</dt><dd><p>mean of Y_t | X_t is G * X_t</p>
</dd>
<dt>covX: (dx, dx) numpy array</dt><dd><p>covariance of Y_t | X_t</p>
</dd>
<dt>pred: MeanAndCov object</dt><dd><p>predictive distribution at time t</p>
</dd>
</dl>
</section>
<section id="returns">
<h3>Returns<a class="headerlink" href="#returns" title="Link to this heading">¶</a></h3>
<dl class="simple">
<dt>pred: MeanAndCov object</dt><dd><p>filtering distribution at time t</p>
</dd>
<dt>logpyt: float</dt><dd><p>log density of Y_t | Y_{0:t-1}</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="snowdrop.src.numeric.filters.kalman.filter_step_asarray">
<span class="sig-prename descclassname"><span class="pre">snowdrop.src.numeric.filters.kalman.</span></span><span class="sig-name descname"><span class="pre">filter_step_asarray</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">G</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">covY</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pred</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yt</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/snowdrop/src/numeric/filters/kalman.html#filter_step_asarray"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#snowdrop.src.numeric.filters.kalman.filter_step_asarray" title="Link to this definition">¶</a></dt>
<dd><p>Filtering step of Kalman filter: array version.</p>
<section id="id4">
<h3>Parameters<a class="headerlink" href="#id4" title="Link to this heading">¶</a></h3>
<dl class="simple">
<dt>G:  (dy, dx) numpy array</dt><dd><p>mean of Y_t | X_t is G * X_t</p>
</dd>
<dt>covX: (dx, dx) numpy array</dt><dd><p>covariance of Y_t | X_t</p>
</dd>
<dt>pred: MeanAndCov object</dt><dd><p>predictive distribution at time t</p>
</dd>
</dl>
</section>
<section id="id5">
<h3>Returns<a class="headerlink" href="#id5" title="Link to this heading">¶</a></h3>
<dl class="simple">
<dt>pred: MeanAndCov object</dt><dd><p>filtering distribution at time t</p>
</dd>
<dt>logpyt: float</dt><dd><p>log density of Y_t | Y_{0:t-1}</p>
</dd>
</dl>
</section>
<section id="id6">
<h3>Note<a class="headerlink" href="#id6" title="Link to this heading">¶</a></h3>
<p>This performs the filtering step for N distinctive predictive means:
filt.mean should be a (N, dx) or (N) array; pred.mean in the output
will have the same shape.</p>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="snowdrop.src.numeric.filters.kalman.predict_step">
<span class="sig-prename descclassname"><span class="pre">snowdrop.src.numeric.filters.kalman.</span></span><span class="sig-name descname"><span class="pre">predict_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">F</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">covX</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/snowdrop/src/numeric/filters/kalman.html#predict_step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#snowdrop.src.numeric.filters.kalman.predict_step" title="Link to this definition">¶</a></dt>
<dd><p>Predictive step of Kalman filter.</p>
<section id="id7">
<h3>Parameters<a class="headerlink" href="#id7" title="Link to this heading">¶</a></h3>
<dl class="simple">
<dt>F:  (dx, dx) numpy array</dt><dd><p>Mean of X_t | X_{t-1} is F * X_{t-1}</p>
</dd>
<dt>covX: (dx, dx) numpy array</dt><dd><p>covariance of X_t | X_{t-1}</p>
</dd>
<dt>filt: MeanAndCov object</dt><dd><p>filtering distribution at time t-1</p>
</dd>
</dl>
</section>
<section id="id8">
<h3>Returns<a class="headerlink" href="#id8" title="Link to this heading">¶</a></h3>
<dl class="simple">
<dt>pred: MeanAndCov object</dt><dd><p>predictive distribution at time t</p>
</dd>
</dl>
</section>
<section id="id9">
<h3>Note<a class="headerlink" href="#id9" title="Link to this heading">¶</a></h3>
<p>filt.mean may either be of shape (dx,) or (N, dx); in the latter case
N predictive steps are performed in parallel.</p>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="snowdrop.src.numeric.filters.kalman.smoother_step">
<span class="sig-prename descclassname"><span class="pre">snowdrop.src.numeric.filters.kalman.</span></span><span class="sig-name descname"><span class="pre">smoother_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">F</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">next_pred</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">next_smth</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/snowdrop/src/numeric/filters/kalman.html#smoother_step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#snowdrop.src.numeric.filters.kalman.smoother_step" title="Link to this definition">¶</a></dt>
<dd><p>Smoothing step of Kalman filter/smoother.</p>
<section id="id10">
<h3>Parameters<a class="headerlink" href="#id10" title="Link to this heading">¶</a></h3>
<dl class="simple">
<dt>F:  (dx, dx) numpy array</dt><dd><p>Mean of X_t | X_{t-1} is F * X_{t-1}</p>
</dd>
<dt>filt: MeanAndCov object</dt><dd><p>filtering distribution at time t</p>
</dd>
<dt>next_pred: MeanAndCov object</dt><dd><p>predictive distribution at time t+1</p>
</dd>
<dt>next_smth: MeanAndCov object</dt><dd><p>smoothing distribution at time t+1</p>
</dd>
</dl>
</section>
<section id="id11">
<h3>Returns<a class="headerlink" href="#id11" title="Link to this heading">¶</a></h3>
<dl class="simple">
<dt>smth: MeanAndCov object</dt><dd><p>smoothing distribution at time t</p>
</dd>
</dl>
</section>
</dd></dl>

</section>
<section id="module-snowdrop.src.numeric.filters.particle">
<span id="snowdrop-src-numeric-filters-particle-module"></span><h2>snowdrop.src.numeric.filters.particle module<a class="headerlink" href="#module-snowdrop.src.numeric.filters.particle" title="Link to this heading">¶</a></h2>
<p>Created on Sat Jun 26 09:23:51 2021</p>
<p>&#64;author: Alexei Goumilevski</p>
<dl class="py class">
<dt class="sig sig-object py" id="snowdrop.src.numeric.filters.particle.NonlinearStateSpaceModel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">snowdrop.src.numeric.filters.particle.</span></span><span class="sig-name descname"><span class="pre">NonlinearStateSpaceModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parameters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Z</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigmaX</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigmaY</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ind_non_missing</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_shocks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/snowdrop/src/numeric/filters/particle.html#NonlinearStateSpaceModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#snowdrop.src.numeric.filters.particle.NonlinearStateSpaceModel" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">StateSpaceModel</span></code></p>
<p>State space model class.</p>
<dl class="py method">
<dt class="sig sig-object py" id="snowdrop.src.numeric.filters.particle.NonlinearStateSpaceModel.PX">
<span class="sig-name descname"><span class="pre">PX</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xp</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/snowdrop/src/numeric/filters/particle.html#NonlinearStateSpaceModel.PX"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#snowdrop.src.numeric.filters.particle.NonlinearStateSpaceModel.PX" title="Link to this definition">¶</a></dt>
<dd><p>Distribution of X_t given X_{t-1} = xp (p=past).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="snowdrop.src.numeric.filters.particle.NonlinearStateSpaceModel.PX0">
<span class="sig-name descname"><span class="pre">PX0</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/snowdrop/src/numeric/filters/particle.html#NonlinearStateSpaceModel.PX0"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#snowdrop.src.numeric.filters.particle.NonlinearStateSpaceModel.PX0" title="Link to this definition">¶</a></dt>
<dd><p>Distribution of X_0.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="snowdrop.src.numeric.filters.particle.NonlinearStateSpaceModel.PY">
<span class="sig-name descname"><span class="pre">PY</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/snowdrop/src/numeric/filters/particle.html#NonlinearStateSpaceModel.PY"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#snowdrop.src.numeric.filters.particle.NonlinearStateSpaceModel.PY" title="Link to this definition">¶</a></dt>
<dd><p>Distribution of Y_t given X_t=x, and X_{t-1}=xp.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="snowdrop.src.numeric.filters.particle.ParticleGibbs">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">snowdrop.src.numeric.filters.particle.</span></span><span class="sig-name descname"><span class="pre">ParticleGibbs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">niter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ssm_cls</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prior</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Nx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fk_cls</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">regenerate_data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">backward_step</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">store_x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/snowdrop/src/numeric/filters/particle.html#ParticleGibbs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#snowdrop.src.numeric.filters.particle.ParticleGibbs" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">ParticleGibbs</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="snowdrop.src.numeric.filters.particle.ParticleGibbs.update_theta">
<span class="sig-name descname"><span class="pre">update_theta</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">theta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/snowdrop/src/numeric/filters/particle.html#ParticleGibbs.update_theta"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#snowdrop.src.numeric.filters.particle.ParticleGibbs.update_theta" title="Link to this definition">¶</a></dt>
<dd><p>Update model parameters.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="snowdrop.src.numeric.filters.particle.StateSpaceModel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">snowdrop.src.numeric.filters.particle.</span></span><span class="sig-name descname"><span class="pre">StateSpaceModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">T</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">R</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Z</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Qm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">H</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">C</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parameters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ind_non_missing</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/snowdrop/src/numeric/filters/particle.html#StateSpaceModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#snowdrop.src.numeric.filters.particle.StateSpaceModel" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">StateSpaceModel</span></code></p>
<p>State space model class.</p>
<dl class="py method">
<dt class="sig sig-object py" id="snowdrop.src.numeric.filters.particle.StateSpaceModel.PX">
<span class="sig-name descname"><span class="pre">PX</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xp</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/snowdrop/src/numeric/filters/particle.html#StateSpaceModel.PX"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#snowdrop.src.numeric.filters.particle.StateSpaceModel.PX" title="Link to this definition">¶</a></dt>
<dd><p>Distribution of X_t given X_{t-1} = xp (p=past).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="snowdrop.src.numeric.filters.particle.StateSpaceModel.PX0">
<span class="sig-name descname"><span class="pre">PX0</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/snowdrop/src/numeric/filters/particle.html#StateSpaceModel.PX0"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#snowdrop.src.numeric.filters.particle.StateSpaceModel.PX0" title="Link to this definition">¶</a></dt>
<dd><p>Distribution of X_0.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="snowdrop.src.numeric.filters.particle.StateSpaceModel.PY">
<span class="sig-name descname"><span class="pre">PY</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/snowdrop/src/numeric/filters/particle.html#StateSpaceModel.PY"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#snowdrop.src.numeric.filters.particle.StateSpaceModel.PY" title="Link to this definition">¶</a></dt>
<dd><p>Distribution of Y_t given X_t=x, and X_{t-1}=xp.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="snowdrop.src.numeric.filters.particle.getMatrices">
<span class="sig-prename descclassname"><span class="pre">snowdrop.src.numeric.filters.particle.</span></span><span class="sig-name descname"><span class="pre">getMatrices</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obj</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">par</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/snowdrop/src/numeric/filters/particle.html#getMatrices"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#snowdrop.src.numeric.filters.particle.getMatrices" title="Link to this definition">¶</a></dt>
<dd><p>Compute matrices.</p>
</dd></dl>

</section>
<section id="module-snowdrop.src.numeric.filters.py_kalman">
<span id="snowdrop-src-numeric-filters-py-kalman-module"></span><h2>snowdrop.src.numeric.filters.py_kalman module<a class="headerlink" href="#module-snowdrop.src.numeric.filters.py_kalman" title="Link to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="snowdrop.src.numeric.filters.py_kalman.MyBiermanKalmanFilter">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">snowdrop.src.numeric.filters.py_kalman.</span></span><span class="sig-name descname"><span class="pre">MyBiermanKalmanFilter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">transition_matrices</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">observation_matrices</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transition_covariance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">observation_covariance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transition_offsets</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">observation_offsets</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_state_mean</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_state_covariance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">em_vars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['transition_covariance',</span> <span class="pre">'observation_covariance',</span> <span class="pre">'initial_state_mean',</span> <span class="pre">'initial_state_covariance']</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_dim_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_dim_obs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/snowdrop/src/numeric/filters/py_kalman.html#MyBiermanKalmanFilter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#snowdrop.src.numeric.filters.py_kalman.MyBiermanKalmanFilter" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">BiermanKalmanFilter</span></code></p>
<p>This module implements Bierman’s version of the Kalman Filter.  In particular,
the UDU’ decomposition of the covariance matrix is used instead of the full
matrix, where U is upper triangular and D is diagonal.</p>
<dl class="py method">
<dt class="sig sig-object py" id="snowdrop.src.numeric.filters.py_kalman.MyBiermanKalmanFilter.filter_update">
<span class="sig-name descname"><span class="pre">filter_update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filtered_state_mean</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filtered_state_covariance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">observation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transition_matrix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transition_offset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transition_covariance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">observation_matrix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">observation_offset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">observation_covariance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/snowdrop/src/numeric/filters/py_kalman.html#MyBiermanKalmanFilter.filter_update"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#snowdrop.src.numeric.filters.py_kalman.MyBiermanKalmanFilter.filter_update" title="Link to this definition">¶</a></dt>
<dd><p>Update a Kalman Filter state estimate</p>
<p>Perform a one-step update to estimate the state at time <span class="math notranslate nohighlight">\(t+1\)</span>
give an observation at time <span class="math notranslate nohighlight">\(t+1\)</span> and the previous estimate for
time <span class="math notranslate nohighlight">\(t\)</span> given observations from times <span class="math notranslate nohighlight">\([0...t]\)</span>.  This
method is useful if one wants to track an object with streaming
observations.</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>filtered_state_mean<span class="classifier">[n_dim_state] array</span></dt><dd><p>mean estimate for state at time t given observations from times
[1…t]</p>
</dd>
<dt>filtered_state_covariance<span class="classifier">[n_dim_state, n_dim_state] array</span></dt><dd><p>covariance of estimate for state at time t given observations from
times [1…t]</p>
</dd>
<dt>observation<span class="classifier">[n_dim_obs] array or None</span></dt><dd><p>observation from time t+1.  If <cite>observation</cite> is a masked array and
any of <cite>observation</cite>’s components are masked or if <cite>observation</cite> is
None, then <cite>observation</cite> will be treated as a missing observation.</p>
</dd>
<dt>transition_matrix<span class="classifier">optional, [n_dim_state, n_dim_state] array</span></dt><dd><p>state transition matrix from time t to t+1.  If unspecified,
<cite>self.transition_matrices</cite> will be used.</p>
</dd>
<dt>transition_offset<span class="classifier">optional, [n_dim_state] array</span></dt><dd><p>state offset for transition from time t to t+1.  If unspecified,
<cite>self.transition_offset</cite> will be used.</p>
</dd>
<dt>transition_covariance<span class="classifier">optional, [n_dim_state, n_dim_state] array</span></dt><dd><p>state transition covariance from time t to t+1.  If unspecified,
<cite>self.transition_covariance</cite> will be used.</p>
</dd>
<dt>observation_matrix<span class="classifier">optional, [n_dim_obs, n_dim_state] array</span></dt><dd><p>observation matrix at time t+1.  If unspecified,
<cite>self.observation_matrices</cite> will be used.</p>
</dd>
<dt>observation_offset<span class="classifier">optional, [n_dim_obs] array</span></dt><dd><p>observation offset at time t+1.  If unspecified,
<cite>self.observation_offset</cite> will be used.</p>
</dd>
<dt>observation_covariance<span class="classifier">optional, [n_dim_obs, n_dim_obs] array</span></dt><dd><p>observation covariance at time t+1.  If unspecified,
<cite>self.observation_covariance</cite> will be used.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><dl class="simple">
<dt>next_filtered_state_mean<span class="classifier">[n_dim_state] array</span></dt><dd><p>mean estimate for state at time t+1 given observations from times
[1…t+1]</p>
</dd>
<dt>next_filtered_state_covariance<span class="classifier">[n_dim_state, n_dim_state] array</span></dt><dd><p>covariance of estimate for state at time t+1 given observations
from times [1…t+1]</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="snowdrop.src.numeric.filters.py_kalman.MyBiermanKalmanFilter.index">
<span class="sig-name descname"><span class="pre">index</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#snowdrop.src.numeric.filters.py_kalman.MyBiermanKalmanFilter.index" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="snowdrop.src.numeric.filters.py_kalman.MyCholeskyKalmanFilter">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">snowdrop.src.numeric.filters.py_kalman.</span></span><span class="sig-name descname"><span class="pre">MyCholeskyKalmanFilter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">transition_matrices</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">observation_matrices</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transition_covariance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">observation_covariance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transition_offsets</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">observation_offsets</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_state_mean</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_state_covariance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">em_vars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['transition_covariance',</span> <span class="pre">'observation_covariance',</span> <span class="pre">'initial_state_mean',</span> <span class="pre">'initial_state_covariance']</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_dim_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_dim_obs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/snowdrop/src/numeric/filters/py_kalman.html#MyCholeskyKalmanFilter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#snowdrop.src.numeric.filters.py_kalman.MyCholeskyKalmanFilter" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">CholeskyKalmanFilter</span></code></p>
<p>This module implements the Kalman Filter in “Square Root” form (Cholesky factorization).</p>
<dl class="py method">
<dt class="sig sig-object py" id="snowdrop.src.numeric.filters.py_kalman.MyCholeskyKalmanFilter.filter_update">
<span class="sig-name descname"><span class="pre">filter_update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filtered_state_mean</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filtered_state_covariance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">observation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transition_matrix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transition_offset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transition_covariance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">observation_matrix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">observation_offset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">observation_covariance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/snowdrop/src/numeric/filters/py_kalman.html#MyCholeskyKalmanFilter.filter_update"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#snowdrop.src.numeric.filters.py_kalman.MyCholeskyKalmanFilter.filter_update" title="Link to this definition">¶</a></dt>
<dd><p>Update a Kalman Filter state estimate.</p>
<p>Perform a one-step update to estimate the state at time <span class="math notranslate nohighlight">\(t+1\)</span>
give an observation at time <span class="math notranslate nohighlight">\(t+1\)</span> and the previous estimate for
time <span class="math notranslate nohighlight">\(t\)</span> given observations from times <span class="math notranslate nohighlight">\([0...t]\)</span>.  This
method is useful if one wants to track an object with streaming
observations.</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>filtered_state_mean<span class="classifier">[n_dim_state] array</span></dt><dd><p>mean estimate for state at time t given observations from times
[1…t]</p>
</dd>
<dt>filtered_state_covariance<span class="classifier">[n_dim_state, n_dim_state] array</span></dt><dd><p>covariance of estimate for state at time t given observations from
times [1…t]</p>
</dd>
<dt>observation<span class="classifier">[n_dim_obs] array or None</span></dt><dd><p>observation from time t+1.  If <cite>observation</cite> is a masked array and
any of <cite>observation</cite>’s components are masked or if <cite>observation</cite> is
None, then <cite>observation</cite> will be treated as a missing observation.</p>
</dd>
<dt>transition_matrix<span class="classifier">optional, [n_dim_state, n_dim_state] array</span></dt><dd><p>state transition matrix from time t to t+1.  If unspecified,
<cite>self.transition_matrices</cite> will be used.</p>
</dd>
<dt>transition_offset<span class="classifier">optional, [n_dim_state] array</span></dt><dd><p>state offset for transition from time t to t+1.  If unspecified,
<cite>self.transition_offset</cite> will be used.</p>
</dd>
<dt>transition_covariance<span class="classifier">optional, [n_dim_state, n_dim_state] array</span></dt><dd><p>state transition covariance from time t to t+1.  If unspecified,
<cite>self.transition_covariance</cite> will be used.</p>
</dd>
<dt>observation_matrix<span class="classifier">optional, [n_dim_obs, n_dim_state] array</span></dt><dd><p>observation matrix at time t+1.  If unspecified,
<cite>self.observation_matrices</cite> will be used.</p>
</dd>
<dt>observation_offset<span class="classifier">optional, [n_dim_obs] array</span></dt><dd><p>observation offset at time t+1.  If unspecified,
<cite>self.observation_offset</cite> will be used.</p>
</dd>
<dt>observation_covariance<span class="classifier">optional, [n_dim_obs, n_dim_obs] array</span></dt><dd><p>observation covariance at time t+1.  If unspecified,
<cite>self.observation_covariance</cite> will be used.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><dl class="simple">
<dt>next_filtered_state_mean<span class="classifier">[n_dim_state] array</span></dt><dd><p>mean estimate for state at time t+1 given observations from times
[1…t+1]</p>
</dd>
<dt>next_filtered_state_covariance<span class="classifier">[n_dim_state, n_dim_state] array</span></dt><dd><p>covariance of estimate for state at time t+1 given observations
from times [1…t+1]</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="snowdrop.src.numeric.filters.py_kalman.MyCholeskyKalmanFilter.index">
<span class="sig-name descname"><span class="pre">index</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#snowdrop.src.numeric.filters.py_kalman.MyCholeskyKalmanFilter.index" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="snowdrop.src.numeric.filters.py_kalman.MyKalmanFilter">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">snowdrop.src.numeric.filters.py_kalman.</span></span><span class="sig-name descname"><span class="pre">MyKalmanFilter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">transition_matrices</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">observation_matrices</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transition_covariance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">observation_covariance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transition_offsets</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">observation_offsets</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_state_mean</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_state_covariance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">em_vars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['transition_covariance',</span> <span class="pre">'observation_covariance',</span> <span class="pre">'initial_state_mean',</span> <span class="pre">'initial_state_covariance']</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_dim_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_dim_obs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/snowdrop/src/numeric/filters/py_kalman.html#MyKalmanFilter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#snowdrop.src.numeric.filters.py_kalman.MyKalmanFilter" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">KalmanFilter</span></code></p>
<p>This module implements Kalman Filter.</p>
<dl class="py method">
<dt class="sig sig-object py" id="snowdrop.src.numeric.filters.py_kalman.MyKalmanFilter.filter_update">
<span class="sig-name descname"><span class="pre">filter_update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filtered_state_mean</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filtered_state_covariance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">observation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transition_matrix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transition_offset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transition_covariance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">observation_matrix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">observation_offset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">observation_covariance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/snowdrop/src/numeric/filters/py_kalman.html#MyKalmanFilter.filter_update"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#snowdrop.src.numeric.filters.py_kalman.MyKalmanFilter.filter_update" title="Link to this definition">¶</a></dt>
<dd><p>Update a Kalman Filter state estimate.</p>
<p>Perform a one-step update to estimate the state at time <span class="math notranslate nohighlight">\(t+1\)</span>
give an observation at time <span class="math notranslate nohighlight">\(t+1\)</span> and the previous estimate for
time <span class="math notranslate nohighlight">\(t\)</span> given observations from times <span class="math notranslate nohighlight">\([0...t]\)</span>.  This
method is useful if one wants to track an object with streaming
observations.</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>filtered_state_mean<span class="classifier">[n_dim_state] array</span></dt><dd><p>mean estimate for state at time t given observations from times
[1…t]</p>
</dd>
<dt>filtered_state_covariance<span class="classifier">[n_dim_state, n_dim_state] array</span></dt><dd><p>covariance of estimate for state at time t given observations from
times [1…t]</p>
</dd>
<dt>observation<span class="classifier">[n_dim_obs] array or None</span></dt><dd><p>observation from time t+1.  If <cite>observation</cite> is a masked array and
any of <cite>observation</cite>’s components are masked or if <cite>observation</cite> is
None, then <cite>observation</cite> will be treated as a missing observation.</p>
</dd>
<dt>transition_matrix<span class="classifier">optional, [n_dim_state, n_dim_state] array</span></dt><dd><p>state transition matrix from time t to t+1.  If unspecified,
<cite>self.transition_matrices</cite> will be used.</p>
</dd>
<dt>transition_offset<span class="classifier">optional, [n_dim_state] array</span></dt><dd><p>state offset for transition from time t to t+1.  If unspecified,
<cite>self.transition_offset</cite> will be used.</p>
</dd>
<dt>transition_covariance<span class="classifier">optional, [n_dim_state, n_dim_state] array</span></dt><dd><p>state transition covariance from time t to t+1.  If unspecified,
<cite>self.transition_covariance</cite> will be used.</p>
</dd>
<dt>observation_matrix<span class="classifier">optional, [n_dim_obs, n_dim_state] array</span></dt><dd><p>observation matrix at time t+1.  If unspecified,
<cite>self.observation_matrices</cite> will be used.</p>
</dd>
<dt>observation_offset<span class="classifier">optional, [n_dim_obs] array</span></dt><dd><p>observation offset at time t+1.  If unspecified,
<cite>self.observation_offset</cite> will be used.</p>
</dd>
<dt>observation_covariance<span class="classifier">optional, [n_dim_obs, n_dim_obs] array</span></dt><dd><p>observation covariance at time t+1.  If unspecified,
<cite>self.observation_covariance</cite> will be used.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><dl class="simple">
<dt>next_filtered_state_mean<span class="classifier">[n_dim_state] array</span></dt><dd><p>mean estimate for state at time t+1 given observations from times
[1…t+1]</p>
</dd>
<dt>next_filtered_state_covariance<span class="classifier">[n_dim_state, n_dim_state] array</span></dt><dd><p>covariance of estimate for state at time t+1 given observations
from times [1…t+1]</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="snowdrop.src.numeric.filters.py_kalman.MyKalmanFilter.index">
<span class="sig-name descname"><span class="pre">index</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#snowdrop.src.numeric.filters.py_kalman.MyKalmanFilter.index" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="snowdrop.src.numeric.filters.py_kalman.MyUnscentedKalmanFilter">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">snowdrop.src.numeric.filters.py_kalman.</span></span><span class="sig-name descname"><span class="pre">MyUnscentedKalmanFilter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">transition_functions</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">observation_functions</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transition_covariance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">observation_covariance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_state_mean</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_state_covariance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_dim_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_dim_obs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/snowdrop/src/numeric/filters/py_kalman.html#MyUnscentedKalmanFilter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#snowdrop.src.numeric.filters.py_kalman.MyUnscentedKalmanFilter" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">UnscentedKalmanFilter</span></code></p>
<p>This module contains “Square Root” implementations to the Unscented Kalman
Filter.  Square Root implementations typically propagate the mean and Cholesky
factorization of the covariance matrix in order to prevent numerical error.
When possible, Square Root implementations should be preferred to their
standard counterparts.</p>
<p>References:</p>
<ul class="simple">
<li><p>Terejanu, G.A. Towards a Decision-Centric Framework for Uncertainty
Propagation and Data Assimilation. 2010. Page 108.</p></li>
<li><p>Van Der Merwe, R. and Wan, E.A. The Square-Root Unscented Kalman Filter for
State and Parameter-Estimation. 2001.</p></li>
</ul>
<dl class="py method">
<dt class="sig sig-object py" id="snowdrop.src.numeric.filters.py_kalman.MyUnscentedKalmanFilter.filter_update">
<span class="sig-name descname"><span class="pre">filter_update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filtered_state_mean</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filtered_state_covariance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">observation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transition_function</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transition_covariance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">observation_function</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">observation_covariance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/snowdrop/src/numeric/filters/py_kalman.html#MyUnscentedKalmanFilter.filter_update"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#snowdrop.src.numeric.filters.py_kalman.MyUnscentedKalmanFilter.filter_update" title="Link to this definition">¶</a></dt>
<dd><p>Update a Kalman Filter state estimate</p>
<p>Perform a one-step update to estimate the state at time <span class="math notranslate nohighlight">\(t+1\)</span>
give an observation at time <span class="math notranslate nohighlight">\(t+1\)</span> and the previous estimate for
time <span class="math notranslate nohighlight">\(t\)</span> given observations from times <span class="math notranslate nohighlight">\([0...t]\)</span>.  This
method is useful if one wants to track an object with streaming
observations.</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>filtered_state_mean<span class="classifier">[n_dim_state] array</span></dt><dd><p>mean estimate for state at time t given observations from times
[1…t]</p>
</dd>
<dt>filtered_state_covariance<span class="classifier">[n_dim_state, n_dim_state] array</span></dt><dd><p>covariance of estimate for state at time t given observations from
times [1…t]</p>
</dd>
<dt>observation<span class="classifier">[n_dim_obs] array or None</span></dt><dd><p>observation from time t+1.  If <cite>observation</cite> is a masked array and
any of <cite>observation</cite>’s components are masked or if <cite>observation</cite> is
None, then <cite>observation</cite> will be treated as a missing observation.</p>
</dd>
<dt>transition_function<span class="classifier">optional, function</span></dt><dd><p>state transition function from time t to t+1.  If unspecified,
<cite>self.transition_functions</cite> will be used.</p>
</dd>
<dt>transition_covariance<span class="classifier">optional, [n_dim_state, n_dim_state] array</span></dt><dd><p>state transition covariance from time t to t+1.  If unspecified,
<cite>self.transition_covariance</cite> will be used.</p>
</dd>
<dt>observation_function<span class="classifier">optional, function</span></dt><dd><p>observation function at time t+1.  If unspecified,
<cite>self.observation_functions</cite> will be used.</p>
</dd>
<dt>observation_covariance<span class="classifier">optional, [n_dim_obs, n_dim_obs] array</span></dt><dd><p>observation covariance at time t+1.  If unspecified,
<cite>self.observation_covariance</cite> will be used.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><dl class="simple">
<dt>next_filtered_state_mean<span class="classifier">[n_dim_state] array</span></dt><dd><p>mean estimate for state at time t+1 given observations from times
[1…t+1]</p>
</dd>
<dt>next_filtered_state_covariance<span class="classifier">[n_dim_state, n_dim_state] array</span></dt><dd><p>covariance of estimate for state at time t+1 given observations
from times [1…t+1]</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="snowdrop.src.numeric.filters.py_kalman.MyUnscentedKalmanFilter.index">
<span class="sig-name descname"><span class="pre">index</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#snowdrop.src.numeric.filters.py_kalman.MyUnscentedKalmanFilter.index" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="snowdrop.src.numeric.filters.py_kalman.MyUnscentedKalmanFilter.unscented_filter_correct">
<span class="sig-name descname"><span class="pre">unscented_filter_correct</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">observation_function</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">moments_pred</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">points_pred</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">observation</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">points_observation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma2_observation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/snowdrop/src/numeric/filters/py_kalman.html#MyUnscentedKalmanFilter.unscented_filter_correct"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#snowdrop.src.numeric.filters.py_kalman.MyUnscentedKalmanFilter.unscented_filter_correct" title="Link to this definition">¶</a></dt>
<dd><p>Integrate new observation to correct state estimates</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>observation_function<span class="classifier">function</span></dt><dd><p>function characterizing how the observation at time t+1 is generated</p>
</dd>
<dt>moments_pred<span class="classifier">[n_dim_state] Moments</span></dt><dd><p>mean and covariance of state at time t+1 given observations from time
steps 0…t</p>
</dd>
<dt>points_pred<span class="classifier">[2*n_dim_state+1, n_dim_state] SigmaPoints</span></dt><dd><p>sigma points corresponding to moments_pred</p>
</dd>
<dt>observation<span class="classifier">[n_dim_state] array</span></dt><dd><p>observation at time t+1. If masked, treated as missing.</p>
</dd>
<dt>points_observation<span class="classifier">[2*n_dim_state, n_dim_obs] SigmaPoints</span></dt><dd><p>sigma points corresponding to predicted observation at time t+1 given
observations from times 0…t, if available. If not, noise is assumed
to be additive.</p>
</dd>
<dt>sigma_observation<span class="classifier">[n_dim_obs, n_dim_obs] array</span></dt><dd><p>covariance matrix corresponding to additive noise in observation at
time t+1, if available. If missing, noise is assumed to be non-linear.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>moments_filt : [n_dim_state] Moments
mean and covariance of state at time t+1 given observations from time steps 0…t+1</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-snowdrop.src.numeric.filters.pykalman">
<span id="snowdrop-src-numeric-filters-pykalman-module"></span><h2>snowdrop.src.numeric.filters.pykalman module<a class="headerlink" href="#module-snowdrop.src.numeric.filters.pykalman" title="Link to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="snowdrop.src.numeric.filters.pykalman.MyBiermanKalmanFilter">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">snowdrop.src.numeric.filters.pykalman.</span></span><span class="sig-name descname"><span class="pre">MyBiermanKalmanFilter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">transition_matrices</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">observation_matrices</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transition_covariance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">observation_covariance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transition_offsets</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">observation_offsets</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_state_mean</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_state_covariance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">em_vars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['transition_covariance',</span> <span class="pre">'observation_covariance',</span> <span class="pre">'initial_state_mean',</span> <span class="pre">'initial_state_covariance']</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_dim_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_dim_obs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/snowdrop/src/numeric/filters/pykalman.html#MyBiermanKalmanFilter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#snowdrop.src.numeric.filters.pykalman.MyBiermanKalmanFilter" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">BiermanKalmanFilter</span></code></p>
<p>This module implements Bierman’s version of the Kalman Filter.  In particular,
the UDU’ decomposition of the covariance matrix is used instead of the full
matrix, where U is upper triangular and D is diagonal.</p>
<dl class="py method">
<dt class="sig sig-object py" id="snowdrop.src.numeric.filters.pykalman.MyBiermanKalmanFilter.filter_update">
<span class="sig-name descname"><span class="pre">filter_update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filtered_state_mean</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filtered_state_covariance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">observation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transition_matrix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transition_offset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transition_covariance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">observation_matrix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">observation_offset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">observation_covariance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/snowdrop/src/numeric/filters/pykalman.html#MyBiermanKalmanFilter.filter_update"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#snowdrop.src.numeric.filters.pykalman.MyBiermanKalmanFilter.filter_update" title="Link to this definition">¶</a></dt>
<dd><p>Update a Kalman Filter state estimate</p>
<p>Perform a one-step update to estimate the state at time <span class="math notranslate nohighlight">\(t+1\)</span>
give an observation at time <span class="math notranslate nohighlight">\(t+1\)</span> and the previous estimate for
time <span class="math notranslate nohighlight">\(t\)</span> given observations from times <span class="math notranslate nohighlight">\([0...t]\)</span>.  This
method is useful if one wants to track an object with streaming
observations.</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>filtered_state_mean<span class="classifier">[n_dim_state] array</span></dt><dd><p>mean estimate for state at time t given observations from times
[1…t]</p>
</dd>
<dt>filtered_state_covariance<span class="classifier">[n_dim_state, n_dim_state] array</span></dt><dd><p>covariance of estimate for state at time t given observations from
times [1…t]</p>
</dd>
<dt>observation<span class="classifier">[n_dim_obs] array or None</span></dt><dd><p>observation from time t+1.  If <cite>observation</cite> is a masked array and
any of <cite>observation</cite>’s components are masked or if <cite>observation</cite> is
None, then <cite>observation</cite> will be treated as a missing observation.</p>
</dd>
<dt>transition_matrix<span class="classifier">optional, [n_dim_state, n_dim_state] array</span></dt><dd><p>state transition matrix from time t to t+1.  If unspecified,
<cite>self.transition_matrices</cite> will be used.</p>
</dd>
<dt>transition_offset<span class="classifier">optional, [n_dim_state] array</span></dt><dd><p>state offset for transition from time t to t+1.  If unspecified,
<cite>self.transition_offset</cite> will be used.</p>
</dd>
<dt>transition_covariance<span class="classifier">optional, [n_dim_state, n_dim_state] array</span></dt><dd><p>state transition covariance from time t to t+1.  If unspecified,
<cite>self.transition_covariance</cite> will be used.</p>
</dd>
<dt>observation_matrix<span class="classifier">optional, [n_dim_obs, n_dim_state] array</span></dt><dd><p>observation matrix at time t+1.  If unspecified,
<cite>self.observation_matrices</cite> will be used.</p>
</dd>
<dt>observation_offset<span class="classifier">optional, [n_dim_obs] array</span></dt><dd><p>observation offset at time t+1.  If unspecified,
<cite>self.observation_offset</cite> will be used.</p>
</dd>
<dt>observation_covariance<span class="classifier">optional, [n_dim_obs, n_dim_obs] array</span></dt><dd><p>observation covariance at time t+1.  If unspecified,
<cite>self.observation_covariance</cite> will be used.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><dl class="simple">
<dt>next_filtered_state_mean<span class="classifier">[n_dim_state] array</span></dt><dd><p>mean estimate for state at time t+1 given observations from times
[1…t+1]</p>
</dd>
<dt>next_filtered_state_covariance<span class="classifier">[n_dim_state, n_dim_state] array</span></dt><dd><p>covariance of estimate for state at time t+1 given observations
from times [1…t+1]</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="snowdrop.src.numeric.filters.pykalman.MyBiermanKalmanFilter.index">
<span class="sig-name descname"><span class="pre">index</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#snowdrop.src.numeric.filters.pykalman.MyBiermanKalmanFilter.index" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="snowdrop.src.numeric.filters.pykalman.MyCholeskyKalmanFilter">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">snowdrop.src.numeric.filters.pykalman.</span></span><span class="sig-name descname"><span class="pre">MyCholeskyKalmanFilter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">transition_matrices</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">observation_matrices</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transition_covariance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">observation_covariance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transition_offsets</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">observation_offsets</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_state_mean</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_state_covariance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">em_vars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['transition_covariance',</span> <span class="pre">'observation_covariance',</span> <span class="pre">'initial_state_mean',</span> <span class="pre">'initial_state_covariance']</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_dim_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_dim_obs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/snowdrop/src/numeric/filters/pykalman.html#MyCholeskyKalmanFilter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#snowdrop.src.numeric.filters.pykalman.MyCholeskyKalmanFilter" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">CholeskyKalmanFilter</span></code></p>
<p>This module implements the Kalman Filter in “Square Root” form (Cholesky factorization).</p>
<dl class="py method">
<dt class="sig sig-object py" id="snowdrop.src.numeric.filters.pykalman.MyCholeskyKalmanFilter.filter_update">
<span class="sig-name descname"><span class="pre">filter_update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filtered_state_mean</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filtered_state_covariance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">observation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transition_matrix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transition_offset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transition_covariance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">observation_matrix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">observation_offset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">observation_covariance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/snowdrop/src/numeric/filters/pykalman.html#MyCholeskyKalmanFilter.filter_update"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#snowdrop.src.numeric.filters.pykalman.MyCholeskyKalmanFilter.filter_update" title="Link to this definition">¶</a></dt>
<dd><p>Update a Kalman Filter state estimate.</p>
<p>Perform a one-step update to estimate the state at time <span class="math notranslate nohighlight">\(t+1\)</span>
give an observation at time <span class="math notranslate nohighlight">\(t+1\)</span> and the previous estimate for
time <span class="math notranslate nohighlight">\(t\)</span> given observations from times <span class="math notranslate nohighlight">\([0...t]\)</span>.  This
method is useful if one wants to track an object with streaming
observations.</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>filtered_state_mean<span class="classifier">[n_dim_state] array</span></dt><dd><p>mean estimate for state at time t given observations from times
[1…t]</p>
</dd>
<dt>filtered_state_covariance<span class="classifier">[n_dim_state, n_dim_state] array</span></dt><dd><p>covariance of estimate for state at time t given observations from
times [1…t]</p>
</dd>
<dt>observation<span class="classifier">[n_dim_obs] array or None</span></dt><dd><p>observation from time t+1.  If <cite>observation</cite> is a masked array and
any of <cite>observation</cite>’s components are masked or if <cite>observation</cite> is
None, then <cite>observation</cite> will be treated as a missing observation.</p>
</dd>
<dt>transition_matrix<span class="classifier">optional, [n_dim_state, n_dim_state] array</span></dt><dd><p>state transition matrix from time t to t+1.  If unspecified,
<cite>self.transition_matrices</cite> will be used.</p>
</dd>
<dt>transition_offset<span class="classifier">optional, [n_dim_state] array</span></dt><dd><p>state offset for transition from time t to t+1.  If unspecified,
<cite>self.transition_offset</cite> will be used.</p>
</dd>
<dt>transition_covariance<span class="classifier">optional, [n_dim_state, n_dim_state] array</span></dt><dd><p>state transition covariance from time t to t+1.  If unspecified,
<cite>self.transition_covariance</cite> will be used.</p>
</dd>
<dt>observation_matrix<span class="classifier">optional, [n_dim_obs, n_dim_state] array</span></dt><dd><p>observation matrix at time t+1.  If unspecified,
<cite>self.observation_matrices</cite> will be used.</p>
</dd>
<dt>observation_offset<span class="classifier">optional, [n_dim_obs] array</span></dt><dd><p>observation offset at time t+1.  If unspecified,
<cite>self.observation_offset</cite> will be used.</p>
</dd>
<dt>observation_covariance<span class="classifier">optional, [n_dim_obs, n_dim_obs] array</span></dt><dd><p>observation covariance at time t+1.  If unspecified,
<cite>self.observation_covariance</cite> will be used.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><dl class="simple">
<dt>next_filtered_state_mean<span class="classifier">[n_dim_state] array</span></dt><dd><p>mean estimate for state at time t+1 given observations from times
[1…t+1]</p>
</dd>
<dt>next_filtered_state_covariance<span class="classifier">[n_dim_state, n_dim_state] array</span></dt><dd><p>covariance of estimate for state at time t+1 given observations
from times [1…t+1]</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="snowdrop.src.numeric.filters.pykalman.MyCholeskyKalmanFilter.index">
<span class="sig-name descname"><span class="pre">index</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#snowdrop.src.numeric.filters.pykalman.MyCholeskyKalmanFilter.index" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="snowdrop.src.numeric.filters.pykalman.MyKalmanFilter">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">snowdrop.src.numeric.filters.pykalman.</span></span><span class="sig-name descname"><span class="pre">MyKalmanFilter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">transition_matrices</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">observation_matrices</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transition_covariance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">observation_covariance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transition_offsets</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">observation_offsets</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_state_mean</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_state_covariance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">em_vars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['transition_covariance',</span> <span class="pre">'observation_covariance',</span> <span class="pre">'initial_state_mean',</span> <span class="pre">'initial_state_covariance']</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_dim_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_dim_obs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/snowdrop/src/numeric/filters/pykalman.html#MyKalmanFilter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#snowdrop.src.numeric.filters.pykalman.MyKalmanFilter" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">KalmanFilter</span></code></p>
<p>This module implements Kalman Filter.</p>
<dl class="py method">
<dt class="sig sig-object py" id="snowdrop.src.numeric.filters.pykalman.MyKalmanFilter.filter_update">
<span class="sig-name descname"><span class="pre">filter_update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filtered_state_mean</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filtered_state_covariance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">observation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transition_matrix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transition_offset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transition_covariance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">observation_matrix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">observation_offset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">observation_covariance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/snowdrop/src/numeric/filters/pykalman.html#MyKalmanFilter.filter_update"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#snowdrop.src.numeric.filters.pykalman.MyKalmanFilter.filter_update" title="Link to this definition">¶</a></dt>
<dd><p>Update a Kalman Filter state estimate.</p>
<p>Perform a one-step update to estimate the state at time <span class="math notranslate nohighlight">\(t+1\)</span>
give an observation at time <span class="math notranslate nohighlight">\(t+1\)</span> and the previous estimate for
time <span class="math notranslate nohighlight">\(t\)</span> given observations from times <span class="math notranslate nohighlight">\([0...t]\)</span>.  This
method is useful if one wants to track an object with streaming
observations.</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>filtered_state_mean<span class="classifier">[n_dim_state] array</span></dt><dd><p>mean estimate for state at time t given observations from times
[1…t]</p>
</dd>
<dt>filtered_state_covariance<span class="classifier">[n_dim_state, n_dim_state] array</span></dt><dd><p>covariance of estimate for state at time t given observations from
times [1…t]</p>
</dd>
<dt>observation<span class="classifier">[n_dim_obs] array or None</span></dt><dd><p>observation from time t+1.  If <cite>observation</cite> is a masked array and
any of <cite>observation</cite>’s components are masked or if <cite>observation</cite> is
None, then <cite>observation</cite> will be treated as a missing observation.</p>
</dd>
<dt>transition_matrix<span class="classifier">optional, [n_dim_state, n_dim_state] array</span></dt><dd><p>state transition matrix from time t to t+1.  If unspecified,
<cite>self.transition_matrices</cite> will be used.</p>
</dd>
<dt>transition_offset<span class="classifier">optional, [n_dim_state] array</span></dt><dd><p>state offset for transition from time t to t+1.  If unspecified,
<cite>self.transition_offset</cite> will be used.</p>
</dd>
<dt>transition_covariance<span class="classifier">optional, [n_dim_state, n_dim_state] array</span></dt><dd><p>state transition covariance from time t to t+1.  If unspecified,
<cite>self.transition_covariance</cite> will be used.</p>
</dd>
<dt>observation_matrix<span class="classifier">optional, [n_dim_obs, n_dim_state] array</span></dt><dd><p>observation matrix at time t+1.  If unspecified,
<cite>self.observation_matrices</cite> will be used.</p>
</dd>
<dt>observation_offset<span class="classifier">optional, [n_dim_obs] array</span></dt><dd><p>observation offset at time t+1.  If unspecified,
<cite>self.observation_offset</cite> will be used.</p>
</dd>
<dt>observation_covariance<span class="classifier">optional, [n_dim_obs, n_dim_obs] array</span></dt><dd><p>observation covariance at time t+1.  If unspecified,
<cite>self.observation_covariance</cite> will be used.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><dl class="simple">
<dt>next_filtered_state_mean<span class="classifier">[n_dim_state] array</span></dt><dd><p>mean estimate for state at time t+1 given observations from times
[1…t+1]</p>
</dd>
<dt>next_filtered_state_covariance<span class="classifier">[n_dim_state, n_dim_state] array</span></dt><dd><p>covariance of estimate for state at time t+1 given observations
from times [1…t+1]</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="snowdrop.src.numeric.filters.pykalman.MyKalmanFilter.index">
<span class="sig-name descname"><span class="pre">index</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#snowdrop.src.numeric.filters.pykalman.MyKalmanFilter.index" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="snowdrop.src.numeric.filters.pykalman.MyUnscentedKalmanFilter">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">snowdrop.src.numeric.filters.pykalman.</span></span><span class="sig-name descname"><span class="pre">MyUnscentedKalmanFilter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">transition_functions</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">observation_functions</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transition_covariance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">observation_covariance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_state_mean</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_state_covariance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_dim_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_dim_obs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/snowdrop/src/numeric/filters/pykalman.html#MyUnscentedKalmanFilter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#snowdrop.src.numeric.filters.pykalman.MyUnscentedKalmanFilter" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">UnscentedKalmanFilter</span></code></p>
<p>This module contains “Square Root” implementations to the Unscented Kalman
Filter.  Square Root implementations typically propagate the mean and Cholesky
factorization of the covariance matrix in order to prevent numerical error.
When possible, Square Root implementations should be preferred to their
standard counterparts.</p>
<p>References:</p>
<ul class="simple">
<li><p>Terejanu, G.A. Towards a Decision-Centric Framework for Uncertainty
Propagation and Data Assimilation. 2010. Page 108.</p></li>
<li><p>Van Der Merwe, R. and Wan, E.A. The Square-Root Unscented Kalman Filter for
State and Parameter-Estimation. 2001.</p></li>
</ul>
<dl class="py method">
<dt class="sig sig-object py" id="snowdrop.src.numeric.filters.pykalman.MyUnscentedKalmanFilter.filter_update">
<span class="sig-name descname"><span class="pre">filter_update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filtered_state_mean</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filtered_state_covariance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">observation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transition_function</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transition_covariance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">observation_function</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">observation_covariance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/snowdrop/src/numeric/filters/pykalman.html#MyUnscentedKalmanFilter.filter_update"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#snowdrop.src.numeric.filters.pykalman.MyUnscentedKalmanFilter.filter_update" title="Link to this definition">¶</a></dt>
<dd><p>Update a Kalman Filter state estimate</p>
<p>Perform a one-step update to estimate the state at time <span class="math notranslate nohighlight">\(t+1\)</span>
give an observation at time <span class="math notranslate nohighlight">\(t+1\)</span> and the previous estimate for
time <span class="math notranslate nohighlight">\(t\)</span> given observations from times <span class="math notranslate nohighlight">\([0...t]\)</span>.  This
method is useful if one wants to track an object with streaming
observations.</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>filtered_state_mean<span class="classifier">[n_dim_state] array</span></dt><dd><p>mean estimate for state at time t given observations from times
[1…t]</p>
</dd>
<dt>filtered_state_covariance<span class="classifier">[n_dim_state, n_dim_state] array</span></dt><dd><p>covariance of estimate for state at time t given observations from
times [1…t]</p>
</dd>
<dt>observation<span class="classifier">[n_dim_obs] array or None</span></dt><dd><p>observation from time t+1.  If <cite>observation</cite> is a masked array and
any of <cite>observation</cite>’s components are masked or if <cite>observation</cite> is
None, then <cite>observation</cite> will be treated as a missing observation.</p>
</dd>
<dt>transition_function<span class="classifier">optional, function</span></dt><dd><p>state transition function from time t to t+1.  If unspecified,
<cite>self.transition_functions</cite> will be used.</p>
</dd>
<dt>transition_covariance<span class="classifier">optional, [n_dim_state, n_dim_state] array</span></dt><dd><p>state transition covariance from time t to t+1.  If unspecified,
<cite>self.transition_covariance</cite> will be used.</p>
</dd>
<dt>observation_function<span class="classifier">optional, function</span></dt><dd><p>observation function at time t+1.  If unspecified,
<cite>self.observation_functions</cite> will be used.</p>
</dd>
<dt>observation_covariance<span class="classifier">optional, [n_dim_obs, n_dim_obs] array</span></dt><dd><p>observation covariance at time t+1.  If unspecified,
<cite>self.observation_covariance</cite> will be used.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><dl class="simple">
<dt>next_filtered_state_mean<span class="classifier">[n_dim_state] array</span></dt><dd><p>mean estimate for state at time t+1 given observations from times
[1…t+1]</p>
</dd>
<dt>next_filtered_state_covariance<span class="classifier">[n_dim_state, n_dim_state] array</span></dt><dd><p>covariance of estimate for state at time t+1 given observations
from times [1…t+1]</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="snowdrop.src.numeric.filters.pykalman.MyUnscentedKalmanFilter.index">
<span class="sig-name descname"><span class="pre">index</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#snowdrop.src.numeric.filters.pykalman.MyUnscentedKalmanFilter.index" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="snowdrop.src.numeric.filters.pykalman.MyUnscentedKalmanFilter.unscented_filter_correct">
<span class="sig-name descname"><span class="pre">unscented_filter_correct</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">observation_function</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">moments_pred</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">points_pred</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">observation</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">points_observation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma2_observation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/snowdrop/src/numeric/filters/pykalman.html#MyUnscentedKalmanFilter.unscented_filter_correct"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#snowdrop.src.numeric.filters.pykalman.MyUnscentedKalmanFilter.unscented_filter_correct" title="Link to this definition">¶</a></dt>
<dd><p>Integrate new observation to correct state estimates</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>observation_function<span class="classifier">function</span></dt><dd><p>function characterizing how the observation at time t+1 is generated</p>
</dd>
<dt>moments_pred<span class="classifier">[n_dim_state] Moments</span></dt><dd><p>mean and covariance of state at time t+1 given observations from time
steps 0…t</p>
</dd>
<dt>points_pred<span class="classifier">[2*n_dim_state+1, n_dim_state] SigmaPoints</span></dt><dd><p>sigma points corresponding to moments_pred</p>
</dd>
<dt>observation<span class="classifier">[n_dim_state] array</span></dt><dd><p>observation at time t+1. If masked, treated as missing.</p>
</dd>
<dt>points_observation<span class="classifier">[2*n_dim_state, n_dim_obs] SigmaPoints</span></dt><dd><p>sigma points corresponding to predicted observation at time t+1 given
observations from times 0…t, if available. If not, noise is assumed
to be additive.</p>
</dd>
<dt>sigma_observation<span class="classifier">[n_dim_obs, n_dim_obs] array</span></dt><dd><p>covariance matrix corresponding to additive noise in observation at
time t+1, if available. If missing, noise is assumed to be non-linear.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>moments_filt : [n_dim_state] Moments
mean and covariance of state at time t+1 given observations from time steps 0…t+1</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-snowdrop.src.numeric.filters.unscented">
<span id="snowdrop-src-numeric-filters-unscented-module"></span><h2>snowdrop.src.numeric.filters.unscented module<a class="headerlink" href="#module-snowdrop.src.numeric.filters.unscented" title="Link to this heading">¶</a></h2>
<section id="inference-for-non-linear-gaussian-systems">
<h3>Inference for Non-Linear Gaussian Systems<a class="headerlink" href="#inference-for-non-linear-gaussian-systems" title="Link to this heading">¶</a></h3>
<p>This module contains the Unscented Kalman Filter (Wan, van der Merwe 2000)
for state estimation in systems with non-Gaussian noise and non-linear dynamics.</p>
</section>
<dl class="py class">
<dt class="sig sig-object py" id="snowdrop.src.numeric.filters.unscented.AdditiveUnscentedKalmanFilter">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">snowdrop.src.numeric.filters.unscented.</span></span><span class="sig-name descname"><span class="pre">AdditiveUnscentedKalmanFilter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">transition_functions</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">observation_functions</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transition_covariance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">observation_covariance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_state_mean</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_state_covariance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_dim_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_dim_obs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/snowdrop/src/numeric/filters/unscented.html#AdditiveUnscentedKalmanFilter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#snowdrop.src.numeric.filters.unscented.AdditiveUnscentedKalmanFilter" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#snowdrop.src.numeric.filters.unscented.UnscentedMixin" title="snowdrop.src.numeric.filters.unscented.UnscentedMixin"><code class="xref py py-class docutils literal notranslate"><span class="pre">UnscentedMixin</span></code></a></p>
<p>Implements the Unscented Kalman Filter with additive noise.
Observations are assumed to be generated from the following process,</p>
<div class="math notranslate nohighlight">
\[\begin{split}x_0       &amp;\sim \text{Normal}(\mu_0, \Sigma_0)  \\
x_{t+1}   &amp;=    f_t(x_t) + \text{Normal}(0, Q)  \\
z_{t}     &amp;=    g_t(x_t) + \text{Normal}(0, R)\end{split}\]</div>
<p>While less general the general-noise Unscented Kalman Filter, the Additive
version is more computationally efficient with complexity <span class="math notranslate nohighlight">\(O(Tn^3)\)</span>
where <span class="math notranslate nohighlight">\(T\)</span> is the number of time steps and <span class="math notranslate nohighlight">\(n\)</span> is the size of
the state space.</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>transition_functions<span class="classifier">function or [n_timesteps-1] array of functions</span></dt><dd><p>transition_functions[t] is a function of the state at time t and
produces the state at time t+1. Also known as <span class="math notranslate nohighlight">\(f_t\)</span>.</p>
</dd>
<dt>observation_functions<span class="classifier">function or [n_timesteps] array of functions</span></dt><dd><p>observation_functions[t] is a function of the state at time t and
produces the observation at time t. Also known as <span class="math notranslate nohighlight">\(g_t\)</span>.</p>
</dd>
<dt>transition_covariance<span class="classifier">[n_dim_state, n_dim_state] array</span></dt><dd><p>transition noise covariance matrix. Also known as <span class="math notranslate nohighlight">\(Q\)</span>.</p>
</dd>
<dt>observation_covariance<span class="classifier">[n_dim_obs, n_dim_obs] array</span></dt><dd><p>observation noise covariance matrix. Also known as <span class="math notranslate nohighlight">\(R\)</span>.</p>
</dd>
<dt>initial_state_mean<span class="classifier">[n_dim_state] array</span></dt><dd><p>mean of initial state distribution. Also known as <span class="math notranslate nohighlight">\(\mu_0\)</span>.</p>
</dd>
<dt>initial_state_covariance<span class="classifier">[n_dim_state, n_dim_state] array</span></dt><dd><p>covariance of initial state distribution. Also known as
<span class="math notranslate nohighlight">\(\Sigma_0\)</span>.</p>
</dd>
<dt>n_dim_state: optional, integer</dt><dd><p>the dimensionality of the state space. Only meaningful when you do not
specify initial values for <cite>transition_covariance</cite>, or
<cite>initial_state_mean</cite>, <cite>initial_state_covariance</cite>.</p>
</dd>
<dt>n_dim_obs: optional, integer</dt><dd><p>the dimensionality of the observation space. Only meaningful when you
do not specify initial values for <cite>observation_covariance</cite>.</p>
</dd>
<dt>random_state<span class="classifier">optional, int or RandomState</span></dt><dd><p>seed for random sample generation</p>
</dd>
</dl>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="snowdrop.src.numeric.filters.unscented.AdditiveUnscentedKalmanFilter.filter">
<span class="sig-name descname"><span class="pre">filter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Z</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/snowdrop/src/numeric/filters/unscented.html#AdditiveUnscentedKalmanFilter.filter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#snowdrop.src.numeric.filters.unscented.AdditiveUnscentedKalmanFilter.filter" title="Link to this definition">¶</a></dt>
<dd><p>Run Unscented Kalman Filter</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>Z<span class="classifier">[n_timesteps, n_dim_state] array</span></dt><dd><p>Z[t] = observation at time t.  If Z is a masked array and any of
Z[t]’s elements are masked, the observation is assumed missing and
ignored.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><dl class="simple">
<dt>filtered_state_means<span class="classifier">[n_timesteps, n_dim_state] array</span></dt><dd><p>filtered_state_means[t] = mean of state distribution at time t given
observations from times [0, t]</p>
</dd>
<dt>filtered_state_covariances<span class="classifier">[n_timesteps, n_dim_state, n_dim_state] array</span></dt><dd><p>filtered_state_covariances[t] = covariance of state distribution at
time t given observations from times [0, t]</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="snowdrop.src.numeric.filters.unscented.AdditiveUnscentedKalmanFilter.filter_update">
<span class="sig-name descname"><span class="pre">filter_update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filtered_state_mean</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filtered_state_covariance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">observation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transition_function</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transition_covariance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">observation_function</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">observation_covariance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/snowdrop/src/numeric/filters/unscented.html#AdditiveUnscentedKalmanFilter.filter_update"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#snowdrop.src.numeric.filters.unscented.AdditiveUnscentedKalmanFilter.filter_update" title="Link to this definition">¶</a></dt>
<dd><p>Update a Kalman Filter state estimate</p>
<p>Perform a one-step update to estimate the state at time <span class="math notranslate nohighlight">\(t+1\)</span>
give an observation at time <span class="math notranslate nohighlight">\(t+1\)</span> and the previous estimate for
time <span class="math notranslate nohighlight">\(t\)</span> given observations from times <span class="math notranslate nohighlight">\([0...t]\)</span>.  This
method is useful if one wants to track an object with streaming
observations.</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>filtered_state_mean<span class="classifier">[n_dim_state] array</span></dt><dd><p>mean estimate for state at time t given observations from times
[1…t]</p>
</dd>
<dt>filtered_state_covariance<span class="classifier">[n_dim_state, n_dim_state] array</span></dt><dd><p>covariance of estimate for state at time t given observations from
times [1…t]</p>
</dd>
<dt>observation<span class="classifier">[n_dim_obs] array or None</span></dt><dd><p>observation from time t+1.  If <cite>observation</cite> is a masked array and
any of <cite>observation</cite>’s components are masked or if <cite>observation</cite> is
None, then <cite>observation</cite> will be treated as a missing observation.</p>
</dd>
<dt>transition_function<span class="classifier">optional, function</span></dt><dd><p>state transition function from time t to t+1.  If unspecified,
<cite>self.transition_functions</cite> will be used.</p>
</dd>
<dt>transition_covariance<span class="classifier">optional, [n_dim_state, n_dim_state] array</span></dt><dd><p>state transition covariance from time t to t+1.  If unspecified,
<cite>self.transition_covariance</cite> will be used.</p>
</dd>
<dt>observation_function<span class="classifier">optional, function</span></dt><dd><p>observation function at time t+1.  If unspecified,
<cite>self.observation_functions</cite> will be used.</p>
</dd>
<dt>observation_covariance<span class="classifier">optional, [n_dim_obs, n_dim_obs] array</span></dt><dd><p>observation covariance at time t+1.  If unspecified,
<cite>self.observation_covariance</cite> will be used.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><dl class="simple">
<dt>next_filtered_state_mean<span class="classifier">[n_dim_state] array</span></dt><dd><p>mean estimate for state at time t+1 given observations from times
[1…t+1]</p>
</dd>
<dt>next_filtered_state_covariance<span class="classifier">[n_dim_state, n_dim_state] array</span></dt><dd><p>covariance of estimate for state at time t+1 given observations
from times [1…t+1]</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="snowdrop.src.numeric.filters.unscented.AdditiveUnscentedKalmanFilter.sample">
<span class="sig-name descname"><span class="pre">sample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_timesteps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/snowdrop/src/numeric/filters/unscented.html#AdditiveUnscentedKalmanFilter.sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#snowdrop.src.numeric.filters.unscented.AdditiveUnscentedKalmanFilter.sample" title="Link to this definition">¶</a></dt>
<dd><p>Sample from model defined by the Unscented Kalman Filter</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>n_timesteps<span class="classifier">int</span></dt><dd><p>number of time steps</p>
</dd>
<dt>initial_state<span class="classifier">optional, [n_dim_state] array</span></dt><dd><p>initial state.  If unspecified, will be sampled from initial state
distribution.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="snowdrop.src.numeric.filters.unscented.AdditiveUnscentedKalmanFilter.smooth">
<span class="sig-name descname"><span class="pre">smooth</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Z</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/snowdrop/src/numeric/filters/unscented.html#AdditiveUnscentedKalmanFilter.smooth"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#snowdrop.src.numeric.filters.unscented.AdditiveUnscentedKalmanFilter.smooth" title="Link to this definition">¶</a></dt>
<dd><p>Run Unscented Kalman Smoother</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>Z<span class="classifier">[n_timesteps, n_dim_state] array</span></dt><dd><p>Z[t] = observation at time t.  If Z is a masked array and any of
Z[t]’s elements are masked, the observation is assumed missing and
ignored.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><dl class="simple">
<dt>smoothed_state_means<span class="classifier">[n_timesteps, n_dim_state] array</span></dt><dd><p>filtered_state_means[t] = mean of state distribution at time t given
observations from times [0, n_timesteps-1]</p>
</dd>
<dt>smoothed_state_covariances<span class="classifier">[n_timesteps, n_dim_state, n_dim_state] array</span></dt><dd><p>filtered_state_covariances[t] = covariance of state distribution at
time t given observations from times [0, n_timesteps-1]</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="snowdrop.src.numeric.filters.unscented.Moments">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">snowdrop.src.numeric.filters.unscented.</span></span><span class="sig-name descname"><span class="pre">Moments</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mean</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">covariance</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#snowdrop.src.numeric.filters.unscented.Moments" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="snowdrop.src.numeric.filters.unscented.Moments.covariance">
<span class="sig-name descname"><span class="pre">covariance</span></span><a class="headerlink" href="#snowdrop.src.numeric.filters.unscented.Moments.covariance" title="Link to this definition">¶</a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="snowdrop.src.numeric.filters.unscented.Moments.mean">
<span class="sig-name descname"><span class="pre">mean</span></span><a class="headerlink" href="#snowdrop.src.numeric.filters.unscented.Moments.mean" title="Link to this definition">¶</a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="snowdrop.src.numeric.filters.unscented.SigmaPoints">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">snowdrop.src.numeric.filters.unscented.</span></span><span class="sig-name descname"><span class="pre">SigmaPoints</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">points</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights_mean</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights_covariance</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#snowdrop.src.numeric.filters.unscented.SigmaPoints" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="snowdrop.src.numeric.filters.unscented.SigmaPoints.points">
<span class="sig-name descname"><span class="pre">points</span></span><a class="headerlink" href="#snowdrop.src.numeric.filters.unscented.SigmaPoints.points" title="Link to this definition">¶</a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="snowdrop.src.numeric.filters.unscented.SigmaPoints.weights_covariance">
<span class="sig-name descname"><span class="pre">weights_covariance</span></span><a class="headerlink" href="#snowdrop.src.numeric.filters.unscented.SigmaPoints.weights_covariance" title="Link to this definition">¶</a></dt>
<dd><p>Alias for field number 2</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="snowdrop.src.numeric.filters.unscented.SigmaPoints.weights_mean">
<span class="sig-name descname"><span class="pre">weights_mean</span></span><a class="headerlink" href="#snowdrop.src.numeric.filters.unscented.SigmaPoints.weights_mean" title="Link to this definition">¶</a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="snowdrop.src.numeric.filters.unscented.UnscentedKalmanFilter">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">snowdrop.src.numeric.filters.unscented.</span></span><span class="sig-name descname"><span class="pre">UnscentedKalmanFilter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">transition_functions</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">observation_functions</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transition_covariance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">observation_covariance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_state_mean</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_state_covariance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_dim_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_dim_obs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/snowdrop/src/numeric/filters/unscented.html#UnscentedKalmanFilter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#snowdrop.src.numeric.filters.unscented.UnscentedKalmanFilter" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#snowdrop.src.numeric.filters.unscented.UnscentedMixin" title="snowdrop.src.numeric.filters.unscented.UnscentedMixin"><code class="xref py py-class docutils literal notranslate"><span class="pre">UnscentedMixin</span></code></a></p>
<p>Implements the General (aka Augmented) Unscented Kalman Filter governed
by the following equations,</p>
<div class="math notranslate nohighlight">
\[x_0 = \sim \text{Normal}(\mu_0, \Sigma_0)
x_{t+1} = f_t(x_t, \text{Normal}(0, Q))
z_{t} = g_t(x_t, \text{Normal}(0, R))\]</div>
<p>Notice that although the input noise to the state transition equation and
the observation equation are both normally distributed, any non-linear
transformation may be applied afterwards.  This allows for greater
generality, but at the expense of computational complexity.  The complexity
of <a class="reference internal" href="#snowdrop.src.numeric.filters.unscented.UnscentedKalmanFilter.filter" title="snowdrop.src.numeric.filters.unscented.UnscentedKalmanFilter.filter"><code class="xref py py-class docutils literal notranslate"><span class="pre">UnscentedKalmanFilter.filter()</span></code></a> is <span class="math notranslate nohighlight">\(O(T(2n+m)^3)\)</span>
where <span class="math notranslate nohighlight">\(T\)</span> is the number of time steps, <span class="math notranslate nohighlight">\(n\)</span> is the size of the
state space, and <span class="math notranslate nohighlight">\(m\)</span> is the size of the observation space.</p>
<p>If your noise is simply additive, consider using the
<a class="reference internal" href="#snowdrop.src.numeric.filters.unscented.AdditiveUnscentedKalmanFilter" title="snowdrop.src.numeric.filters.unscented.AdditiveUnscentedKalmanFilter"><code class="xref py py-class docutils literal notranslate"><span class="pre">AdditiveUnscentedKalmanFilter</span></code></a></p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>transition_functions<span class="classifier">function or [n_timesteps-1] array of functions</span></dt><dd><p>transition_functions[t] is a function of the state and the transition
noise at time t and produces the state at time t+1.  Also known as
<span class="math notranslate nohighlight">\(f_t\)</span>.</p>
</dd>
<dt>observation_functions<span class="classifier">function or [n_timesteps] array of functions</span></dt><dd><p>observation_functions[t] is a function of the state and the observation
noise at time t and produces the observation at time t.  Also known as
<span class="math notranslate nohighlight">\(g_t\)</span>.</p>
</dd>
<dt>transition_covariance<span class="classifier">[n_dim_state, n_dim_state] array</span></dt><dd><p>transition noise covariance matrix. Also known as <span class="math notranslate nohighlight">\(Q\)</span>.</p>
</dd>
<dt>observation_covariance<span class="classifier">[n_dim_obs, n_dim_obs] array</span></dt><dd><p>observation noise covariance matrix. Also known as <span class="math notranslate nohighlight">\(R\)</span>.</p>
</dd>
<dt>initial_state_mean<span class="classifier">[n_dim_state] array</span></dt><dd><p>mean of initial state distribution. Also known as <span class="math notranslate nohighlight">\(\mu_0\)</span></p>
</dd>
<dt>initial_state_covariance<span class="classifier">[n_dim_state, n_dim_state] array</span></dt><dd><p>covariance of initial state distribution. Also known as
<span class="math notranslate nohighlight">\(\Sigma_0\)</span></p>
</dd>
<dt>n_dim_state: optional, integer</dt><dd><p>the dimensionality of the state space. Only meaningful when you do not
specify initial values for <cite>transition_covariance</cite>, or
<cite>initial_state_mean</cite>, <cite>initial_state_covariance</cite>.</p>
</dd>
<dt>n_dim_obs: optional, integer</dt><dd><p>the dimensionality of the observation space. Only meaningful when you
do not specify initial values for <cite>observation_covariance</cite>.</p>
</dd>
<dt>random_state<span class="classifier">optional, int or RandomState</span></dt><dd><p>seed for random sample generation</p>
</dd>
</dl>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="snowdrop.src.numeric.filters.unscented.UnscentedKalmanFilter.filter">
<span class="sig-name descname"><span class="pre">filter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Z</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/snowdrop/src/numeric/filters/unscented.html#UnscentedKalmanFilter.filter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#snowdrop.src.numeric.filters.unscented.UnscentedKalmanFilter.filter" title="Link to this definition">¶</a></dt>
<dd><p>Run Unscented Kalman Filter</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>Z<span class="classifier">[n_timesteps, n_dim_state] array</span></dt><dd><p>Z[t] = observation at time t.  If Z is a masked array and any of
Z[t]’s elements are masked, the observation is assumed missing and
ignored.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><dl class="simple">
<dt>filtered_state_means<span class="classifier">[n_timesteps, n_dim_state] array</span></dt><dd><p>filtered_state_means[t] = mean of state distribution at time t given
observations from times [0, t]</p>
</dd>
<dt>filtered_state_covariances<span class="classifier">[n_timesteps, n_dim_state, n_dim_state] array</span></dt><dd><p>filtered_state_covariances[t] = covariance of state distribution at
time t given observations from times [0, t]</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="snowdrop.src.numeric.filters.unscented.UnscentedKalmanFilter.filter_update">
<span class="sig-name descname"><span class="pre">filter_update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filtered_state_mean</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filtered_state_covariance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">observation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transition_function</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transition_covariance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">observation_function</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">observation_covariance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/snowdrop/src/numeric/filters/unscented.html#UnscentedKalmanFilter.filter_update"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#snowdrop.src.numeric.filters.unscented.UnscentedKalmanFilter.filter_update" title="Link to this definition">¶</a></dt>
<dd><p>Update a Kalman Filter state estimate</p>
<p>Perform a one-step update to estimate the state at time <span class="math notranslate nohighlight">\(t+1\)</span>
give an observation at time <span class="math notranslate nohighlight">\(t+1\)</span> and the previous estimate for
time <span class="math notranslate nohighlight">\(t\)</span> given observations from times <span class="math notranslate nohighlight">\([0...t]\)</span>.  This
method is useful if one wants to track an object with streaming
observations.</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>filtered_state_mean<span class="classifier">[n_dim_state] array</span></dt><dd><p>mean estimate for state at time t given observations from times
[1…t]</p>
</dd>
<dt>filtered_state_covariance<span class="classifier">[n_dim_state, n_dim_state] array</span></dt><dd><p>covariance of estimate for state at time t given observations from
times [1…t]</p>
</dd>
<dt>observation<span class="classifier">[n_dim_obs] array or None</span></dt><dd><p>observation from time t+1.  If <cite>observation</cite> is a masked array and
any of <cite>observation</cite>’s components are masked or if <cite>observation</cite> is
None, then <cite>observation</cite> will be treated as a missing observation.</p>
</dd>
<dt>transition_function<span class="classifier">optional, function</span></dt><dd><p>state transition function from time t to t+1.  If unspecified,
<cite>self.transition_functions</cite> will be used.</p>
</dd>
<dt>transition_covariance<span class="classifier">optional, [n_dim_state, n_dim_state] array</span></dt><dd><p>state transition covariance from time t to t+1.  If unspecified,
<cite>self.transition_covariance</cite> will be used.</p>
</dd>
<dt>observation_function<span class="classifier">optional, function</span></dt><dd><p>observation function at time t+1.  If unspecified,
<cite>self.observation_functions</cite> will be used.</p>
</dd>
<dt>observation_covariance<span class="classifier">optional, [n_dim_obs, n_dim_obs] array</span></dt><dd><p>observation covariance at time t+1.  If unspecified,
<cite>self.observation_covariance</cite> will be used.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><dl class="simple">
<dt>next_filtered_state_mean<span class="classifier">[n_dim_state] array</span></dt><dd><p>mean estimate for state at time t+1 given observations from times
[1…t+1]</p>
</dd>
<dt>next_filtered_state_covariance<span class="classifier">[n_dim_state, n_dim_state] array</span></dt><dd><p>covariance of estimate for state at time t+1 given observations
from times [1…t+1]</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="snowdrop.src.numeric.filters.unscented.UnscentedKalmanFilter.sample">
<span class="sig-name descname"><span class="pre">sample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_timesteps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/snowdrop/src/numeric/filters/unscented.html#UnscentedKalmanFilter.sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#snowdrop.src.numeric.filters.unscented.UnscentedKalmanFilter.sample" title="Link to this definition">¶</a></dt>
<dd><p>Sample from model defined by the Unscented Kalman Filter</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>n_timesteps<span class="classifier">int</span></dt><dd><p>number of time steps</p>
</dd>
<dt>initial_state<span class="classifier">optional, [n_dim_state] array</span></dt><dd><p>initial state.  If unspecified, will be sampled from initial state
distribution.</p>
</dd>
<dt>random_state<span class="classifier">optional, int or Random</span></dt><dd><p>random number generator</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="snowdrop.src.numeric.filters.unscented.UnscentedKalmanFilter.smooth">
<span class="sig-name descname"><span class="pre">smooth</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Z</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/snowdrop/src/numeric/filters/unscented.html#UnscentedKalmanFilter.smooth"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#snowdrop.src.numeric.filters.unscented.UnscentedKalmanFilter.smooth" title="Link to this definition">¶</a></dt>
<dd><p>Run Unscented Kalman Smoother</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>Z<span class="classifier">[n_timesteps, n_dim_state] array</span></dt><dd><p>Z[t] = observation at time t.  If Z is a masked array and any of
Z[t]’s elements are masked, the observation is assumed missing and
ignored.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><dl class="simple">
<dt>smoothed_state_means<span class="classifier">[n_timesteps, n_dim_state] array</span></dt><dd><p>filtered_state_means[t] = mean of state distribution at time t given
observations from times [0, n_timesteps-1]</p>
</dd>
<dt>smoothed_state_covariances<span class="classifier">[n_timesteps, n_dim_state, n_dim_state] array</span></dt><dd><p>filtered_state_covariances[t] = covariance of state distribution at
time t given observations from times [0, n_timesteps-1]</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="snowdrop.src.numeric.filters.unscented.UnscentedMixin">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">snowdrop.src.numeric.filters.unscented.</span></span><span class="sig-name descname"><span class="pre">UnscentedMixin</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">transition_functions</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">observation_functions</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transition_covariance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">observation_covariance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_state_mean</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_state_covariance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_dim_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_dim_obs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/snowdrop/src/numeric/filters/unscented.html#UnscentedMixin"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#snowdrop.src.numeric.filters.unscented.UnscentedMixin" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Methods shared by all Unscented Kalman Filter implementations.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="snowdrop.src.numeric.filters.unscented.additive_unscented_filter">
<span class="sig-prename descclassname"><span class="pre">snowdrop.src.numeric.filters.unscented.</span></span><span class="sig-name descname"><span class="pre">additive_unscented_filter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mu_0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma_0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">g</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Q</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">R</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Z</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/snowdrop/src/numeric/filters/unscented.html#additive_unscented_filter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#snowdrop.src.numeric.filters.unscented.additive_unscented_filter" title="Link to this definition">¶</a></dt>
<dd><p>Apply the Unscented Kalman Filter with additive noise</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>mu_0<span class="classifier">[n_dim_state] array</span></dt><dd><p>mean of initial state distribution</p>
</dd>
<dt>sigma_0<span class="classifier">[n_dim_state, n_dim_state] array</span></dt><dd><p>covariance of initial state distribution</p>
</dd>
<dt>f<span class="classifier">function or [T-1] array of functions</span></dt><dd><p>state transition function(s). Takes in an the current state and outputs
the next.</p>
</dd>
<dt>g<span class="classifier">function or [T] array of functions</span></dt><dd><p>observation function(s). Takes in the current state and outputs the
current observation.</p>
</dd>
<dt>Q<span class="classifier">[n_dim_state, n_dim_state] array</span></dt><dd><p>transition covariance matrix</p>
</dd>
<dt>R<span class="classifier">[n_dim_state, n_dim_state] array</span></dt><dd><p>observation covariance matrix</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><dl class="simple">
<dt>mu_filt<span class="classifier">[T, n_dim_state] array</span></dt><dd><p>mu_filt[t] = mean of state at time t given observations from times [0,
t]</p>
</dd>
<dt>sigma_filt<span class="classifier">[T, n_dim_state, n_dim_state] array</span></dt><dd><p>sigma_filt[t] = covariance of state at time t given observations from
times [0, t]</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="snowdrop.src.numeric.filters.unscented.additive_unscented_smoother">
<span class="sig-prename descclassname"><span class="pre">snowdrop.src.numeric.filters.unscented.</span></span><span class="sig-name descname"><span class="pre">additive_unscented_smoother</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mu_filt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma_filt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Q</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/snowdrop/src/numeric/filters/unscented.html#additive_unscented_smoother"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#snowdrop.src.numeric.filters.unscented.additive_unscented_smoother" title="Link to this definition">¶</a></dt>
<dd><p>Apply the Unscented Kalman Filter assuming additiven noise</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>mu_filt<span class="classifier">[T, n_dim_state] array</span></dt><dd><p>mu_filt[t] = mean of state at time t given observations from times
[0, t]</p>
</dd>
<dt>sigma_filt<span class="classifier">[T, n_dim_state, n_dim_state] array</span></dt><dd><p>sigma_filt[t] = covariance of state at time t given observations from
times [0, t]</p>
</dd>
<dt>f<span class="classifier">function or [T-1] array of functions</span></dt><dd><p>state transition function(s). Takes in an the current state and outputs
the next.</p>
</dd>
<dt>Q<span class="classifier">[n_dim_state, n_dim_state] array</span></dt><dd><p>transition covariance matrix</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><dl class="simple">
<dt>mu_smooth<span class="classifier">[T, n_dim_state] array</span></dt><dd><p>mu_smooth[t] = mean of state at time t given observations from times
[0, T-1]</p>
</dd>
<dt>sigma_smooth<span class="classifier">[T, n_dim_state, n_dim_state] array</span></dt><dd><p>sigma_smooth[t] = covariance of state at time t given observations from
times [0, T-1]</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="snowdrop.src.numeric.filters.unscented.augmented_points">
<span class="sig-prename descclassname"><span class="pre">snowdrop.src.numeric.filters.unscented.</span></span><span class="sig-name descname"><span class="pre">augmented_points</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">momentses</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/snowdrop/src/numeric/filters/unscented.html#augmented_points"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#snowdrop.src.numeric.filters.unscented.augmented_points" title="Link to this definition">¶</a></dt>
<dd><p>Calculate sigma points for augmented UKF</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>momentses<span class="classifier">list of Moments</span></dt><dd><p>means and covariances for multiple multivariate normals</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><dl class="simple">
<dt>pointses<span class="classifier">list of Points</span></dt><dd><p>sigma points for each element of momentses</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="snowdrop.src.numeric.filters.unscented.augmented_unscented_filter">
<span class="sig-prename descclassname"><span class="pre">snowdrop.src.numeric.filters.unscented.</span></span><span class="sig-name descname"><span class="pre">augmented_unscented_filter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mu_0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma_0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">g</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Q</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">R</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Z</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/snowdrop/src/numeric/filters/unscented.html#augmented_unscented_filter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#snowdrop.src.numeric.filters.unscented.augmented_unscented_filter" title="Link to this definition">¶</a></dt>
<dd><p>Apply the Unscented Kalman Filter with arbitrary noise</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>mu_0<span class="classifier">[n_dim_state] array</span></dt><dd><p>mean of initial state distribution</p>
</dd>
<dt>sigma_0<span class="classifier">[n_dim_state, n_dim_state] array</span></dt><dd><p>covariance of initial state distribution</p>
</dd>
<dt>f<span class="classifier">function or [T-1] array of functions</span></dt><dd><p>state transition function(s). Takes in an the current state and the
process noise and outputs the next state.</p>
</dd>
<dt>g<span class="classifier">function or [T] array of functions</span></dt><dd><p>observation function(s). Takes in the current state and outputs the
current observation.</p>
</dd>
<dt>Q<span class="classifier">[n_dim_state, n_dim_state] array</span></dt><dd><p>transition covariance matrix</p>
</dd>
<dt>R<span class="classifier">[n_dim_state, n_dim_state] array</span></dt><dd><p>observation covariance matrix</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><dl class="simple">
<dt>mu_filt<span class="classifier">[T, n_dim_state] array</span></dt><dd><p>mu_filt[t] = mean of state at time t given observations from times [0,
t]</p>
</dd>
<dt>sigma_filt<span class="classifier">[T, n_dim_state, n_dim_state] array</span></dt><dd><p>sigma_filt[t] = covariance of state at time t given observations from
times [0, t]</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="snowdrop.src.numeric.filters.unscented.augmented_unscented_filter_points">
<span class="sig-prename descclassname"><span class="pre">snowdrop.src.numeric.filters.unscented.</span></span><span class="sig-name descname"><span class="pre">augmented_unscented_filter_points</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mean_state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">covariance_state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">covariance_transition</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">covariance_observation</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/snowdrop/src/numeric/filters/unscented.html#augmented_unscented_filter_points"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#snowdrop.src.numeric.filters.unscented.augmented_unscented_filter_points" title="Link to this definition">¶</a></dt>
<dd><p>Extract sigma points using augmented state representation</p>
<p>Primarily used as a pre-processing step before predicting and updating in
the Augmented UKF.</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>mean_state<span class="classifier">[n_dim_state] array</span></dt><dd><p>mean of state at time t given observations from time steps 0…t</p>
</dd>
<dt>covariance_state<span class="classifier">[n_dim_state, n_dim_state] array</span></dt><dd><p>covariance of state at time t given observations from time steps 0…t</p>
</dd>
<dt>covariance_transition<span class="classifier">[n_dim_state, n_dim_state] array</span></dt><dd><p>covariance of zero-mean noise resulting from transitioning from time
step t to t+1</p>
</dd>
<dt>covariance_observation<span class="classifier">[n_dim_obs, n_dim_obs] array</span></dt><dd><p>covariance of zero-mean noise resulting from observation state at time
t+1</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><dl class="simple">
<dt>points_state<span class="classifier">[2 * n_dim_state + 1, n_dim_state] SigmaPoints</span></dt><dd><p>sigma points for state at time t</p>
</dd>
<dt>points_transition<span class="classifier">[2 * n_dim_state + 1, n_dim_state] SigmaPoints</span></dt><dd><p>sigma points for transition noise between time t and t+1</p>
</dd>
<dt>points_observation<span class="classifier">[2 * n_dim_state + 1, n_dim_obs] SigmaPoints</span></dt><dd><p>sigma points for observation noise at time step t+1</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="snowdrop.src.numeric.filters.unscented.augmented_unscented_smoother">
<span class="sig-prename descclassname"><span class="pre">snowdrop.src.numeric.filters.unscented.</span></span><span class="sig-name descname"><span class="pre">augmented_unscented_smoother</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mu_filt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma_filt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Q</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/snowdrop/src/numeric/filters/unscented.html#augmented_unscented_smoother"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#snowdrop.src.numeric.filters.unscented.augmented_unscented_smoother" title="Link to this definition">¶</a></dt>
<dd><p>Apply the Unscented Kalman Smoother with arbitrary noise</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>mu_filt<span class="classifier">[T, n_dim_state] array</span></dt><dd><p>mu_filt[t] = mean of state at time t given observations from times
[0, t]</p>
</dd>
<dt>sigma_filt<span class="classifier">[T, n_dim_state, n_dim_state] array</span></dt><dd><p>sigma_filt[t] = covariance of state at time t given observations from
times [0, t]</p>
</dd>
<dt>f<span class="classifier">function or [T-1] array of functions</span></dt><dd><p>state transition function(s). Takes in an the current state and the
process noise and outputs the next state.</p>
</dd>
<dt>Q<span class="classifier">[n_dim_state, n_dim_state] array</span></dt><dd><p>transition covariance matrix</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><dl class="simple">
<dt>mu_smooth<span class="classifier">[T, n_dim_state] array</span></dt><dd><p>mu_smooth[t] = mean of state at time t given observations from times
[0, T-1]</p>
</dd>
<dt>sigma_smooth<span class="classifier">[T, n_dim_state, n_dim_state] array</span></dt><dd><p>sigma_smooth[t] = covariance of state at time t given observations from
times [0, T-1]</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="snowdrop.src.numeric.filters.unscented.moments2points">
<span class="sig-prename descclassname"><span class="pre">snowdrop.src.numeric.filters.unscented.</span></span><span class="sig-name descname"><span class="pre">moments2points</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">moments</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kappa</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/snowdrop/src/numeric/filters/unscented.html#moments2points"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#snowdrop.src.numeric.filters.unscented.moments2points" title="Link to this definition">¶</a></dt>
<dd><p>Calculate “sigma points” used in Unscented Kalman Filter</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>moments<span class="classifier">[n_dim] Moments object</span></dt><dd><p>mean and covariance of a multivariate normal</p>
</dd>
<dt>alpha<span class="classifier">float</span></dt><dd><p>Spread of the sigma points. Typically 1e-3.</p>
</dd>
<dt>beta<span class="classifier">float</span></dt><dd><p>Used to “incorporate prior knowledge of the distribution of the state”.
2 is optimal is the state is normally distributed.</p>
</dd>
<dt>kappa<span class="classifier">float</span></dt><dd><p>a parameter</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><dl class="simple">
<dt>points<span class="classifier">[2*n_dim+1, n_dim] SigmaPoints</span></dt><dd><p>sigma points and associated weights</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="snowdrop.src.numeric.filters.unscented.points2moments">
<span class="sig-prename descclassname"><span class="pre">snowdrop.src.numeric.filters.unscented.</span></span><span class="sig-name descname"><span class="pre">points2moments</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">points</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma_noise</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/snowdrop/src/numeric/filters/unscented.html#points2moments"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#snowdrop.src.numeric.filters.unscented.points2moments" title="Link to this definition">¶</a></dt>
<dd><p>Calculate estimated mean and covariance of sigma points</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>points<span class="classifier">[2 * n_dim_state + 1, n_dim_state] SigmaPoints</span></dt><dd><p>SigmaPoints object containing points and weights</p>
</dd>
<dt>sigma_noise<span class="classifier">[n_dim_state, n_dim_state] array</span></dt><dd><p>additive noise covariance matrix, if any</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><dl class="simple">
<dt>moments<span class="classifier">Moments object of size [n_dim_state]</span></dt><dd><p>Mean and covariance estimated using points</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="snowdrop.src.numeric.filters.unscented.unscented_correct">
<span class="sig-prename descclassname"><span class="pre">snowdrop.src.numeric.filters.unscented.</span></span><span class="sig-name descname"><span class="pre">unscented_correct</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cross_sigma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">moments_pred</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">obs_moments_pred</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/snowdrop/src/numeric/filters/unscented.html#unscented_correct"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#snowdrop.src.numeric.filters.unscented.unscented_correct" title="Link to this definition">¶</a></dt>
<dd><p>Correct predicted state estimates with an observation</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>cross_sigma<span class="classifier">[n_dim_state, n_dim_obs] array</span></dt><dd><p>cross-covariance between the state at time t given all observations
from timesteps [0, t-1] and the observation at time t</p>
</dd>
<dt>moments_pred<span class="classifier">[n_dim_state] Moments</span></dt><dd><p>mean and covariance of state at time t given observations from
timesteps [0, t-1]</p>
</dd>
<dt>obs_moments_pred<span class="classifier">[n_dim_obs] Moments</span></dt><dd><p>mean and covariance of observation at time t given observations from
times [0, t-1]</p>
</dd>
<dt>z<span class="classifier">[n_dim_obs] array</span></dt><dd><p>observation at time t</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><dl class="simple">
<dt>moments_filt<span class="classifier">[n_dim_state] Moments</span></dt><dd><p>mean and covariance of state at time t given observations from time
steps [0, t]</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="snowdrop.src.numeric.filters.unscented.unscented_filter_correct">
<span class="sig-prename descclassname"><span class="pre">snowdrop.src.numeric.filters.unscented.</span></span><span class="sig-name descname"><span class="pre">unscented_filter_correct</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">observation_function</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">moments_pred</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">points_pred</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">observation</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">points_observation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma_observation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/snowdrop/src/numeric/filters/unscented.html#unscented_filter_correct"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#snowdrop.src.numeric.filters.unscented.unscented_filter_correct" title="Link to this definition">¶</a></dt>
<dd><p>Integrate new observation to correct state estimates</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>observation_function<span class="classifier">function</span></dt><dd><p>function characterizing how the observation at time t+1 is generated</p>
</dd>
<dt>moments_pred<span class="classifier">[n_dim_state] Moments</span></dt><dd><p>mean and covariance of state at time t+1 given observations from time
steps 0…t</p>
</dd>
<dt>points_pred<span class="classifier">[2*n_dim_state+1, n_dim_state] SigmaPoints</span></dt><dd><p>sigma points corresponding to moments_pred</p>
</dd>
<dt>observation<span class="classifier">[n_dim_state] array</span></dt><dd><p>observation at time t+1. If masked, treated as missing.</p>
</dd>
<dt>points_observation<span class="classifier">[2*n_dim_state, n_dim_obs] SigmaPoints</span></dt><dd><p>sigma points corresponding to predicted observation at time t+1 given
observations from times 0…t, if available. If not, noise is assumed
to be additive.</p>
</dd>
<dt>sigma_observation<span class="classifier">[n_dim_obs, n_dim_obs] array</span></dt><dd><p>covariance matrix corresponding to additive noise in observation at
time t+1, if available. If missing, noise is assumed to be non-linear.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><dl class="simple">
<dt>moments_filt<span class="classifier">[n_dim_state] Moments</span></dt><dd><p>mean and covariance of state at time t+1 given observations from time
steps 0…t+1</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="snowdrop.src.numeric.filters.unscented.unscented_filter_predict">
<span class="sig-prename descclassname"><span class="pre">snowdrop.src.numeric.filters.unscented.</span></span><span class="sig-name descname"><span class="pre">unscented_filter_predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">transition_function</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">points_state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">points_transition</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma_transition</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/snowdrop/src/numeric/filters/unscented.html#unscented_filter_predict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#snowdrop.src.numeric.filters.unscented.unscented_filter_predict" title="Link to this definition">¶</a></dt>
<dd><p>Predict next state distribution</p>
<p>Using the sigma points representing the state at time t given observations
from time steps 0…t, calculate the predicted mean, covariance, and sigma
points for the state at time t+1.</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>transition_function<span class="classifier">function</span></dt><dd><p>function describing how the state changes between times t and t+1</p>
</dd>
<dt>points_state<span class="classifier">[2*n_dim_state+1, n_dim_state] SigmaPoints</span></dt><dd><p>sigma points corresponding to the state at time step t given
observations from time steps 0…t</p>
</dd>
<dt>points_transition<span class="classifier">[2*n_dim_state+1, n_dim_state] SigmaPoints</span></dt><dd><p>sigma points corresponding to the noise in transitioning from time step
t to t+1, if available. If not, assumes that noise is additive</p>
</dd>
<dt>sigma_transition<span class="classifier">[n_dim_state, n_dim_state] array</span></dt><dd><p>covariance corresponding to additive noise in transitioning from time
step t to t+1, if available. If not, assumes noise is not additive.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><dl class="simple">
<dt>points_pred<span class="classifier">[2*n_dim_state+1, n_dim_state] SigmaPoints</span></dt><dd><p>sigma points corresponding to state at time step t+1 given observations
from time steps 0…t. These points have not been “standardized” by the
unscented transform yet.</p>
</dd>
<dt>moments_pred<span class="classifier">[n_dim_state] Moments</span></dt><dd><p>mean and covariance corresponding to time step t+1 given observations
from time steps 0…t</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="snowdrop.src.numeric.filters.unscented.unscented_transform">
<span class="sig-prename descclassname"><span class="pre">snowdrop.src.numeric.filters.unscented.</span></span><span class="sig-name descname"><span class="pre">unscented_transform</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">points</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">points_noise</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma_noise</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/snowdrop/src/numeric/filters/unscented.html#unscented_transform"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#snowdrop.src.numeric.filters.unscented.unscented_transform" title="Link to this definition">¶</a></dt>
<dd><p>Apply the Unscented Transform to a set of points</p>
<p>Apply f to points (with secondary argument points_noise, if available),
then approximate the resulting mean and covariance. If sigma_noise is
available, treat it as additional variance due to additive noise.</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>points<span class="classifier">[n_points, n_dim_state] SigmaPoints</span></dt><dd><p>points to pass into f’s first argument and associated weights if f is
defined. If f is unavailable, then f is assumed to be the identity
function.</p>
</dd>
<dt>f<span class="classifier">[n_dim_state, n_dim_state_noise] -&gt; [n_dim_state] function</span></dt><dd><p>transition function from time t to time t+1, if available.</p>
</dd>
<dt>points_noise<span class="classifier">[n_points, n_dim_state_noise] array</span></dt><dd><p>points to pass into f’s second argument, if any</p>
</dd>
<dt>sigma_noise<span class="classifier">[n_dim_state, n_dim_state] array</span></dt><dd><p>covariance matrix for additive noise, if any</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><dl class="simple">
<dt>points_pred<span class="classifier">[n_points, n_dim_state] SigmaPoints</span></dt><dd><p>points transformed by f with same weights</p>
</dd>
<dt>moments_pred<span class="classifier">[n_dim_state] Moments</span></dt><dd><p>moments associated with points_pred</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-snowdrop.src.numeric.filters.utils">
<span id="snowdrop-src-numeric-filters-utils-module"></span><h2>snowdrop.src.numeric.filters.utils module<a class="headerlink" href="#module-snowdrop.src.numeric.filters.utils" title="Link to this heading">¶</a></h2>
<p>Compute initial error covariance matrices Pstar and Pinf.</p>
<p>The initial values of error covariance matrix P are assumed diffusive.
During the first d diffusive periods matrix P is decomposed into Pstar and Pinf
and separate equations for these matrices are applied.
After the d diffusive periods the standard Kalman filter is used and only one error covariance
matrix P is used.  The initial condition for P(d) is Pstar(d).</p>
<p>Translated from Dynare Matlab code to Python by A.G.</p>
<dl class="py function">
<dt class="sig sig-object py" id="snowdrop.src.numeric.filters.utils.compute_Pinf_Pstar">
<span class="sig-prename descclassname"><span class="pre">snowdrop.src.numeric.filters.utils.</span></span><span class="sig-name descname"><span class="pre">compute_Pinf_Pstar</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">T</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">R</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Q</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_shocks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qz_criterium</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.000001</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/snowdrop/src/numeric/filters/utils.html#compute_Pinf_Pstar"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#snowdrop.src.numeric.filters.utils.compute_Pinf_Pstar" title="Link to this definition">¶</a></dt>
<dd><p>Compute of Pinf and Pstar for Durbin and Koopman diffuse filter.</p>
<p>Kitagawa transformation of state space system with a quasi-triangular
transition matrix with unit roots at the top, but excluding zero columns of the transition matrix.</p>
<p>For references please see G. Kitagawa, “An algorithm for solving the matrix equation”, 
International Journal of Control, Volume 25, 1977 - Issue 5</p>
<p>The transformed state space is y = [ss z x], were:</p>
<blockquote>
<div><p>s: static variables (zero columns of T)</p>
<p>z: unit roots</p>
<p>x: stable roots</p>
<p>ss: s - z = stationarized static variables</p>
</div></blockquote>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>T:          double     </dt><dd><p>matrix of transition equations</p>
</dd>
<dt>R:          double     </dt><dd><p>matrix of structural shock effects</p>
</dd>
<dt>Q:          double     </dt><dd><p>matrix of covariance of structural shocks</p>
</dd>
<dt>N:          int        </dt><dd><p>shocks maximum lead number minus minimum lag number</p>
</dd>
<dt>n_shocks:   int        </dt><dd><p>number pf shocks</p>
</dd>
<dt>mf:         integer    </dt><dd><p>vector of indices of observed variables in state vector</p>
</dd>
<dt>qz_criterium: double     </dt><dd><p>numerical criterium for unit roots</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><dl class="simple">
<dt>Pinf:        double     </dt><dd><p>matrix of covariance initialization for nonstationary part</p>
</dd>
<dt>Pstar:       double     </dt><dd><p>matrix of covariance of stationary part</p>
</dd>
</dl>
</dd>
<dt>Algorithm:</dt><dd><p>Real Schur transformation of transition equation</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Translated from Dynare version 4.5.1 to Python by AG</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="snowdrop.src.numeric.filters.utils.getCovarianceMatrix">
<span class="sig-prename descclassname"><span class="pre">snowdrop.src.numeric.filters.utils.</span></span><span class="sig-name descname"><span class="pre">getCovarianceMatrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Qm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shocks</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">equations</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/snowdrop/src/numeric/filters/utils.html#getCovarianceMatrix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#snowdrop.src.numeric.filters.utils.getCovarianceMatrix" title="Link to this definition">¶</a></dt>
<dd><p>Return error covariance matrix of endogenous variables.</p>
<section id="id12">
<h3>Parameters<a class="headerlink" href="#id12" title="Link to this heading">¶</a></h3>
<dl class="simple">
<dt>Qm<span class="classifier">numpy 2D ndarray.</span></dt><dd><p>Error covariance matrix.</p>
</dd>
<dt>shocks<span class="classifier">list.</span></dt><dd><p>Shocks names.</p>
</dd>
<dt>equations<span class="classifier">list.</span></dt><dd><p>Measuremen equations.</p>
</dd>
<dt>n<span class="classifier">int.</span></dt><dd><p>Nimber of variables.</p>
</dd>
</dl>
</section>
<section id="id13">
<h3>Returns<a class="headerlink" href="#id13" title="Link to this heading">¶</a></h3>
<dl class="simple">
<dt>Q<span class="classifier">numpy 2D array.</span></dt><dd><p>Full error covariance matrix of endogenous variables.</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="snowdrop.src.numeric.filters.utils.getEndogVarInMeasEqs">
<span class="sig-prename descclassname"><span class="pre">snowdrop.src.numeric.filters.utils.</span></span><span class="sig-name descname"><span class="pre">getEndogVarInMeasEqs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">variables</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">measurement_equations</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/snowdrop/src/numeric/filters/utils.html#getEndogVarInMeasEqs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#snowdrop.src.numeric.filters.utils.getEndogVarInMeasEqs" title="Link to this definition">¶</a></dt>
<dd><p>Retrun list of endogenous variables that are present in measurement equations.</p>
<section id="id14">
<h3>Parameters<a class="headerlink" href="#id14" title="Link to this heading">¶</a></h3>
<dl class="simple">
<dt>variables<span class="classifier">list.</span></dt><dd><p>Names of variables.</p>
</dd>
<dt>measurement_equations<span class="classifier">list.</span></dt><dd><p>Measurement equations.</p>
</dd>
</dl>
</section>
<section id="id15">
<h3>Returns<a class="headerlink" href="#id15" title="Link to this heading">¶</a></h3>
<dl class="simple">
<dt>ind_var<span class="classifier">list.</span></dt><dd><p>Indices of endogenous variables.</p>
</dd>
<dt>var_meas<span class="classifier">list.</span></dt><dd><p>Names of endogenous variables.</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="snowdrop.src.numeric.filters.utils.getMissingInitialVariables">
<span class="sig-prename descclassname"><span class="pre">snowdrop.src.numeric.filters.utils.</span></span><span class="sig-name descname"><span class="pre">getMissingInitialVariables</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ind</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/snowdrop/src/numeric/filters/utils.html#getMissingInitialVariables"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#snowdrop.src.numeric.filters.utils.getMissingInitialVariables" title="Link to this definition">¶</a></dt>
<dd><p>Return initial values of endogenous variables satisfying model equations.
Parameters:
:param model: Model object.
:type model: <a href="#id16"><span class="problematic" id="id17">`</span></a>Model’.
:param ind: Indices of variables with fixed values.
:type ind: list.
:param x0: Initial guess.
:type x0: numpy ndarray.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="snowdrop.src.numeric.filters.utils.getSteadyStateCovarianceMatrix">
<span class="sig-prename descclassname"><span class="pre">snowdrop.src.numeric.filters.utils.</span></span><span class="sig-name descname"><span class="pre">getSteadyStateCovarianceMatrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">T</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">R</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Qm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Hm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Z</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Nd</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_shocks</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/snowdrop/src/numeric/filters/utils.html#getSteadyStateCovarianceMatrix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#snowdrop.src.numeric.filters.utils.getSteadyStateCovarianceMatrix" title="Link to this definition">¶</a></dt>
<dd><p>Solve Lyapunov equation for stable part of error covariance matrix.</p>
<p>Predict:</p>
<div class="math notranslate nohighlight">
\[P_{t|t-1} = T_{t} * P_{t-1|t-1} * F'_{t} + Q_{t}\]</div>
<p>For details, see <a class="reference external" href="https://en.wikipedia.org/wiki/Kalman_filter">https://en.wikipedia.org/wiki/Kalman_filter</a></p>
<dl>
<dt>Args:</dt><dd><p>T: is the state-transition matrix,</p>
<p>R: is the shock matrix,</p>
<p>Qm: is the covariance matrix of state variables (endogenous variables),</p>
<p>Hm: is the covariance matrix of space variables (measurement variables)</p>
<p>Z: is the observation matrix,</p>
<p>n: is the number of endogenous variables,</p>
<p>Nd: is the shocks maximum lead number minus minimum lag number,</p>
<p>n_shocks: is the number of shocks,</p>
<p>iterate: is the boolean variable. If True then iterative method is used, otherwise Lyapunov equation solver is applied.</p>
</dd>
</dl>
<p>For details, see <a class="reference external" href="https://en.wikipedia.org/wiki/Kalman_filter">https://en.wikipedia.org/wiki/Kalman_filter</a></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="snowdrop.src.numeric.filters.utils.getTimeShift">
<span class="sig-prename descclassname"><span class="pre">snowdrop.src.numeric.filters.utils.</span></span><span class="sig-name descname"><span class="pre">getTimeShift</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/snowdrop/src/numeric/filters/utils.html#getTimeShift"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#snowdrop.src.numeric.filters.utils.getTimeShift" title="Link to this definition">¶</a></dt>
<dd><p>Get time shift between start of simulation and start of filtration.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="snowdrop.src.numeric.filters.utils.sorter">
<span class="sig-prename descclassname"><span class="pre">snowdrop.src.numeric.filters.utils.</span></span><span class="sig-name descname"><span class="pre">sorter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/snowdrop/src/numeric/filters/utils.html#sorter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#snowdrop.src.numeric.filters.utils.sorter" title="Link to this definition">¶</a></dt>
<dd><p>Sort eigen values.</p>
</dd></dl>

</section>
<section id="module-snowdrop.src.numeric.filters">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-snowdrop.src.numeric.filters" title="Link to this heading">¶</a></h2>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">Python Platform</a></h1>








<h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">snowdrop</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="snowdrop.html">snowdrop package</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../info.html">Python Platform</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  <li><a href="modules.html">snowdrop</a><ul>
  <li><a href="snowdrop.html">snowdrop package</a><ul>
  <li><a href="snowdrop.src.html">snowdrop.src package</a><ul>
  <li><a href="snowdrop.src.numeric.html">snowdrop.src.numeric package</a><ul>
      <li>Previous: <a href="snowdrop.src.numeric.estimation.html" title="previous chapter">snowdrop.src.numeric.estimation package</a></li>
      <li>Next: <a href="snowdrop.src.numeric.grids.html" title="next chapter">snowdrop.src.numeric.grids package</a></li>
  </ul></li>
  </ul></li>
  </ul></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;2024, Alexei Goumilevski.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 7.3.7</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 0.7.16</a>
      
      |
      <a href="../_sources/source/snowdrop.src.numeric.filters.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>